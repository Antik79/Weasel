import{c as N,r as n,u as m,m as P,b as v,j as t,x as R,o as S}from"./index-eo1TGWw1.js";/**
 * @license lucide-react v0.439.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b=N("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);function k({name:f,title:j,subfolder:r}){const[o,w]=n.useState(!0),[s,p]=n.useState(!1),[g,L]=n.useState(!1),d=n.useRef(null),i=n.useRef(null),{data:l}=m("ui-preferences",P,{revalidateOnFocus:!1,revalidateOnReconnect:!1});n.useEffect(()=>{if(l&&!g){const e=l.logPanelExpanded?.[f],a=l.logPanelExpanded?.default??!1;p(e!==void 0?e:a),L(!0)}},[l,f,g]);const C=e=>{l&&(i.current&&clearTimeout(i.current),i.current=setTimeout(async()=>{try{const a={...l,logPanelExpanded:{...l.logPanelExpanded,[f]:e}};await S(a)}catch(a){console.error("Failed to save UI preferences:",a)}},500))},E=()=>{const e=!s;p(e),g&&C(e)};n.useEffect(()=>()=>{i.current&&clearTimeout(i.current)},[]);const{data:u}=m(s?`${r}-log-files`:null,()=>{const e=new URL("/api/logs",window.location.origin);return e.searchParams.set("subfolder",r),v(e.toString())},{refreshInterval:1e4}),h=n.useMemo(()=>!u?.files||u.files.length===0?null:u.files.sort((e,a)=>a.name.localeCompare(e.name))[0],[u]),{data:c,isLoading:x}=m(s&&h?[`${r}-log`,h.name]:null,([,e])=>{const a=new URL(`/api/logs/${encodeURIComponent(e)}`,window.location.origin);return a.searchParams.set("subfolder",r),v(a.toString())},{revalidateOnFocus:!0,refreshInterval:o?2e3:void 0});return n.useEffect(()=>{o&&s&&c&&d.current&&(d.current.scrollTop=d.current.scrollHeight)},[c,o,s]),t.jsxs("div",{className:"panel space-y-2",children:[t.jsxs("div",{className:"flex items-center justify-between cursor-pointer select-none",onClick:E,children:[t.jsxs("h3",{className:"panel-title mb-0 flex items-center gap-2",children:[s?t.jsx(b,{size:18}):t.jsx(R,{size:18}),j]}),t.jsxs("div",{className:"flex items-center gap-4",onClick:e=>e.stopPropagation(),children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"checkbox",id:`tail-${r}`,className:"checkbox",checked:o,onChange:e=>w(e.target.checked),disabled:!s}),t.jsx("label",{htmlFor:`tail-${r}`,className:`text-xs ${s?"text-slate-400 cursor-pointer":"text-slate-600"}`,children:"Tail Log"})]}),t.jsx("div",{className:"text-xs text-slate-500 w-24 text-right",children:x?"Loading...":o&&s?"Live":"Paused"})]})]}),s&&t.jsxs("div",{ref:d,className:"bg-slate-950 rounded border border-slate-800 p-3 max-h-96 overflow-y-auto font-mono text-xs",children:[x&&t.jsx("p",{className:"text-slate-400",children:"Loading log..."}),!x&&!c&&t.jsx("p",{className:"text-slate-400",children:"No log content available"}),!x&&c&&t.jsx("pre",{className:"text-slate-300 whitespace-pre-wrap break-all",children:c})]})]})}export{b as C,k as L};
