import{l as _}from"./vendor-editor-Cbnfy5IV.js";import{r as e,W as S}from"./index-DKeW84DF.js";import"./vendor-utils-BeCPKUKe.js";import"./vendor-terminal-Co9mG8Of.js";var q={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}},G=q,K={container:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}},ee=K;function te({children:t}){return S.createElement("div",{style:ee.container},t)}var re=te,ne=re;function ue({width:t,height:n,isEditorReady:i,loading:r,_ref:g,className:p,wrapperProps:v}){return S.createElement("section",{style:{...G.wrapper,width:t,height:n},...v},!i&&S.createElement(ne,null,r),S.createElement("div",{ref:g,style:{...G.fullWidth,...!i&&G.hide},className:p}))}var ie=ue,Y=e.memo(ie);function oe(t){e.useEffect(t,[])}var J=oe;function ae(t,n,i=!0){let r=e.useRef(!0);e.useEffect(r.current||!i?()=>{r.current=!1}:t,n)}var M=ae;function y(){}function V(t,n,i,r){return ce(t,r)||le(t,n,i,r)}function ce(t,n){return t.editor.getModel(Z(t,n))}function le(t,n,i,r){return t.editor.createModel(n,i,r?Z(t,r):void 0)}function Z(t,n){return t.Uri.parse(n)}function se({original:t,modified:n,language:i,originalLanguage:r,modifiedLanguage:g,originalModelPath:p,modifiedModelPath:v,keepCurrentOriginalModel:E=!1,keepCurrentModifiedModel:U=!1,theme:w="light",loading:b="Loading...",options:m={},height:I="100%",width:T="100%",className:W,wrapperProps:F={},beforeMount:z=y,onMount:H=y}){let[h,C]=e.useState(!1),[k,c]=e.useState(!0),l=e.useRef(null),a=e.useRef(null),O=e.useRef(null),d=e.useRef(H),u=e.useRef(z),L=e.useRef(!1);J(()=>{let o=_.init();return o.then(s=>(a.current=s)&&c(!1)).catch(s=>s?.type!=="cancelation"&&console.error("Monaco initialization: error:",s)),()=>l.current?x():o.cancel()}),M(()=>{if(l.current&&a.current){let o=l.current.getOriginalEditor(),s=V(a.current,t||"",r||i||"text",p||"");s!==o.getModel()&&o.setModel(s)}},[p],h),M(()=>{if(l.current&&a.current){let o=l.current.getModifiedEditor(),s=V(a.current,n||"",g||i||"text",v||"");s!==o.getModel()&&o.setModel(s)}},[v],h),M(()=>{let o=l.current.getModifiedEditor();o.getOption(a.current.editor.EditorOption.readOnly)?o.setValue(n||""):n!==o.getValue()&&(o.executeEdits("",[{range:o.getModel().getFullModelRange(),text:n||"",forceMoveMarkers:!0}]),o.pushUndoStop())},[n],h),M(()=>{l.current?.getModel()?.original.setValue(t||"")},[t],h),M(()=>{let{original:o,modified:s}=l.current.getModel();a.current.editor.setModelLanguage(o,r||i||"text"),a.current.editor.setModelLanguage(s,g||i||"text")},[i,r,g],h),M(()=>{a.current?.editor.setTheme(w)},[w],h),M(()=>{l.current?.updateOptions(m)},[m],h);let P=e.useCallback(()=>{if(!a.current)return;u.current(a.current);let o=V(a.current,t||"",r||i||"text",p||""),s=V(a.current,n||"",g||i||"text",v||"");l.current?.setModel({original:o,modified:s})},[i,n,g,t,r,p,v]),D=e.useCallback(()=>{!L.current&&O.current&&(l.current=a.current.editor.createDiffEditor(O.current,{automaticLayout:!0,...m}),P(),a.current?.editor.setTheme(w),C(!0),L.current=!0)},[m,w,P]);e.useEffect(()=>{h&&d.current(l.current,a.current)},[h]),e.useEffect(()=>{!k&&!h&&D()},[k,h,D]);function x(){let o=l.current?.getModel();E||o?.original?.dispose(),U||o?.modified?.dispose(),l.current?.dispose()}return S.createElement(Y,{width:T,height:I,isEditorReady:h,loading:b,_ref:O,className:W,wrapperProps:F})}var de=se,Le=e.memo(de);function fe(){let[t,n]=e.useState(_.__getMonacoInstance());return J(()=>{let i;return t||(i=_.init(),i.then(r=>{n(r)})),()=>i?.cancel()}),t}var Ve=fe;function ge(t){let n=e.useRef();return e.useEffect(()=>{n.current=t},[t]),n.current}var pe=ge,N=new Map;function he({defaultValue:t,defaultLanguage:n,defaultPath:i,value:r,language:g,path:p,theme:v="light",line:E,loading:U="Loading...",options:w={},overrideServices:b={},saveViewState:m=!0,keepCurrentModel:I=!1,width:T="100%",height:W="100%",className:F,wrapperProps:z={},beforeMount:H=y,onMount:h=y,onChange:C,onValidate:k=y}){let[c,l]=e.useState(!1),[a,O]=e.useState(!0),d=e.useRef(null),u=e.useRef(null),L=e.useRef(null),P=e.useRef(h),D=e.useRef(H),x=e.useRef(),o=e.useRef(r),s=pe(p),Q=e.useRef(!1),j=e.useRef(!1);J(()=>{let f=_.init();return f.then(R=>(d.current=R)&&O(!1)).catch(R=>R?.type!=="cancelation"&&console.error("Monaco initialization: error:",R)),()=>u.current?$():f.cancel()}),M(()=>{let f=V(d.current,t||r||"",n||g||"",p||i||"");f!==u.current?.getModel()&&(m&&N.set(s,u.current?.saveViewState()),u.current?.setModel(f),m&&u.current?.restoreViewState(N.get(p)))},[p],c),M(()=>{u.current?.updateOptions(w)},[w],c),M(()=>{!u.current||r===void 0||(u.current.getOption(d.current.editor.EditorOption.readOnly)?u.current.setValue(r):r!==u.current.getValue()&&(j.current=!0,u.current.executeEdits("",[{range:u.current.getModel().getFullModelRange(),text:r,forceMoveMarkers:!0}]),u.current.pushUndoStop(),j.current=!1))},[r],c),M(()=>{let f=u.current?.getModel();f&&g&&d.current?.editor.setModelLanguage(f,g)},[g],c),M(()=>{E!==void 0&&u.current?.revealLine(E)},[E],c),M(()=>{d.current?.editor.setTheme(v)},[v],c);let X=e.useCallback(()=>{if(!(!L.current||!d.current)&&!Q.current){D.current(d.current);let f=p||i,R=V(d.current,r||t||"",n||g||"",f||"");u.current=d.current?.editor.create(L.current,{model:R,automaticLayout:!0,...w},b),m&&u.current.restoreViewState(N.get(f)),d.current.editor.setTheme(v),E!==void 0&&u.current.revealLine(E),l(!0),Q.current=!0}},[t,n,i,r,g,p,w,b,m,v,E]);e.useEffect(()=>{c&&P.current(u.current,d.current)},[c]),e.useEffect(()=>{!a&&!c&&X()},[a,c,X]),o.current=r,e.useEffect(()=>{c&&C&&(x.current?.dispose(),x.current=u.current?.onDidChangeModelContent(f=>{j.current||C(u.current.getValue(),f)}))},[c,C]),e.useEffect(()=>{if(c){let f=d.current.editor.onDidChangeMarkers(R=>{let A=u.current.getModel()?.uri;if(A&&R.find(B=>B.path===A.path)){let B=d.current.editor.getModelMarkers({resource:A});k?.(B)}});return()=>{f?.dispose()}}return()=>{}},[c,k]);function $(){x.current?.dispose(),I?m&&N.set(p,u.current.saveViewState()):u.current.getModel()?.dispose(),u.current.dispose()}return S.createElement(Y,{width:T,height:W,isEditorReady:c,loading:U,_ref:L,className:F,wrapperProps:z})}var Me=he,ve=e.memo(Me),Se=ve;export{Le as DiffEditor,ve as Editor,Se as default,_ as loader,Ve as useMonaco};
