import{c as J,r as g,s as c,a as F,u as y,b as h,m as L,j as e,n as Q,F as B,M as P,o as E,L as V,C as X,p as D,e as Y,g as Z,q as A}from"./index-eo1TGWw1.js";import{S as T,F as S,T as N,a as W,b as z}from"./ToggleBar-6krPHTN5.js";import{E as C}from"./eye-CKXl4JVb.js";import{S as ee}from"./send-ClTqjcCV.js";import{V as I}from"./video-DmjQggs5.js";import"./vendor-terminal-Co9mG8Of.js";import"./vendor-utils-BeCPKUKe.js";import"./folder-CD3APD0O.js";import"./check-C9cXxZm0.js";/**
 * @license lucide-react v0.439.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=J("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.439.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=J("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);function k(n,x,d=500){const s=g.useRef();return g.useEffect(()=>()=>{s.current&&clearTimeout(s.current)},[]),g.useCallback(async(j,b=!0)=>{s.current&&clearTimeout(s.current),s.current=setTimeout(async()=>{try{await n(j),await x(),b&&c("Settings saved","success")}catch(r){const t=r instanceof Error?r.message:String(r);c(`Failed to save: ${t}`,"error"),console.error("Debounced save failed:",r)}},d)},[n,x,d])}const se=()=>h("/api/settings/capture"),te=()=>h("/api/settings/security"),ae=()=>h("/api/settings/mail"),ne=()=>h("/api/system/startup"),ie=()=>h("/api/system/admin/status");function Ne(){const{t:n,language:x,setLanguage:d}=F(),[s,o]=g.useState("general");g.useEffect(()=>{const p=()=>{const f=window.location.hash.slice(1);if(!f)return;const $=f.split("/").filter(Boolean);if($[0]==="settings"&&$[1]){const U=$[1];["general","security","mail","logging","screenshots","files","vnc"].includes(U)&&o(U)}};return p(),window.addEventListener("hashchange",p),()=>window.removeEventListener("hashchange",p)},[]),g.useEffect(()=>{const f=window.location.hash.slice(1).split("/").filter(Boolean);f[0]==="settings"&&f[1]!==s&&(window.location.hash=`/settings/${s}`)},[s]);const{data:j,mutate:b}=y("startup-status",ne),{data:r,mutate:t}=y("admin-status",ie),{data:a,mutate:m}=y("ui-preferences",L),{data:l,mutate:i}=y("security-settings",te),[u,v]=g.useState({requireAuthentication:!1,password:"",confirmPassword:""}),[O,M]=g.useState(!1),[w,R]=g.useState({isOpen:!1,title:"",message:"",onConfirm:()=>{},variant:"info"});g.useEffect(()=>{l&&v(p=>({...p,requireAuthentication:l.requireAuthentication}))},[l]);const G=async p=>{try{await h("/api/system/startup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({enabled:p})}),await b(),c(n("common.success"),"success")}catch(f){c(`${n("common.error")}: ${f instanceof Error?f.message:String(f)}`,"error")}},_=async()=>{R({isOpen:!0,title:"Restart as Administrator",message:n("system.restartAdmin")+"?",onConfirm:async()=>{try{await h("/api/system/admin/restart",{method:"POST"}),c("Restarting as administrator...","success")}catch(p){c(`${n("common.error")}: ${p instanceof Error?p.message:String(p)}`,"error")}finally{R({...w,isOpen:!1})}},variant:"warning"})},K=async()=>{if(u.password!==u.confirmPassword){c("Passwords do not match","error");return}M(!0);try{await h("/api/settings/security",{method:"PUT",body:JSON.stringify({requireAuthentication:u.requireAuthentication,password:u.password||null})}),v(p=>({...p,password:"",confirmPassword:""})),await i(),c(n("common.success"),"success")}catch(p){c(`${n("common.error")}: ${p instanceof Error?p.message:String(p)}`,"error")}finally{M(!1)}};return e.jsxs("section",{className:"space-y-4",children:[e.jsxs("div",{className:"submenu-container",children:[e.jsxs("button",{onClick:()=>o("general"),className:`submenu-tab ${s==="general"?"active":""}`,children:[e.jsx(Q,{size:16}),n("settings.general")]}),e.jsxs("button",{onClick:()=>o("security"),className:`submenu-tab ${s==="security"?"active":""}`,children:[e.jsx(T,{size:16}),n("settings.security")]}),e.jsxs("button",{onClick:()=>o("mail"),className:`submenu-tab ${s==="mail"?"active":""}`,children:[e.jsx(H,{size:16}),n("settings.mail")]}),e.jsxs("button",{onClick:()=>o("logging"),className:`submenu-tab ${s==="logging"?"active":""}`,children:[e.jsx(B,{size:16}),"Logging"]}),e.jsxs("button",{onClick:()=>o("screenshots"),className:`submenu-tab ${s==="screenshots"?"active":""}`,children:[e.jsx(S,{size:16}),"Screenshots"]}),e.jsxs("button",{onClick:()=>o("files"),className:`submenu-tab ${s==="files"?"active":""}`,children:[e.jsx(S,{size:16}),"Files"]}),e.jsxs("button",{onClick:()=>o("vnc"),className:`submenu-tab ${s==="vnc"?"active":""}`,children:[e.jsx(P,{size:16}),"VNC"]})]}),s==="general"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"panel",children:[e.jsxs("h3",{className:"panel-title flex items-center gap-2",children:[e.jsx(P,{size:18})," Application"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-1",children:n("settings.language")}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(q,{size:16,className:"text-slate-500"}),e.jsxs("select",{className:"input-text",value:x,onChange:p=>d(p.target.value),children:[e.jsx("option",{value:"en",children:"English"}),e.jsx("option",{value:"de",children:"Deutsch"}),e.jsx("option",{value:"fr",children:"FranÃ§ais"}),e.jsx("option",{value:"nl",children:"Nederlands"})]})]})]})}),e.jsxs("div",{className:"space-y-3 pt-2",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-900/50 rounded-lg border border-slate-800",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(T,{size:18,className:r?.isAdministrator?"text-green-400":"text-amber-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-white",children:n("settings.runAsAdmin")}),e.jsx("p",{className:"text-xs text-slate-400",children:r?.isAdministrator?n("system.admin"):n("system.standard")})]})]}),!r?.isAdministrator&&e.jsx("button",{className:"btn-outline text-xs",onClick:_,children:n("system.restartAdmin")})]}),e.jsx(N,{label:n("settings.startWithWindows"),description:"Launch Weasel automatically at Windows startup",enabled:j?.enabled||!1,onChange:G,icon:e.jsx(P,{size:18}),iconColorEnabled:"text-green-400",iconColorDisabled:"text-slate-500"})]})]})]}),e.jsxs("div",{className:"panel",children:[e.jsxs("h3",{className:"panel-title flex items-center gap-2",children:[e.jsx(C,{size:18})," User Interface Preferences"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(N,{label:"Expand log panels by default",description:"New log panels will open expanded",enabled:a?.logPanelExpanded?.default??!1,onChange:async p=>{try{const f={...a,logPanelExpanded:{...a?.logPanelExpanded,default:p}};await E(f),m(),c("Preference saved successfully","success")}catch(f){c(`Failed to save: ${f instanceof Error?f.message:String(f)}`,"error")}},icon:e.jsx(C,{size:18})}),e.jsxs("div",{className:"pt-4 border-t border-slate-800",children:[e.jsx("h4",{className:"text-sm font-semibold text-white mb-3",children:"Pagination Defaults"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-1",children:"Default items per page (text data)"}),e.jsxs("select",{className:"input-text",value:a?.defaultTextPageSize??50,onChange:async p=>{try{const f={...a,defaultTextPageSize:parseInt(p.target.value)};await E(f),m(),c("Preference saved successfully","success")}catch(f){c(`Failed to save: ${f instanceof Error?f.message:String(f)}`,"error")}},children:[e.jsx("option",{value:"25",children:"25"}),e.jsx("option",{value:"50",children:"50"}),e.jsx("option",{value:"100",children:"100"})]}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Default page size for lists, tables, and text-based data"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-1",children:"Default items per page (images)"}),e.jsxs("select",{className:"input-text",value:a?.defaultImagePageSize??25,onChange:async p=>{try{const f={...a,defaultImagePageSize:parseInt(p.target.value)};await E(f),m(),c("Preference saved successfully","success")}catch(f){c(`Failed to save: ${f instanceof Error?f.message:String(f)}`,"error")}},children:[e.jsx("option",{value:"25",children:"25"}),e.jsx("option",{value:"50",children:"50"}),e.jsx("option",{value:"100",children:"100"})]}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Default page size for image grids and thumbnails"})]})]})]})]})]})]}),s==="security"&&e.jsxs("div",{className:"panel",children:[e.jsxs("h3",{className:"panel-title flex items-center gap-2",children:[e.jsx(V,{size:18})," ",n("settings.authentication")]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(N,{label:n("settings.requireAuth"),description:"Protect web console access",enabled:u.requireAuthentication,onChange:async p=>{try{await h("/api/settings/security",{method:"PUT",body:JSON.stringify({requireAuthentication:p,password:null})}),v({...u,requireAuthentication:p}),await i(),c(n("common.success"),"success")}catch(f){c(`${n("common.error")}: ${f instanceof Error?f.message:String(f)}`,"error")}},icon:e.jsx(T,{size:18})}),e.jsxs("div",{className:"space-y-3 pt-2 border-t border-slate-800",children:[e.jsx("p",{className:"text-sm font-medium text-slate-300",children:n("settings.changePassword")}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"New Password"}),e.jsx("input",{type:"password",className:"input-text",value:u.password,onChange:p=>v({...u,password:p.target.value}),placeholder:"Leave empty to keep current"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Confirm Password"}),e.jsx("input",{type:"password",className:"input-text",value:u.confirmPassword,onChange:p=>v({...u,confirmPassword:p.target.value}),placeholder:"Confirm new password"})]})]}),e.jsxs("button",{className:"btn-primary",onClick:K,disabled:O||!u.password||u.password!==u.confirmPassword,children:[e.jsx(W,{size:16})," ",n(O?"common.loading":"settings.changePassword")]})]})]})]}),s==="mail"&&e.jsx(re,{}),s==="logging"&&e.jsx(oe,{}),s==="screenshots"&&e.jsx(le,{}),s==="files"&&e.jsx(ce,{}),s==="vnc"&&e.jsx(de,{}),e.jsx(X,{isOpen:w.isOpen,title:w.title,message:w.message,onConfirm:w.onConfirm,onCancel:()=>R(p=>({...p,isOpen:!1})),variant:w.variant})]})}function re(){const{t:n}=F(),{data:x,mutate:d}=y("smtp-settings",ae),[s,o]=g.useState({host:"smtp.gmail.com",port:587,enableSsl:!0,username:"",password:"",fromAddress:"",fromName:"Weasel Disk Monitor",testRecipient:""}),[j,b]=g.useState(!1),[r,t]=g.useState("");g.useEffect(()=>{x&&(o(x),x.testRecipient&&t(x.testRecipient))},[x]);const a=k(async l=>{await h("/api/settings/mail",{method:"PUT",body:JSON.stringify({...l,testRecipient:r})})},d,500),m=async()=>{if(!r){c("Please enter a recipient email address","error");return}b(!0);try{await h("/api/settings/mail/test",{method:"POST",body:JSON.stringify({recipient:r})}),c("Test email sent successfully","success")}catch(l){const i=l instanceof Error?l.message:String(l);c(`Failed to send test email: ${i}`,"error")}finally{b(!1)}};return e.jsxs("div",{className:"panel",children:[e.jsxs("h3",{className:"panel-title flex items-center gap-2",children:[e.jsx(H,{size:18})," ",n("settings.smtpSettings")]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm text-slate-300",children:n("settings.host")}),e.jsx("input",{className:"input-text",value:s.host,onChange:l=>{const i={...s,host:l.target.value};o(i),a(i,!1)}})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm text-slate-300",children:n("settings.port")}),e.jsx("input",{type:"number",className:"input-text",value:s.port,onChange:l=>{const i={...s,port:Number(l.target.value)};o(i),a(i,!1)}})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm text-slate-300",children:n("settings.username")}),e.jsx("input",{className:"input-text",value:s.username||"",onChange:l=>{const i={...s,username:l.target.value};o(i),a(i,!1)}})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm text-slate-300",children:n("settings.password")}),e.jsx("input",{type:"password",className:"input-text",value:s.password||"",onChange:l=>{const i={...s,password:l.target.value};o(i),a(i,!1)}})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm text-slate-300",children:n("settings.senderEmail")}),e.jsx("input",{className:"input-text",value:s.fromAddress||"",onChange:l=>{const i={...s,fromAddress:l.target.value};o(i),a(i,!1)}})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm text-slate-300",children:n("settings.senderName")}),e.jsx("input",{className:"input-text",value:s.fromName||"",onChange:l=>{const i={...s,fromName:l.target.value};o(i),a(i,!1)}})]})]}),e.jsx("div",{className:"pt-2",children:e.jsx(N,{label:n("settings.useSsl"),description:"Use SSL/TLS encryption",enabled:s.enableSsl,onChange:async l=>{try{const i={...s,enableSsl:l};o(i),await h("/api/settings/mail",{method:"PUT",body:JSON.stringify({...i,testRecipient:r})}),await d(),c(n("common.success"),"success")}catch(i){c(`${n("common.error")}: ${i instanceof Error?i.message:String(i)}`,"error")}},icon:e.jsx(V,{size:18})})}),e.jsxs("div",{className:"pt-4 border-t border-slate-800",children:[e.jsx("h4",{className:"text-sm font-medium text-white mb-3",children:n("settings.sendTestEmail")}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{className:"input-text flex-1",placeholder:n("settings.recipient"),value:r,onChange:l=>t(l.target.value)}),e.jsxs("button",{className:"btn-outline",onClick:m,disabled:j,children:[e.jsx(ee,{size:16})," ",n(j?"common.loading":"settings.sendTestEmail")]})]})]})]})]})}function le(){F();const{data:n,mutate:x}=y("capture-settings",se),{data:d,mutate:s}=y("ui-preferences",L),[o,j]=g.useState({folder:"",timedFolder:"",filenamePattern:"",enableIntervalCapture:!1,intervalSeconds:60}),[b,r]=g.useState(!1),[t,a]=g.useState(!1);g.useEffect(()=>{n&&j({folder:n.folder||"",timedFolder:n.timedFolder||"",filenamePattern:n.filenamePattern||"",enableIntervalCapture:!1,intervalSeconds:60})},[n]);const m=k(async l=>{await h("/api/settings/capture",{method:"PUT",body:JSON.stringify({folder:l.folder,timedFolder:l.timedFolder,filenamePattern:l.filenamePattern,enableIntervalCapture:n?.enableIntervalCapture||!1,intervalSeconds:n?.intervalSeconds||60})})},x,500);return e.jsxs("div",{className:"panel",children:[e.jsxs("h3",{className:"panel-title flex items-center gap-2",children:[e.jsx(S,{size:18})," Screenshots"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-1",children:"Screenshot Folder"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{className:"input-text flex-1",value:D(o.folder),onChange:l=>{const i=l.target.value.replace(/\\\\/g,"\\"),u={...o,folder:i};j(u),m(u,!1)}}),e.jsx("button",{className:"btn-outline",type:"button",onClick:()=>r(!0),children:e.jsx(S,{size:16})})]}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Default location for manual screenshots"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-1",children:"Timed Screenshot Folder"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{className:"input-text flex-1",value:D(o.timedFolder||""),onChange:l=>{const i=l.target.value.replace(/\\\\/g,"\\"),u={...o,timedFolder:i};j(u),m(u,!1)}}),e.jsx("button",{className:"btn-outline",type:"button",onClick:()=>a(!0),children:e.jsx(S,{size:16})})]}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Location for automatic interval screenshots"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-1",children:"Filename Pattern"}),e.jsx("input",{className:"input-text",value:o.filenamePattern,onChange:l=>{const i={...o,filenamePattern:l.target.value};j(i),m(i,!1)},placeholder:"screenshot_{timestamp}.png"}),e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Use ","{timestamp}"," for date/time, ","{display}"," for display number"]})]}),e.jsx("div",{className:"pt-2 border-t border-slate-800",children:e.jsx(N,{label:"Expand log panel by default",description:"Screenshot capture logs",enabled:d?.logPanelExpanded?.Screenshots??!1,onChange:async l=>{try{const i={...d,logPanelExpanded:{...d?.logPanelExpanded,Screenshots:l}};await E(i),await s(),c("Preference saved successfully","success")}catch(i){c(`Failed to save: ${i instanceof Error?i.message:String(i)}`,"error")}},icon:e.jsx(C,{size:18})})}),b&&e.jsx(z,{initialPath:o.folder,onSelect:async l=>{const i=l.replace(/\\\\/g,"\\"),u={...o,folder:i};j(u),r(!1);try{await h("/api/settings/capture",{method:"PUT",body:JSON.stringify({folder:i,timedFolder:o.timedFolder,filenamePattern:o.filenamePattern,enableIntervalCapture:n?.enableIntervalCapture||!1,intervalSeconds:n?.intervalSeconds||60})}),await x(),c("Folder saved successfully","success")}catch(v){c(`Failed to save: ${v instanceof Error?v.message:String(v)}`,"error")}},onCancel:()=>r(!1)}),t&&e.jsx(z,{initialPath:o.timedFolder||"",onSelect:async l=>{const i=l.replace(/\\\\/g,"\\"),u={...o,timedFolder:i};j(u),a(!1);try{await h("/api/settings/capture",{method:"PUT",body:JSON.stringify({folder:o.folder,timedFolder:i,filenamePattern:o.filenamePattern,enableIntervalCapture:n?.enableIntervalCapture||!1,intervalSeconds:n?.intervalSeconds||60})}),await x(),c("Folder saved successfully","success")}catch(v){c(`Failed to save: ${v instanceof Error?v.message:String(v)}`,"error")}},onCancel:()=>a(!1)})]})]})}function oe(){const n=()=>h("/api/settings/logging"),{data:x,mutate:d}=y("logging-settings",n),[s,o]=g.useState({folder:"",retentionDays:14,minimumLevel:"Information",maxFileSizeBytes:10*1024*1024,maxFilesPerDay:5,enableSizeRotation:!0,componentEnabled:{VNC:!0,DiskMonitor:!0,ApplicationMonitor:!0,Screenshots:!0,General:!0},componentLevels:{}}),[j,b]=g.useState(!1);g.useEffect(()=>{x&&o({...x,componentEnabled:x.componentEnabled||{VNC:!0,DiskMonitor:!0,ApplicationMonitor:!0,Screenshots:!0,General:!0},componentLevels:x.componentLevels||{}})},[x]);const r=k(async t=>{await h("/api/settings/logging",{method:"PUT",body:JSON.stringify(t)})},d,500);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"panel",children:[e.jsxs("h3",{className:"panel-title flex items-center gap-2",children:[e.jsx(B,{size:18})," Log File Rotation"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-1",children:"Log Folder"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{className:"input-text flex-1",value:D(s.folder),onChange:t=>{const a=t.target.value.replace(/\\\\/g,"\\"),m={...s,folder:a};o(m),r(m,!1)}}),e.jsx("button",{className:"btn-outline",type:"button",onClick:()=>b(!0),children:e.jsx(S,{size:16})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-1",children:"Retention Days"}),e.jsx("input",{type:"number",className:"input-text",min:"0",value:s.retentionDays,onChange:t=>{const a={...s,retentionDays:parseInt(t.target.value)||0};o(a),r(a,!1)}}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"How many days to keep log files (0 = keep forever)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-1",children:"Minimum Log Level"}),e.jsxs("select",{className:"input-text",value:s.minimumLevel,onChange:async t=>{const a={...s,minimumLevel:t.target.value};o(a);try{await h("/api/settings/logging",{method:"PUT",body:JSON.stringify(a)}),await d(),c("Log level saved successfully","success")}catch(m){c(`Failed to save: ${m instanceof Error?m.message:String(m)}`,"error")}},children:[e.jsx("option",{value:"Trace",children:"Trace"}),e.jsx("option",{value:"Debug",children:"Debug"}),e.jsx("option",{value:"Information",children:"Information"}),e.jsx("option",{value:"Warning",children:"Warning"}),e.jsx("option",{value:"Error",children:"Error"}),e.jsx("option",{value:"Critical",children:"Critical"}),e.jsx("option",{value:"None",children:"None"})]})]})]}),e.jsxs("div",{className:"pt-2 border-t border-slate-800",children:[e.jsx(N,{label:"Enable size-based rotation",description:"Rotate log files when they reach a certain size",enabled:s.enableSizeRotation,onChange:async t=>{try{const a={...s,enableSizeRotation:t};o(a),await h("/api/settings/logging",{method:"PUT",body:JSON.stringify(a)}),await d(),c("Settings saved successfully","success")}catch(a){c(`Failed to save: ${a instanceof Error?a.message:String(a)}`,"error")}}}),s.enableSizeRotation&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4 pl-6 border-l-2 border-slate-800",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-1",children:"Max File Size (MB)"}),e.jsx("input",{type:"number",className:"input-text",min:"1",step:"1",value:Math.round(s.maxFileSizeBytes/(1024*1024)),onChange:t=>{const a=parseInt(t.target.value)||1,m={...s,maxFileSizeBytes:a*1024*1024};o(m),r(m,!1)}}),e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Current: ",Y(s.maxFileSizeBytes)]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-1",children:"Max Files Per Day"}),e.jsx("input",{type:"number",className:"input-text",min:"0",value:s.maxFilesPerDay,onChange:t=>{const a={...s,maxFilesPerDay:parseInt(t.target.value)||0};o(a),r(a,!1)}}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Maximum rotated files to keep per day (0 = unlimited)"})]})]})]})]})]}),e.jsxs("div",{className:"panel",children:[e.jsxs("h3",{className:"panel-title flex items-center gap-2",children:[e.jsx(P,{size:18})," Component Logging"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-slate-400",children:"Enable or disable logging for specific components. Each component writes to its own log file in a subfolder."}),e.jsx("div",{className:"space-y-3",children:["VNC","DiskMonitor","ApplicationMonitor","Screenshots","Files","General"].map(t=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-900/50 rounded border border-slate-800",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-300 cursor-pointer",htmlFor:`component-${t}`,children:t}),e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:[t==="VNC"&&"VNC server and connection logs",t==="DiskMonitor"&&"Disk and folder monitoring logs",t==="ApplicationMonitor"&&"Application monitoring and restart logs",t==="Screenshots"&&"Screenshot capture and interval logs",t==="Files"&&"File Explorer operations and navigation logs",t==="General"&&"General application logs"]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("select",{className:"input-text text-xs py-1 w-24",value:s.componentLevels?.[t]||s.minimumLevel,onChange:async a=>{const m={...s,componentLevels:{...s.componentLevels,[t]:a.target.value}};o(m);try{await h("/api/settings/logging",{method:"PUT",body:JSON.stringify(m)}),await d()}catch(l){console.error("Failed to save component level:",l)}},onClick:a=>a.stopPropagation(),children:[e.jsx("option",{value:"Trace",children:"Trace"}),e.jsx("option",{value:"Debug",children:"Debug"}),e.jsx("option",{value:"Information",children:"Info"}),e.jsx("option",{value:"Warning",children:"Warn"}),e.jsx("option",{value:"Error",children:"Error"}),e.jsx("option",{value:"Critical",children:"Critical"}),e.jsx("option",{value:"None",children:"None"})]}),e.jsx("input",{type:"checkbox",id:`component-${t}`,className:"checkbox",checked:s.componentEnabled?.[t]??!0,onChange:async a=>{const m={...s,componentEnabled:{...s.componentEnabled,[t]:a.target.checked}};o(m);try{await h("/api/settings/logging",{method:"PUT",body:JSON.stringify(m)}),await d()}catch(l){console.error("Failed to save component enabled state:",l)}}})]})]},t))})]})]}),j&&e.jsx(z,{initialPath:s.folder,onSelect:t=>{const a=t.replace(/\\\\/g,"\\");o({...s,folder:a}),b(!1)},onCancel:()=>b(!1)})]})}function ce(){F();const[n,x]=g.useState(!1),{data:d,mutate:s}=y("file-explorer-settings",Z),{data:o,mutate:j}=y("ui-preferences",L),[b,r]=g.useState({homeFolder:""});g.useEffect(()=>{d&&r(d)},[d]);const t=k(async a=>{await A(a)},s,500);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"panel",children:[e.jsxs("h3",{className:"panel-title flex items-center gap-2",children:[e.jsx(S,{size:18})," File Explorer Configuration"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-1",children:"Home Folder"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{className:"input-text flex-1",value:D(b.homeFolder),onChange:a=>{const m=a.target.value.replace(/\\\\/g,"\\"),l={...b,homeFolder:m};r(l),t(l,!1)}}),e.jsx("button",{className:"btn-outline",type:"button",onClick:()=>x(!0),children:e.jsx(S,{size:16})})]}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Default starting location for File Explorer"})]}),n&&e.jsx(z,{initialPath:b.homeFolder,onSelect:async a=>{const m=a.replace(/\\\\/g,"\\"),l={...b,homeFolder:m};r(l),x(!1);try{await A(l),await s(),c("Home folder saved successfully","success")}catch(i){c(`Failed to save: ${i instanceof Error?i.message:String(i)}`,"error")}},onCancel:()=>x(!1)})]})]}),e.jsxs("div",{className:"panel",children:[e.jsxs("h3",{className:"panel-title flex items-center gap-2",children:[e.jsx(C,{size:18})," Display Preferences"]}),e.jsx("div",{className:"space-y-4",children:e.jsx(N,{label:"Expand log panel by default",description:"File Explorer operation logs",enabled:o?.logPanelExpanded?.Files??!1,onChange:async a=>{try{const m={...o,logPanelExpanded:{...o?.logPanelExpanded,Files:a}};await E(m),await j(),c("Preference saved successfully","success")}catch(m){c(`Failed to save: ${m instanceof Error?m.message:String(m)}`,"error")}},icon:e.jsx(C,{size:18})})})]})]})}function de(){const{t:n}=F(),[x,d]=g.useState(!1),[s,o]=g.useState(!1),[j,b]=g.useState(""),{data:r,mutate:t}=y("vnc-config",()=>h("/api/vnc/config")),[a,m]=g.useState({enabled:!1,port:5900,allowRemote:!1,hasPassword:!1,autoStart:!1});g.useEffect(()=>{r&&m(r)},[r]);const l=k(async u=>{await h("/api/vnc/config",{method:"PUT",body:JSON.stringify({enabled:!0,port:u.port,allowRemote:u.allowRemote,autoStart:u.autoStart,password:void 0})})},t,500),i=async()=>{if(!j){c("Please enter a password","error");return}d(!0);try{await h("/api/vnc/config",{method:"PUT",body:JSON.stringify({enabled:!0,port:a.port,allowRemote:a.allowRemote,autoStart:a.autoStart,password:j})}),await t(),b(""),c(n("settings.remoteDesktop.saveSuccess"),"success")}catch(u){c(n("settings.remoteDesktop.saveFailure",{message:u instanceof Error?u.message:String(u)}),"error")}finally{d(!1)}};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"panel space-y-4",children:[e.jsxs("h3",{className:"panel-title flex items-center gap-2",children:[e.jsx(P,{size:18})," ",n("settings.remoteDesktop.title")]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"vnc-port",className:"block text-sm text-slate-400 mb-1",children:n("settings.remoteDesktop.port")}),e.jsx("input",{type:"number",id:"vnc-port",min:1024,max:65535,className:"input-text w-32",value:a.port,onChange:u=>{const v={...a,port:parseInt(u.target.value)||5900};m(v),l(v,!1)}})]}),e.jsx(N,{label:"Start automatically",description:"Start VNC server when application launches",enabled:a.autoStart??!1,onChange:async u=>{try{const v={...a,autoStart:u};m(v),await h("/api/vnc/config",{method:"PUT",body:JSON.stringify({enabled:!0,port:a.port,allowRemote:a.allowRemote,autoStart:u,password:void 0})}),await t(),c(n("common.success"),"success")}catch(v){c(`${n("common.error")}: ${v instanceof Error?v.message:String(v)}`,"error")}},icon:e.jsx(P,{size:18})}),e.jsx(N,{label:n("settings.remoteDesktop.allowRemote"),description:"Allow connections from other machines",enabled:a.allowRemote,onChange:async u=>{try{const v={...a,allowRemote:u};m(v),await h("/api/vnc/config",{method:"PUT",body:JSON.stringify({enabled:!0,port:a.port,allowRemote:u,autoStart:a.autoStart,password:void 0})}),await t(),c(n("common.success"),"success")}catch(v){c(`${n("common.error")}: ${v instanceof Error?v.message:String(v)}`,"error")}},icon:e.jsx(q,{size:18})}),a.allowRemote&&e.jsx("div",{className:"bg-amber-900/20 border border-amber-500/50 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(T,{size:16,className:"text-amber-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-amber-200",children:[e.jsx("p",{className:"font-semibold mb-1",children:n("settings.remoteDesktop.securityWarning")}),e.jsx("p",{children:n("settings.remoteDesktop.securityWarningText")})]})]})}),e.jsxs("div",{className:"pt-2 border-t border-slate-800",children:[e.jsx("label",{htmlFor:"vnc-password",className:"block text-sm text-slate-400 mb-2",children:n("settings.remoteDesktop.password")}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:s?"text":"password",id:"vnc-password",className:"input-text flex-1",placeholder:a.hasPassword?n("settings.remoteDesktop.passwordPlaceholder"):n("settings.remoteDesktop.passwordEmpty"),value:j,onChange:u=>b(u.target.value)}),e.jsx("button",{className:"btn-outline",onClick:()=>o(!s),title:n(s?"settings.remoteDesktop.hidePassword":"settings.remoteDesktop.showPassword"),children:e.jsx(C,{size:16})}),e.jsxs("button",{className:"btn-primary",onClick:i,disabled:x||!j,children:[e.jsx(W,{size:16})," ",x?"Saving...":"Set Password"]})]}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:n("settings.remoteDesktop.passwordHint")})]})]})]}),e.jsx(me,{})]})}function me(){F();const{data:n,mutate:x}=y("vnc-recording-config",()=>h("/api/vnc/recordings/config")),[d,s]=g.useState({rootFolder:"",maxRecordingDurationMinutes:120,retentionDays:30,enableMotionDetection:!1,motionDetectionThresholdPercent:10,motionDetectionBlockSize:32,motionDetectionPauseDelaySeconds:10,recordingFps:5,useProfileSubfolders:!0}),[o,j]=g.useState(!1);g.useEffect(()=>{n&&s(n)},[n]);const b=k(async r=>{await h("/api/vnc/recordings/config",{method:"PUT",body:JSON.stringify(r)})},x,500);return e.jsxs("div",{className:"panel space-y-4",children:[e.jsxs("h3",{className:"panel-title flex items-center gap-2",children:[e.jsx(I,{size:18})," VNC Recording"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"recording-folder",className:"block text-sm text-slate-400 mb-1",children:"Recordings Folder"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{className:"input-text flex-1",value:D(d.rootFolder),onChange:r=>{const t=r.target.value.replace(/\\\\/g,"\\"),a={...d,rootFolder:t};s(a),b(a,!1)}}),e.jsx("button",{className:"btn-outline",type:"button",onClick:()=>j(!0),children:e.jsx(S,{size:16})})]}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Default location for VNC session recordings"})]}),e.jsx(N,{label:"Use profile-specific subfolders",description:"Organize recordings by VNC profile",enabled:d.useProfileSubfolders,onChange:async r=>{try{const t={...d,useProfileSubfolders:r};s(t),await h("/api/vnc/recordings/config",{method:"PUT",body:JSON.stringify(t)}),await x(),c("Settings saved successfully","success")}catch(t){c(`Failed to save: ${t instanceof Error?t.message:String(t)}`,"error")}},icon:e.jsx(S,{size:18})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"max-duration",className:"block text-sm text-slate-400 mb-1",children:"Max Recording Duration (minutes)"}),e.jsx("input",{type:"number",id:"max-duration",min:1,max:480,className:"input-text w-full",value:d.maxRecordingDurationMinutes,onChange:r=>{const t={...d,maxRecordingDurationMinutes:parseInt(r.target.value)||120};s(t),b(t,!1)}})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"retention-days",className:"block text-sm text-slate-400 mb-1",children:"Retention Period (days)"}),e.jsx("input",{type:"number",id:"retention-days",min:1,max:365,className:"input-text w-full",value:d.retentionDays,onChange:r=>{const t={...d,retentionDays:parseInt(r.target.value)||30};s(t),b(t,!1)}})]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"recording-fps",className:"block text-sm text-slate-400 mb-1",children:["Recording FPS: ",d.recordingFps]}),e.jsx("input",{type:"range",id:"recording-fps",min:1,max:30,className:"w-full",value:d.recordingFps,onChange:r=>{const t={...d,recordingFps:parseInt(r.target.value)};s(t),b(t,!1)}}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Lower FPS reduces file size but may result in choppy playback"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(N,{label:"Enable Motion Detection",description:"Only record when screen changes are detected",enabled:d.enableMotionDetection,onChange:async r=>{try{const t={...d,enableMotionDetection:r};s(t),await h("/api/vnc/recordings/config",{method:"PUT",body:JSON.stringify(t)}),await x(),c("Settings saved successfully","success")}catch(t){c(`Failed to save: ${t instanceof Error?t.message:String(t)}`,"error")}},icon:e.jsx(I,{size:18})}),d.enableMotionDetection&&e.jsxs("div",{className:"ml-6 space-y-3 border-l-2 border-blue-500/30 pl-4",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"motion-threshold",className:"block text-sm text-slate-400 mb-1",children:["Motion Sensitivity: ",d.motionDetectionThresholdPercent,"%"]}),e.jsx("input",{type:"range",id:"motion-threshold",min:1,max:50,className:"w-full",value:d.motionDetectionThresholdPercent,onChange:r=>{const t={...d,motionDetectionThresholdPercent:parseInt(r.target.value)};s(t),b(t,!1)}}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Lower values = more sensitive (records with less change)"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"block-size",className:"block text-sm text-slate-400 mb-1",children:"Detection Block Size"}),e.jsxs("select",{id:"block-size",className:"input-text w-full",value:d.motionDetectionBlockSize,onChange:async r=>{const t=parseInt(r.target.value),a={...d,motionDetectionBlockSize:t};s(a);try{await h("/api/vnc/recordings/config",{method:"PUT",body:JSON.stringify(a)}),await x(),c("Block size saved successfully","success")}catch(m){c(`Failed to save: ${m instanceof Error?m.message:String(m)}`,"error")}},children:[e.jsx("option",{value:16,children:"16x16 (High precision, higher CPU)"}),e.jsx("option",{value:32,children:"32x32 (Balanced)"}),e.jsx("option",{value:64,children:"64x64 (Low precision, lower CPU)"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"pause-delay",className:"block text-sm text-slate-400 mb-1",children:["Pause Delay: ",d.motionDetectionPauseDelaySeconds," seconds"]}),e.jsx("input",{type:"range",id:"pause-delay",min:1,max:60,className:"w-full",value:d.motionDetectionPauseDelaySeconds,onChange:r=>{const t={...d,motionDetectionPauseDelaySeconds:parseInt(r.target.value)};s(t),b(t,!1)}}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Time to wait before pausing recording when no motion is detected"})]})]})]})]}),o&&e.jsx(z,{initialPath:d.rootFolder,onSelect:async r=>{const t=r.replace(/\\\\/g,"\\"),a={...d,rootFolder:t};s(a),j(!1);try{await h("/api/vnc/recordings/config",{method:"PUT",body:JSON.stringify(a)}),await x(),c("Recordings folder saved successfully","success")}catch(m){c(`Failed to save: ${m instanceof Error?m.message:String(m)}`,"error")}},onCancel:()=>j(!1)})]})}export{Ne as default};
