const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-D_DoTZq9.js","assets/vendor-editor-Cbnfy5IV.js","assets/vendor-utils-BeCPKUKe.js","assets/index-B2pomQzr.js","assets/vendor-terminal-Co9mG8Of.js","assets/vendor-terminal-C0BCwPpi.css","assets/index-VN4hMGb-.css"])))=>i.map(i=>d[i]);
import{c as N,r as a,j as e,u as Ee,g as as,a as ns,b as x,H as ls,X as I,A as V,d as q,f as bt,P as jt,F as is,e as os,h as _,C as rs,s as p,i as cs,_ as ds}from"./index-B2pomQzr.js";import{U as kt,P as wt,R as vt}from"./upload-HX8HQ2RS.js";import{F as de}from"./folder-BH67oCG7.js";import{D as me}from"./download-gbN7CM3n.js";import{T as ue}from"./trash-2-YbxoeIgQ.js";import{A as Nt,S as ms}from"./search-Yq11YyrC.js";import{I as us}from"./image-BbBuAUfb.js";import{E as Ct}from"./eye-Becozmbq.js";import"./vendor-terminal-Co9mG8Of.js";import"./vendor-utils-BeCPKUKe.js";/**
 * @license lucide-react v0.439.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hs=N("Clipboard",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]]);/**
 * @license lucide-react v0.439.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const St=N("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.439.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=N("FileArchive",[["path",{d:"M10 12v-1",key:"v7bkov"}],["path",{d:"M10 18v-2",key:"1cjy8d"}],["path",{d:"M10 7V6",key:"dljcrl"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M15.5 22H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v16a2 2 0 0 0 .274 1.01",key:"gkbcor"}],["circle",{cx:"10",cy:"20",r:"2",key:"1xzdoj"}]]);/**
 * @license lucide-react v0.439.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=N("FilePen",[["path",{d:"M12.5 22H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v9.5",key:"1couwa"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M13.378 15.626a1 1 0 1 0-3.004-3.004l-5.01 5.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"1y4qbx"}]]);/**
 * @license lucide-react v0.439.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zt=N("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.439.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pt=N("Scissors",[["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M8.12 8.12 12 12",key:"1alkpv"}],["path",{d:"M20 4 8.12 15.88",key:"xgtan2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M14.8 14.8 20 20",key:"ptml3r"}]]);/**
 * @license lucide-react v0.439.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xs=N("StarOff",[["path",{d:"M8.34 8.34 2 9.27l5 4.87L5.82 21 12 17.77 18.18 21l-.59-3.43",key:"16m0ql"}],["path",{d:"M18.42 12.76 22 9.27l-6.91-1L12 2l-1.44 2.91",key:"1vt8nq"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.439.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ft=N("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);function fs({x:c,y:o,items:i,onClose:u}){const d=a.useRef(null);a.useEffect(()=>{const g=b=>{d.current&&!d.current.contains(b.target)&&u()};return document.addEventListener("mousedown",g),()=>document.removeEventListener("mousedown",g)},[u]);const O={top:o,left:c};return e.jsx("div",{ref:d,className:"fixed z-50 bg-slate-800 border border-slate-700 rounded-lg shadow-xl py-1 min-w-[160px]",style:O,children:i.map((g,b)=>e.jsxs("button",{className:`w-full text-left px-4 py-2 text-sm flex items-center gap-2 hover:bg-slate-700 ${g.danger?"text-red-400 hover:text-red-300":"text-slate-200 hover:text-white"}`,onClick:()=>{g.onClick(),u()},children:[g.icon&&e.jsx("span",{className:"w-4 h-4",children:g.icon}),g.label]},b))})}const ps=a.lazy(()=>ds(()=>import("./index-D_DoTZq9.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),gs=async c=>{const o=new URL("/api/fs",window.location.origin);return c&&o.searchParams.set("path",c),x(o.toString())},ys=()=>x("/api/fs/drives"),Et=c=>c.replace(/\//g,"\\"),Ae=c=>{if(!c)return"";const o=Et(c);return o.endsWith("\\")?o:`${o}\\`},Oe=c=>{if(!c)return"";let o=Et(c).replace(/\\+$/,"");if(o.startsWith("\\\\")){const d=o.split("\\").filter(Boolean);return d.length<=2?`\\\\${d.join("\\")}\\`:(d.pop(),`\\\\${d.join("\\")}\\`)}if(o.endsWith(":"))return`${o}\\`;const u=o.lastIndexOf("\\");return u<=1?`${o.slice(0,u+1)}\\`:`${o.slice(0,u)}\\`},he=(c,o)=>c?`${Ae(c)}${o}`:o,bs=c=>{switch(c.split(".").pop()?.toLowerCase()){case"js":case"jsx":return"javascript";case"ts":case"tsx":return"typescript";case"json":return"json";case"css":return"css";case"html":return"html";case"cs":return"csharp";case"sql":return"sql";case"xml":return"xml";case"md":return"markdown";case"yml":case"yaml":return"yaml";default:return"plaintext"}},Dt=c=>{const o=c.split(".").pop()?.toLowerCase();return["png","jpg","jpeg","gif","bmp","webp","svg","ico"].includes(o||"")};function Ds(){const{data:c}=Ee("file-explorer-settings",as),o=c?.homeFolder||"",[i,u]=a.useState(""),[d,O]=a.useState(null),[g,b]=a.useState(""),[Te,Re]=a.useState(!1),[Me,xe]=a.useState(!1),[$e,K]=a.useState(!1),[r,fe]=a.useState(new Set),[j,A]=a.useState(null),[k,Ue]=a.useState(()=>{try{const t=localStorage.getItem("weasel.bookmarks");return t?JSON.parse(t):[]}catch{return[]}}),[Z,pe]=a.useState(!1),[w,Be]=a.useState(""),[We,X]=a.useState(!1),[T,Je]=a.useState(null),[Lt,Q]=a.useState(""),[z,ge]=a.useState(!1),[P,ye]=a.useState(null),{t:G}=ns(),[f,It]=a.useState({key:"name",direction:"asc"}),[be,Ot]=a.useState(()=>{const t=localStorage.getItem("weasel.layout.leftPanelWidth");return t?parseInt(t):33}),[m,Y]=a.useState(null),[ee,He]=a.useState(!1),[R,At]=a.useState(()=>{const t=localStorage.getItem("weasel.files.foldersPageSize");return t?parseInt(t):50}),[je,Ve]=a.useState(1),[M,Tt]=a.useState(()=>{const t=localStorage.getItem("weasel.files.filesPageSize");return t?parseInt(t):50}),[ke,qe]=a.useState(1),[v,$]=a.useState({isOpen:!1,title:"",message:"",onConfirm:()=>{},variant:"info"});a.useEffect(()=>{const t=localStorage.getItem("weasel.lastPath");t&&!i&&u(t)},[]),a.useEffect(()=>{i&&localStorage.setItem("weasel.lastPath",i)},[i]);const{data:C,mutate:_e,isLoading:te,error:Ke}=Ee(i,gs,{revalidateOnFocus:!1}),{data:Ze}=Ee("drives",ys,{revalidateOnFocus:!1}),we=Array.isArray(Ze)?Ze:[],se=a.useMemo(()=>(Array.isArray(C)?C:[]).filter(s=>s.isDirectory),[C]),ae=a.useMemo(()=>(Array.isArray(C)?C:[]).filter(s=>!s.isDirectory),[C]),Xe=a.useMemo(()=>{if(!Array.isArray(se))return[];if(!w)return se;const t=w.toLowerCase();return se.filter(s=>s.name.toLowerCase().includes(t))},[se,w]),Qe=a.useMemo(()=>{if(!Array.isArray(ae))return[];if(!w)return ae;const t=w.toLowerCase();return ae.filter(s=>s.name.toLowerCase().includes(t))},[ae,w]),ne=a.useCallback(t=>[...t].sort((s,n)=>{let l=0;switch(f.key){case"name":l=s.name.localeCompare(n.name);break;case"size":l=s.sizeBytes-n.sizeBytes;break;case"date":l=new Date(s.modifiedAt).getTime()-new Date(n.modifiedAt).getTime();break}return f.direction==="asc"?l:-l}),[f]),le=a.useMemo(()=>ne(Xe),[Xe,ne]),ie=a.useMemo(()=>ne(Qe),[Qe,ne]),U=a.useMemo(()=>{if(R===0)return le;const t=(je-1)*R,s=t+R;return le.slice(t,s)},[le,R,je]),B=a.useMemo(()=>{if(M===0)return ie;const t=(ke-1)*M,s=t+M;return ie.slice(t,s)},[ie,M,ke]),W=t=>{It(s=>({key:t,direction:s.key===t&&s.direction==="asc"?"desc":"asc"}))},Rt=t=>{At(t),Ve(1),localStorage.setItem("weasel.files.foldersPageSize",t.toString())},Mt=t=>{Tt(t),qe(1),localStorage.setItem("weasel.files.filesPageSize",t.toString())},h=a.useCallback(()=>_e(),[_e]);a.useEffect(()=>{if(!Z)return;const t=s=>{s.target.closest(".relative")||pe(!1)};return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[Z]),a.useEffect(()=>{const t=s=>{s.target instanceof HTMLInputElement||s.target instanceof HTMLTextAreaElement||d||(s.ctrlKey&&s.key==="c"&&r.size>0?(s.preventDefault(),mt()):s.ctrlKey&&s.key==="x"&&r.size>0?(s.preventDefault(),ut()):s.ctrlKey&&s.key==="v"&&j?(s.preventDefault(),ht()):s.key==="Delete"&&r.size>0?(s.preventDefault(),dt()):s.ctrlKey&&s.key==="a"?(s.preventDefault(),Ht()):s.key==="Escape"?(s.preventDefault(),y()):(s.key==="F5"||s.ctrlKey&&s.key==="r")&&(s.preventDefault(),h()))};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[r,j,d]);const Ge=t=>{u(Ae(t.fullPath)),ze()},$t=async t=>{xe(!0);try{const s=new URL("/api/fs/content",window.location.origin);s.searchParams.set("path",t);const n=await fetch(s.toString());if(!n.ok)throw new Error(await n.text());const l=await n.text();b(l)}finally{xe(!1)}},Ye=async t=>{O(t.fullPath),K(!1),await $t(t.fullPath)},[oe,et]=a.useState(""),[Ut,F]=a.useState(!1),tt=async()=>{if(oe.trim()){if(!i){p("Select a folder before creating a new folder.","warning");return}try{await x("/api/fs/directory",{method:"POST",body:JSON.stringify({parentPath:i,name:oe.trim()})}),await h(),et(""),F(!1),p("Folder created successfully","success")}catch(t){p(`Failed to create folder: ${t instanceof Error?t.message:"Unknown error"}`,"error")}}},[re,st]=a.useState(""),[Bt,D]=a.useState(!1),at=()=>{if(!re.trim())return;const t=he(i,re.trim());O(t),b(""),K(!0),st(""),D(!1)},[ve,nt]=a.useState(null),Ne=async t=>{nt(t),$({isOpen:!0,title:"Delete Item",message:`Are you sure you want to delete "${t.name}"?`,onConfirm:async()=>{if(ve)try{const s=new URL("/api/fs",window.location.origin);s.searchParams.set("path",ve.fullPath),await x(s.toString(),{method:"DELETE"}),d===ve.fullPath&&ze(),await h(),p("Item deleted successfully","success")}catch(s){p(`Failed to delete: ${s instanceof Error?s.message:"Unknown error"}`,"error")}finally{nt(null),$({...v,isOpen:!1})}},variant:"danger"})},[J,lt]=a.useState(null),[E,Ce]=a.useState(""),[Wt,S]=a.useState(!1),Se=async t=>{lt(t),Ce(t.name),S(!0)},it=async()=>{if(!J||!E.trim()||E===J.name){S(!1);return}try{await x("/api/fs/rename",{method:"POST",body:JSON.stringify({path:J.fullPath,newName:E.trim()})}),await h(),p("Item renamed successfully","success")}catch(t){p(`Failed to rename: ${t instanceof Error?t.message:"Unknown error"}`,"error")}finally{lt(null),Ce(""),S(!1)}},Jt=async()=>{if(d){Re(!0);try{await x("/api/fs/write",{method:"POST",body:JSON.stringify({path:d,content:g})}),await h(),K(!1)}finally{Re(!1)}}},ze=()=>{O(null),b(""),K(!1),xe(!1)},ot=t=>{fe(s=>{const n=new Set(s);return n.has(t.fullPath)?n.delete(t.fullPath):n.add(t.fullPath),n})},Ht=()=>{const t=Array.isArray(U)?U:[],s=Array.isArray(B)?B:[],n=new Set([...t,...s].map(l=>l.fullPath));fe(n)},y=()=>{fe(new Set)},rt=async t=>{if(t.isDirectory){const s=`${t.name}_${new Date().toISOString().slice(0,10)}.zip`,n=he(i||Oe(t.fullPath),s);try{await x("/api/fs/bulk/zip",{method:"POST",body:JSON.stringify({sourcePaths:[t.fullPath],zipFilePath:n})}),_(n),setTimeout(async()=>{try{await x("/api/fs/bulk/delete",{method:"POST",body:JSON.stringify({paths:[n]})}),await h()}catch{}},2e3)}catch(l){p(`Failed to zip folder: ${l instanceof Error?l.message:String(l)}`,"error")}}else _(t.fullPath)},Vt=async()=>{if(r.size===0)return;const t=Array.from(r);if(t.length===1){const n=C?.find(l=>l.fullPath===t[0]);n?await rt(n):_(t[0]);return}const s=new URL("/api/fs/download/bulk",window.location.origin);await fetch(s.toString(),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({paths:t})}).then(async n=>{if(n.ok){const l=await n.blob(),L=window.URL.createObjectURL(l),H=document.createElement("a");H.href=L,H.download=`download_${new Date().toISOString().slice(0,10)}.zip`,document.body.appendChild(H),H.click(),document.body.removeChild(H),window.URL.revokeObjectURL(L)}}),y(),await h()},[qt,ct]=a.useState(0),dt=async()=>{r.size!==0&&(ct(r.size),$({isOpen:!0,title:"Delete Items",message:`Are you sure you want to delete ${r.size} item(s)?`,onConfirm:async()=>{try{await x("/api/fs/bulk/delete",{method:"POST",body:JSON.stringify({paths:Array.from(r)})}),y(),await h(),p(`${qt} item(s) deleted successfully`,"success")}catch(t){p(`Failed to delete items: ${t instanceof Error?t.message:"Unknown error"}`,"error")}finally{ct(0),$({...v,isOpen:!1})}},variant:"danger"}))},mt=()=>{r.size!==0&&A({items:Array.from(r),operation:"copy"})},ut=()=>{r.size!==0&&A({items:Array.from(r),operation:"cut"})},ht=async()=>{if(!(!j||!i))try{j.operation==="copy"?await x("/api/fs/bulk/copy",{method:"POST",body:JSON.stringify({sourcePaths:j.items,destinationPath:i})}):j.operation==="cut"&&(await x("/api/fs/bulk/move",{method:"POST",body:JSON.stringify({sourcePaths:j.items,destinationPath:i})}),A(null)),y(),await h()}catch(t){p(`Paste failed: ${t instanceof Error?t.message:"Unknown error"}`,"error")}},_t=()=>{if(!i||k.includes(i))return;const t=[...k,i];Ue(t),localStorage.setItem("weasel.bookmarks",JSON.stringify(t))},xt=t=>{const n=(Array.isArray(k)?k:[]).filter(l=>l!==t);Ue(n),localStorage.setItem("weasel.bookmarks",JSON.stringify(n))},Kt=t=>{u(t),y(),pe(!1)},ce=i&&k.includes(i),Zt=async t=>{const s=window.prompt("Zip file name (e.g., archive.zip)",`${t.name}.zip`);if(!s)return;const n=he(i||Oe(t.fullPath),s);await x("/api/fs/bulk/zip",{method:"POST",body:JSON.stringify({sourcePaths:[t.fullPath],zipFilePath:n})}),await h()},Xt=async()=>{if(r.size===0)return;const t=window.prompt("Zip file name (e.g., archive.zip)","archive.zip");if(!t)return;const s=he(i,t);await x("/api/fs/bulk/zip",{method:"POST",body:JSON.stringify({sourcePaths:Array.from(r),zipFilePath:s})}),y(),await h()},ft=async t=>{const s=i||Oe(t);await x("/api/fs/unzip",{method:"POST",body:JSON.stringify({zipFilePath:t,destinationPath:s})}),await h()},Qt=t=>{t.preventDefault(),t.stopPropagation(),We||X(!0)},Gt=t=>{t.preventDefault(),t.stopPropagation(),X(!0)},Yt=t=>{t.preventDefault(),t.stopPropagation(),t.currentTarget===t.target&&X(!1)},es=async t=>{if(t.preventDefault(),t.stopPropagation(),X(!1),!i){p("Select a folder before uploading files.","error");return}const s=Array.from(t.dataTransfer.files);if(s.length!==0)try{for(const n of s){const l=new FormData;l.append("path",Ae(i)),l.append("file",n,n.name),await cs(l)}await h()}catch(n){p(`Upload failed: ${n instanceof Error?n.message:"Unknown error"}`,"error")}},pt=async t=>{if(Dt(t)){ye(t);return}Je(t),ge(!0),Q("");try{const s=new URL("/api/fs/content",window.location.origin);s.searchParams.set("path",t);const n=await fetch(s.toString());if(n.ok){const l=await n.text();Q(l)}}catch(s){console.error("Failed to load file content:",s)}},ts=()=>{Je(null),ge(!1),Q("")};a.useEffect(()=>{if(!z||!T)return;const t=setInterval(async()=>{try{const s=new URL("/api/fs/content",window.location.origin);s.searchParams.set("path",T);const n=await fetch(s.toString());if(n.ok){const l=await n.text();Q(l)}}catch(s){console.error("Failed to refresh tail content:",s)}},2e3);return()=>clearInterval(t)},[z,T]);const ss=a.useCallback(()=>{He(!0)},[]),Pe=a.useCallback(()=>{He(!1),localStorage.setItem("weasel.layout.leftPanelWidth",be.toString())},[be]),Fe=a.useRef(null),De=a.useCallback(t=>{if(!ee||!Fe.current)return;const s=Fe.current.getBoundingClientRect(),n=(t.clientX-s.left)/s.width*100;n>=20&&n<=70&&(Ot(n),localStorage.setItem("weasel.layout.leftPanelWidth",n.toString()))},[ee]);a.useEffect(()=>(ee&&(window.addEventListener("mousemove",De),window.addEventListener("mouseup",Pe)),()=>{window.removeEventListener("mousemove",De),window.removeEventListener("mouseup",Pe)}),[ee,De,Pe]);const gt=(t,s)=>{t.preventDefault(),t.stopPropagation(),Y({x:t.clientX,y:t.clientY,item:s})},yt=a.useMemo(()=>we.find(t=>i.startsWith(t.fullPath))?.fullPath||null,[i,we]);return e.jsxs("section",{className:"space-y-4 relative",onDragOver:Qt,onDragEnter:Gt,onDragLeave:Yt,onDrop:es,children:[We&&i&&e.jsx("div",{className:"fixed inset-0 bg-sky-900/30 backdrop-blur-sm z-50 flex items-center justify-center pointer-events-none",children:e.jsxs("div",{className:"bg-slate-800 border-4 border-dashed border-sky-500 rounded-lg p-8 shadow-2xl",children:[e.jsx(kt,{size:48,className:"mx-auto mb-4 text-sky-400"}),e.jsx("p",{className:"text-xl font-semibold text-white",children:"Drop files to upload"}),e.jsxs("p",{className:"text-sm text-slate-400 mt-2",children:["to ",i]})]})}),e.jsxs("div",{className:"submenu-container",children:[e.jsxs("button",{className:`submenu-tab ${yt?"":"active"}`,onClick:()=>{u(o),y()},children:[e.jsx(de,{size:16}),"Home"]}),we.map(t=>e.jsxs("button",{className:`submenu-tab ${yt===t.fullPath?"active":""}`,onClick:()=>{u(t.fullPath),y()},children:[e.jsx(ls,{size:16}),t.name]},t.fullPath))]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-end gap-2 flex-wrap",children:[r.size>0&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn-outline",onClick:Vt,children:e.jsx(me,{size:16})}),e.jsx("button",{className:"btn-outline",onClick:dt,children:e.jsx(ue,{size:16})}),e.jsx("button",{className:"btn-outline",onClick:Xt,children:e.jsx(Nt,{size:16})}),e.jsx("button",{className:"btn-outline",onClick:mt,children:e.jsx(St,{size:16})}),e.jsx("button",{className:"btn-outline",onClick:ut,children:e.jsx(Pt,{size:16})}),e.jsx("button",{className:"btn-outline",onClick:y,children:e.jsx(I,{size:16})})]}),j&&e.jsx("button",{className:"btn-outline bg-sky-900/30 border-sky-500",onClick:ht,disabled:!i,children:e.jsx(hs,{size:16})})]}),e.jsxs("div",{className:"flex items-center gap-2 bg-slate-900/50 p-2 rounded border border-slate-800 overflow-hidden",children:[e.jsxs("span",{className:"text-slate-500 flex-shrink-0",children:[G("common.path"),":"]}),e.jsxs("div",{className:"flex items-center gap-1 flex-1 min-w-0 overflow-hidden",children:[e.jsx("button",{className:"text-sm font-medium text-sky-400 hover:text-sky-300 hover:underline flex-shrink-0",onClick:()=>{u(o),y()},title:"Go to home folder",children:"Home"}),i&&i.split("\\").filter(Boolean).map((t,s,n)=>{const l=n.slice(0,s+1).join("\\")+"\\",L=s===n.length-1;return e.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0 min-w-0",children:[e.jsx("span",{className:"text-slate-500 flex-shrink-0",children:"/"}),e.jsx("button",{className:`text-sm font-medium truncate max-w-[150px] ${L?"text-white":"text-sky-400 hover:text-sky-300 hover:underline"}`,onClick:()=>{L||(u(l),y())},disabled:L,title:l,children:t})]},s)})]}),r.size>0&&e.jsxs("span",{className:"text-xs text-sky-400 flex-shrink-0 bg-sky-900/20 px-2 py-1 rounded",children:[r.size," ",G("files.selected")]})]}),e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:w,onChange:t=>Be(t.target.value),placeholder:G("common.search"),className:"px-3 py-2 bg-slate-800 border border-slate-700 rounded text-sm w-64 focus:outline-none focus:border-sky-500 pl-9"}),e.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",children:e.jsx(ms,{size:14})}),w&&e.jsx("button",{className:"absolute right-2 top-1/2 -translate-y-1/2 text-slate-400 hover:text-white",onClick:()=>Be(""),title:"Clear search",children:e.jsx(I,{size:16})})]})}),e.jsxs("div",{className:"flex gap-2 flex-wrap justify-end",children:[e.jsx("div",{className:"relative",children:e.jsx("button",{className:`btn-outline ${ce?"bg-amber-900/30 border-amber-500":""}`,onClick:()=>{ce?xt(i):_t()},disabled:!i,title:ce?"Remove bookmark":"Add bookmark",children:ce?e.jsx(Ft,{size:16,className:"fill-amber-400 text-amber-400"}):e.jsx(xs,{size:16})})}),k.length>0&&e.jsxs("div",{className:"relative",children:[e.jsx("button",{className:"btn-outline",onClick:()=>pe(!Z),title:"Show bookmarks",children:e.jsx(Ft,{size:16})}),Z&&e.jsxs("div",{className:"absolute top-full right-0 mt-2 w-80 bg-slate-800 border border-slate-700 rounded shadow-lg z-50 max-h-96 overflow-y-auto",children:[e.jsx("div",{className:"p-3 border-b border-slate-700",children:e.jsx("h4",{className:"font-semibold text-sm",children:"Bookmarked Folders"})}),e.jsx("div",{className:"divide-y divide-slate-700",children:Array.isArray(k)&&k.map(t=>e.jsxs("div",{className:"flex items-center gap-2 p-3 hover:bg-slate-700/50",children:[e.jsxs("button",{className:"flex-1 text-left text-sm hover:text-sky-400 break-all",onClick:()=>Kt(t),children:[e.jsx(de,{size:14,className:"inline mr-2 text-amber-300"}),t||"Root"]}),e.jsx("button",{className:"icon-btn text-red-400 hover:text-red-300",onClick:()=>xt(t),title:"Remove bookmark",children:e.jsx(I,{size:14})})]},t))})]})]})]})]})]}),Ke&&e.jsxs("p",{className:"text-red-400 text-sm",children:["Failed to load items: ",String(Ke)]}),e.jsxs("div",{ref:Fe,className:"flex flex-row gap-2",style:{height:"calc(100vh - 140px)",minHeight:"600px"},children:[e.jsxs("div",{className:"panel flex flex-col overflow-hidden",style:{width:`${be}%`,minWidth:"250px"},children:[e.jsxs("div",{className:"flex items-center justify-between mb-2 flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"panel-title mb-0",children:"Folders"}),e.jsx("button",{className:"icon-btn",onClick:()=>F(!0),title:"New Folder",children:e.jsx(wt,{size:16})}),e.jsx("button",{className:"icon-btn",onClick:h,title:"Refresh",children:e.jsx(vt,{size:16})})]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-slate-400",children:[e.jsxs("button",{className:"hover:text-white flex items-center gap-1",onClick:()=>W("name"),children:["Name ",f.key==="name"&&(f.direction==="asc"?e.jsx(V,{size:12}):e.jsx(q,{size:12}))]}),e.jsxs("button",{className:"hover:text-white flex items-center gap-1",onClick:()=>W("date"),children:["Date ",f.key==="date"&&(f.direction==="asc"?e.jsx(V,{size:12}):e.jsx(q,{size:12}))]})]})]}),e.jsxs("div",{className:"divide-y divide-slate-800 overflow-y-auto flex-1 pr-2",children:[te&&e.jsx("p",{className:"py-4 text-sm text-slate-400",children:"Loading…"}),!te&&U.length===0&&e.jsx("p",{className:"py-4 text-sm text-slate-400",children:"No folders"}),Array.isArray(U)&&U.map(t=>e.jsxs("div",{className:`item-row hover:bg-slate-800/50 cursor-pointer ${r.has(t.fullPath)?"bg-slate-800/70":""}`,onClick:s=>{s.target.closest('input[type="checkbox"]')||s.target.closest("button")||Ge(t)},onContextMenu:s=>gt(s,t),children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[e.jsx("input",{type:"checkbox",checked:r.has(t.fullPath),onChange:s=>{s.stopPropagation(),ot(t)},className:"checkbox flex-shrink-0",onClick:s=>s.stopPropagation()}),e.jsx(de,{size:18,className:"text-amber-300 flex-shrink-0"}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"font-medium truncate",children:t.name}),e.jsx("p",{className:"text-xs text-slate-400",children:bt(t.modifiedAt)})]})]}),e.jsxs("div",{className:"flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{className:"icon-btn",onClick:s=>{s.stopPropagation(),Se(t)},title:"Rename",children:e.jsx(Ie,{size:14})}),e.jsx("button",{className:"icon-btn text-red-400 hover:text-red-300",onClick:s=>{s.stopPropagation(),Ne(t)},title:"Delete",children:e.jsx(ue,{size:14})})]})]},t.fullPath))]}),e.jsx(jt,{currentPage:je,totalItems:le.length,pageSize:R,onPageChange:Ve,onPageSizeChange:Rt})]}),e.jsx("div",{className:"w-2 cursor-col-resize bg-slate-900 hover:bg-sky-500/50 transition-colors flex items-center justify-center z-10 flex-shrink-0 rounded",onMouseDown:ss,children:e.jsx("div",{className:"h-8 w-1 bg-slate-600 rounded-full"})}),e.jsxs("div",{className:"panel flex-1 flex flex-col overflow-hidden",style:{minWidth:"400px"},children:[e.jsxs("div",{className:"flex items-center justify-between mb-2 flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"panel-title mb-0",children:G("files.files")}),e.jsx("button",{className:"icon-btn",onClick:()=>D(!0),title:"New File",children:e.jsx(wt,{size:16})}),e.jsx("button",{className:"icon-btn",onClick:()=>document.getElementById("file-upload-input")?.click(),title:"Upload",children:e.jsx(kt,{size:16})}),e.jsx("button",{className:"icon-btn",onClick:h,title:"Refresh",children:e.jsx(vt,{size:16})})]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-slate-400",children:[e.jsxs("button",{className:"hover:text-white flex items-center gap-1",onClick:()=>W("name"),children:["Name ",f.key==="name"&&(f.direction==="asc"?e.jsx(V,{size:12}):e.jsx(q,{size:12}))]}),e.jsxs("button",{className:"hover:text-white flex items-center gap-1",onClick:()=>W("size"),children:["Size ",f.key==="size"&&(f.direction==="asc"?e.jsx(V,{size:12}):e.jsx(q,{size:12}))]}),e.jsxs("button",{className:"hover:text-white flex items-center gap-1",onClick:()=>W("date"),children:["Date ",f.key==="date"&&(f.direction==="asc"?e.jsx(V,{size:12}):e.jsx(q,{size:12}))]})]})]}),e.jsxs("div",{className:"divide-y divide-slate-800 overflow-y-auto flex-1 pr-2",children:[te&&e.jsx("p",{className:"py-4 text-sm text-slate-400",children:"Loading…"}),!te&&B.length===0&&e.jsx("p",{className:"py-4 text-sm text-slate-400",children:"No files"}),Array.isArray(B)&&B.map(t=>{const s=t.name.toLowerCase().endsWith(".zip"),n=Dt(t.fullPath);return e.jsxs("div",{className:`item-row hover:bg-slate-800/50 cursor-default group ${r.has(t.fullPath)?"bg-slate-800/70":""}`,onContextMenu:l=>gt(l,t),children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[e.jsx("input",{type:"checkbox",checked:r.has(t.fullPath),onChange:()=>ot(t),className:"checkbox flex-shrink-0",onClick:l=>l.stopPropagation()}),s?e.jsx(Le,{size:18,className:"text-purple-300 flex-shrink-0"}):n?e.jsx(us,{size:18,className:"text-green-300 flex-shrink-0"}):e.jsx(is,{size:18,className:"text-sky-300 flex-shrink-0"}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"font-medium truncate",children:t.name}),e.jsxs("p",{className:"text-xs text-slate-400",children:[os(t.sizeBytes)," – ",bt(t.modifiedAt)]})]})]}),e.jsxs("div",{className:"flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{className:"icon-btn",onClick:l=>{l.stopPropagation(),_(t.fullPath)},title:"Download",children:e.jsx(me,{size:14})}),s&&e.jsx("button",{className:"icon-btn",onClick:l=>{l.stopPropagation(),ft(t.fullPath)},title:"Unzip",children:e.jsx(Le,{size:14})}),!s&&!n&&e.jsx("button",{className:"icon-btn",onClick:l=>{l.stopPropagation(),Ye(t)},title:"Edit",children:e.jsx(zt,{size:14})}),!s&&e.jsx("button",{className:"icon-btn",onClick:l=>{l.stopPropagation(),pt(t.fullPath)},title:n?"View":"Tail",children:e.jsx(Ct,{size:14})}),e.jsx("button",{className:"icon-btn",onClick:l=>{l.stopPropagation(),Se(t)},title:"Rename",children:e.jsx(Ie,{size:14})}),e.jsx("button",{className:"icon-btn text-red-400 hover:text-red-300",onClick:l=>{l.stopPropagation(),Ne(t)},title:"Delete",children:e.jsx(ue,{size:14})})]})]},t.fullPath)})]}),e.jsx(jt,{currentPage:ke,totalItems:ie.length,pageSize:M,onPageChange:qe,onPageSizeChange:Mt})]})]}),d&&e.jsx("div",{className:"modal-backdrop",children:e.jsxs("div",{className:"modal",children:[e.jsxs("div",{className:"modal-header",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-400 uppercase tracking-[0.2em]",children:"Editing"}),e.jsx("p",{className:"font-semibold text-white break-all",children:d})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"btn-outline",onClick:ze,children:"Close"}),e.jsx("button",{className:"btn-primary",onClick:Jt,disabled:Te||Me&&!$e,children:Te?"Saving…":"Save"})]})]}),e.jsx("div",{className:"modal-body",children:Me&&!$e?e.jsx("p",{className:"text-sm text-slate-400",children:"Loading content…"}):e.jsx(a.Suspense,{fallback:e.jsx("div",{className:"flex items-center justify-center h-[400px] bg-slate-900 rounded border border-slate-800",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-8 h-8 border-2 border-sky-500 border-t-transparent rounded-full animate-spin mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-slate-400",children:"Loading editor..."})]})}),children:e.jsx(ps,{height:"400px",theme:"vs-dark",language:bs(d),value:g,onChange:t=>b(t??""),options:{minimap:{enabled:!1},fontSize:14,scrollBeyondLastLine:!1}})})})]})}),T&&e.jsx("div",{className:"modal-backdrop",children:e.jsxs("div",{className:"modal",children:[e.jsxs("div",{className:"modal-header",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-xs text-slate-400 uppercase tracking-[0.2em]",children:["Monitoring File ",z&&e.jsx("span",{className:"text-green-400 ml-2",children:"● Live"})]}),e.jsx("p",{className:"font-semibold text-white break-all",children:T})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:`btn-outline ${z?"bg-amber-900/30 border-amber-500":"bg-green-900/30 border-green-500"}`,onClick:()=>ge(!z),children:z?"Pause":"Resume"}),e.jsx("button",{className:"btn-outline",onClick:ts,children:"Close"})]})]}),e.jsxs("div",{className:"modal-body",children:[e.jsx("pre",{className:"text-sm font-mono whitespace-pre-wrap break-all bg-slate-900 p-4 rounded max-h-96 overflow-y-auto",children:Lt||"Loading..."}),e.jsx("p",{className:"text-xs text-slate-400 mt-2",children:"Auto-refreshing every 2 seconds"})]})]})}),P&&e.jsx("div",{className:"modal-backdrop",onClick:()=>ye(null),children:e.jsxs("div",{className:"modal max-w-4xl",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-400 uppercase tracking-[0.2em]",children:"Image Viewer"}),e.jsx("p",{className:"font-semibold text-white break-all",children:P.split("\\").pop()})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{className:"btn-outline",onClick:()=>_(P),children:[e.jsx(me,{size:16,className:"mr-1"}),"Download"]}),e.jsx("button",{className:"btn-outline",onClick:()=>ye(null),children:"Close"})]})]}),e.jsxs("div",{className:"modal-body",children:[e.jsx("div",{className:"flex items-center justify-center bg-slate-900 rounded p-4",children:e.jsx("img",{src:`/api/fs/download?path=${encodeURIComponent(P)}`,alt:P.split("\\").pop(),className:"max-w-full max-h-[70vh] object-contain"})}),e.jsx("p",{className:"text-xs text-slate-400 mt-2 break-all",children:P})]})]})}),m&&e.jsx(fs,{x:m.x,y:m.y,onClose:()=>Y(null),items:[...m.item.isDirectory?[{label:"Open",icon:e.jsx(de,{size:14}),onClick:()=>Ge(m.item)}]:[],{label:"Download",icon:e.jsx(me,{size:14}),onClick:()=>rt(m.item)},{label:"Zip",icon:e.jsx(Nt,{size:14}),onClick:()=>Zt(m.item)},...!m.item.isDirectory&&!m.item.name.endsWith(".zip")?[{label:"Edit",icon:e.jsx(zt,{size:14}),onClick:()=>Ye(m.item)},{label:"Tail",icon:e.jsx(Ct,{size:14}),onClick:()=>pt(m.item.fullPath)}]:[],{label:"Copy",icon:e.jsx(St,{size:14}),onClick:()=>{A({items:[m.item.fullPath],operation:"copy"}),Y(null)}},{label:"Cut",icon:e.jsx(Pt,{size:14}),onClick:()=>{A({items:[m.item.fullPath],operation:"cut"}),Y(null)}},...m.item.name.endsWith(".zip")?[{label:"Unzip",icon:e.jsx(Le,{size:14}),onClick:()=>ft(m.item.fullPath)}]:[],{label:"Rename",icon:e.jsx(Ie,{size:14}),onClick:()=>Se(m.item)},{label:"Delete",icon:e.jsx(ue,{size:14}),onClick:()=>Ne(m.item),danger:!0}]}),e.jsx(rs,{isOpen:v.isOpen,title:v.title,message:v.message,onConfirm:v.onConfirm,onCancel:()=>$({...v,isOpen:!1}),variant:v.variant}),Ut&&e.jsx("div",{className:"modal-backdrop",onClick:()=>F(!1),children:e.jsxs("div",{className:"modal",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Create Folder"}),e.jsx("button",{className:"icon-btn",onClick:()=>F(!1),children:e.jsx(I,{size:16})})]}),e.jsx("div",{className:"modal-body",children:e.jsx("input",{className:"input-text w-full",placeholder:"Folder name",value:oe,onChange:t=>et(t.target.value),onKeyDown:t=>{t.key==="Enter"?tt():t.key==="Escape"&&F(!1)},autoFocus:!0})}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx("button",{className:"btn-outline",onClick:()=>F(!1),children:"Cancel"}),e.jsx("button",{className:"btn-primary",onClick:tt,disabled:!oe.trim(),children:"Create"})]})]})}),Bt&&e.jsx("div",{className:"modal-backdrop",onClick:()=>D(!1),children:e.jsxs("div",{className:"modal",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Create File"}),e.jsx("button",{className:"icon-btn",onClick:()=>D(!1),children:e.jsx(I,{size:16})})]}),e.jsx("div",{className:"modal-body",children:e.jsx("input",{className:"input-text w-full",placeholder:"File name (e.g. notes.txt)",value:re,onChange:t=>st(t.target.value),onKeyDown:t=>{t.key==="Enter"?at():t.key==="Escape"&&D(!1)},autoFocus:!0})}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx("button",{className:"btn-outline",onClick:()=>D(!1),children:"Cancel"}),e.jsx("button",{className:"btn-primary",onClick:at,disabled:!re.trim(),children:"Create"})]})]})}),Wt&&J&&e.jsx("div",{className:"modal-backdrop",onClick:()=>S(!1),children:e.jsxs("div",{className:"modal",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Rename"}),e.jsx("button",{className:"icon-btn",onClick:()=>S(!1),children:e.jsx(I,{size:16})})]}),e.jsx("div",{className:"modal-body",children:e.jsx("input",{className:"input-text w-full",value:E,onChange:t=>Ce(t.target.value),onKeyDown:t=>{t.key==="Enter"?it():t.key==="Escape"&&S(!1)},autoFocus:!0})}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx("button",{className:"btn-outline",onClick:()=>S(!1),children:"Cancel"}),e.jsx("button",{className:"btn-primary",onClick:it,disabled:!E.trim()||E===J.name,children:"Rename"})]})]})})]})}export{Ds as default};
