import{c as ts,j as s,u as X,b as c,s as i,T as re,k as P,P as Ce,X as ce,C as ns,l as ls}from"./index-CFy-3w2c.js";import{r as l}from"./vendor-utils-CpUfumj7.js";import{T as Pe,L as is}from"./LogPanel-BApmYpq7.js";import{R as rs,U as cs,P as os}from"./upload-DD99DkRl.js";import{S as oe,A as ds}from"./search-CXHZ8IYf.js";import{C as us}from"./check-BKh3xXWJ.js";import{D as ms}from"./download-DHqHKtrx.js";import"./vendor-terminal-CTS2sXWF.js";/**
 * @license lucide-react v0.439.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xs=ts("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);function hs({items:f,activeId:B,onSelect:y,className:G=""}){return s.jsx("div",{className:`submenu-container ${G}`,children:f.map(m=>s.jsxs("button",{className:`submenu-tab ${B===m.id?"active":""}`,onClick:()=>y(m.id),children:[m.icon,m.label]},m.id))})}const ps=f=>c(f),gs=()=>c("/api/packages/bundles");function Cs(){const[f,B]=l.useState("installed"),[y,G]=l.useState(""),[m,Be]=l.useState(""),[Y,de]=l.useState(!1),[x,Z]=l.useState([]),[$e,fs]=l.useState(""),[$,L]=l.useState(!1),[U,S]=l.useState(null),[h,A]=l.useState(null),[_,ue]=l.useState(""),[me,xe]=l.useState(""),[Ie,he]=l.useState(!1),[ee,pe]=l.useState(!1),[d,b]=l.useState(new Set),[N,v]=l.useState({isOpen:!1,title:"",message:"",onConfirm:()=>{},variant:"info"}),[ze,D]=l.useState(!1),[R,J]=l.useState(""),[M,ge]=l.useState(!1),[fe,q]=l.useState([]),[Oe,Q]=l.useState(null),[se,I]=l.useState(""),[ae,be]=l.useState(1),[te,je]=l.useState(1),[z,Te]=l.useState(()=>{const e=localStorage.getItem("weasel.packages.installed.pageSize");return e?parseInt(e):50}),[O,Ee]=l.useState(()=>{const e=localStorage.getItem("weasel.packages.search.pageSize");return e?parseInt(e):50}),{data:p,mutate:H,isLoading:Fe,error:ye}=X("/api/packages",ps,{revalidateOnFocus:!1}),ne=l.useCallback(e=>{if(!(!p||!Array.isArray(p)))return p.find(a=>a.identifier.toLowerCase()===e.toLowerCase())},[p]),Le=l.useCallback(e=>{const a=ne(e.id);return!a||!e.version?!1:e.version!==a.version},[ne]),{data:u,mutate:g}=X("bundles",gs,{revalidateOnFocus:!1}),Ue=()=>{const e=new URL("/api/logs",window.location.origin);return c(e.toString())},{data:Ae}=X(U?["logs-general",U]:null,Ue,{refreshInterval:1e3}),Ne=Ae?.files??[],ve=Ne.length>0?[...Ne].sort((e,a)=>a.name.localeCompare(e.name))[0]:null,{data:le,isLoading:K}=X(U&&ve?["log-content",ve.name]:null,([,e])=>{const a=new URL(`/api/logs/${encodeURIComponent(e)}`,window.location.origin);return c(a.toString())},{revalidateOnFocus:!0,refreshInterval:1e3}),V=l.useMemo(()=>{if(!p||!Array.isArray(p))return[];if(!y)return p;const e=y.toLowerCase();return p.filter(a=>a.displayName.toLowerCase().includes(e)||a.identifier.toLowerCase().includes(e)||a.publisher.toLowerCase().includes(e)||a.version.toLowerCase().includes(e))},[p,y]),_e=l.useMemo(()=>{if(z===0)return V;const e=(ae-1)*z,a=e+z;return V.slice(e,a)},[V,ae,z]),De=l.useMemo(()=>{if(O===0)return x;const e=(te-1)*O,a=e+O;return x.slice(e,a)},[x,te,O]);l.useEffect(()=>{je(1)},[x]),l.useEffect(()=>{be(1)},[y]);const k=l.useMemo(()=>!h||!u?null:u.find(e=>e.id===h),[h,u]),ke=l.useCallback(async()=>{if(!m.trim()){Z([]),b(new Set);return}de(!0);try{const e=await c(`/api/packages/search?query=${encodeURIComponent(m)}`);Z(e||[]),b(new Set)}catch(e){console.error("Search failed:",e),i(`Search failed: ${e instanceof Error?e.message:String(e)}`,"error"),Z([]),b(new Set)}finally{de(!1)}},[m]),Re=e=>{b(a=>{const t=new Set(a);return t.has(e)?t.delete(e):t.add(e),t})},Je=()=>{b(new Set(x.map(e=>e.id)))},Me=()=>{b(new Set)},qe=async()=>{d.size!==0&&v({isOpen:!0,title:"Install Packages",message:`Install ${d.size} package(s)? This may take a while.`,onConfirm:async()=>{L(!0),S("batch-install");try{const e=[];for(const n of d)try{const r=await c("/api/packages/install",{method:"POST",body:JSON.stringify({identifier:n})});e.push(r)}catch(r){e.push({succeeded:!1,exitCode:-1,message:r instanceof Error?r.message:String(r)})}const a=e.filter(n=>n.succeeded).length,t=e.filter(n=>!n.succeeded).length;t===0?i(`Installation complete: ${a} package(s) installed successfully`,"success"):i(`Installation complete: ${a} succeeded, ${t} failed`,"warning"),b(new Set),await H(),S(null),v(n=>({...n,isOpen:!1}))}catch(e){i(`Failed to install packages: ${e instanceof Error?e.message:String(e)}`,"error"),S(null)}finally{L(!1)}},variant:"info"})},Qe=async e=>{if(d.size!==0)try{const a=await c(`/api/packages/bundles/${e}`),t=x.filter(n=>d.has(n.id)).map(n=>({id:n.id,name:n.name,version:n.version??null,publisher:n.publisher??null}));await c(`/api/packages/bundles/${e}`,{method:"PUT",body:JSON.stringify({packages:[...a.packages,...t]})}),await g(),b(new Set),i(`Added ${t.length} package(s) to bundle "${a.name}"`,"success")}catch(a){i(`Failed to add packages to bundle: ${a instanceof Error?a.message:String(a)}`,"error")}},W=async(e,a,t)=>{const n=a??$e;if(!n)return;const r=t||n;L(!0),e==="/install"&&S(n);try{const o=await c(`/api/packages${e}`,{method:"POST",body:JSON.stringify({identifier:n})});o.succeeded?i(`${r} ${e==="/install"?"installed":"uninstalled"} successfully.`,"success"):i(`Failed to ${e==="/install"?"install":"uninstall"} ${r}. Error: ${o.message.split(`
`)[0]}`,"error"),await H(),e==="/install"&&S(null)}catch(o){i(`Failed to ${e==="/install"?"install":"uninstall"} ${r}: ${o instanceof Error?o.message:String(o)}`,"error"),e==="/install"&&S(null)}finally{L(!1)}},He=async()=>{if(!_.trim()){i("Please enter a bundle name","warning");return}he(!0);try{const e=await c("/api/packages/bundles",{method:"POST",body:JSON.stringify({name:_,description:me})});A(e.id),ue(""),xe(""),await g(),B("bundles"),i("Bundle created successfully","success")}catch(e){i(`Failed to create bundle: ${e instanceof Error?e.message:String(e)}`,"error")}finally{he(!1)}},Se=async()=>{if(!R.trim()){i("Please enter a bundle name","warning");return}ge(!0);try{const e=await c("/api/packages/bundles",{method:"POST",body:JSON.stringify({name:R,description:""})});if(fe.length>0){const a=fe.map(t=>({id:t.id,name:t.name,version:t.version??null,publisher:t.publisher??null}));await c(`/api/packages/bundles/${e.id}`,{method:"PUT",body:JSON.stringify({packages:a})}),i(`Bundle "${e.name}" created with ${a.length} package(s)`,"success")}else i(`Bundle "${e.name}" created successfully`,"success");await g(),J(""),D(!1),q([])}catch(e){i(`Failed to create bundle: ${e instanceof Error?e.message:String(e)}`,"error")}finally{ge(!1)}},Ke=async e=>{if(!h||!e)return;const a={id:e.id,name:e.name,version:e.version??null,publisher:e.publisher??null};try{const t=await c(`/api/packages/bundles/${h}`,{method:"PUT",body:JSON.stringify({packages:[...k?.packages||[],a]})});await g(),i(`Added ${e.name} to bundle`,"success")}catch(t){i(`Failed to add package to bundle: ${t instanceof Error?t.message:String(t)}`,"error")}},Ve=async e=>{if(!(!h||!k))try{await c(`/api/packages/bundles/${h}`,{method:"PUT",body:JSON.stringify({packages:k.packages.filter(a=>a.id!==e)})}),await g(),i("Package removed from bundle","success")}catch(a){i(`Failed to remove package from bundle: ${a instanceof Error?a.message:String(a)}`,"error")}},[w,T]=l.useState(null),[E,ie]=l.useState(new Set),We=async e=>{const a=u?.find(t=>t.id===e);a&&(T(a),ie(new Set(a.packages.map(t=>t.id))))},Xe=async()=>{if(w){pe(!0);try{const e=w.packages.filter(r=>E.has(r.id)).map(r=>r.id),a=[];for(const r of e)try{const o=await c("/api/packages/install",{method:"POST",body:JSON.stringify({identifier:r})});a.push(o)}catch(o){a.push({succeeded:!1,exitCode:-1,message:o instanceof Error?o.message:String(o)})}const t=a.filter(r=>r.succeeded).length,n=a.filter(r=>!r.succeeded).length;n===0?i(`Bundle installation complete: ${t} package(s) installed successfully`,"success"):i(`Bundle installation complete: ${t} succeeded, ${n} failed`,"warning"),await H(),T(null),ie(new Set)}catch(e){i(`Failed to install bundle: ${e instanceof Error?e.message:String(e)}`,"error")}finally{pe(!1)}}},we=async(e,a)=>{if(!a.trim()){i("Please enter a bundle name","warning");return}try{await c(`/api/packages/bundles/${e}`,{method:"PUT",body:JSON.stringify({name:a.trim()})}),await g(),i("Bundle renamed successfully","success"),Q(null),I("")}catch(t){i(`Failed to rename bundle: ${t instanceof Error?t.message:String(t)}`,"error")}},[j,F]=l.useState(null),Ge=async e=>{const a=u?.find(t=>t.id===e);a&&F(a)},Ye=async()=>{if(j)try{await c(`/api/packages/bundles/${j.id}`,{method:"DELETE"}),await g(),h===j.id&&A(null),i("Bundle deleted successfully","success"),F(null)}catch(e){i(`Failed to delete bundle: ${e instanceof Error?e.message:String(e)}`,"error")}},Ze=e=>{const a=JSON.stringify(e,null,2),t=new Blob([a],{type:"application/json"}),n=URL.createObjectURL(t),r=document.createElement("a");r.href=n,r.download=`${e.name.replace(/[^a-z0-9]/gi,"_")}.json`,r.click(),URL.revokeObjectURL(n)},es=async()=>{const e=document.createElement("input");e.type="file",e.accept="application/json",e.onchange=async a=>{const t=a.target.files?.[0];if(t)try{const n=await t.text(),r=JSON.parse(n),o=await c("/api/packages/bundles",{method:"POST",body:JSON.stringify({name:r.name,description:r.description})});r.packages.length>0&&await c(`/api/packages/bundles/${o.id}`,{method:"PUT",body:JSON.stringify({packages:r.packages})}),await g(),A(o.id),B("bundles"),i("Bundle imported successfully","success")}catch(n){i(`Failed to import bundle: ${n instanceof Error?n.message:String(n)}`,"error")}},e.click()},ss=[{id:"installed",label:"Installed Packages",icon:s.jsx(P,{size:16})},{id:"install",label:"Search Packages",icon:s.jsx(oe,{size:16})},{id:"bundles",label:"Bundles",icon:s.jsx(ds,{size:16})}];return s.jsxs("section",{className:"space-y-4",children:[s.jsx(hs,{items:ss,activeId:f,onSelect:e=>B(e)}),ye&&s.jsxs("p",{className:"text-sm text-red-400",children:["Failed to load packages: ",String(ye)]}),f==="installed"&&s.jsxs("div",{className:"panel",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("h3",{className:"panel-title mb-0",children:"Installed Packages"}),s.jsx("button",{className:"icon-btn",onClick:()=>H(),title:"Refresh",children:s.jsx(rs,{size:16})})]}),s.jsx("div",{className:"mb-3",children:s.jsx("input",{className:"w-full input-text",placeholder:"Search installed packages by name, ID, publisher, or version...",value:y,onChange:e=>G(e.target.value)})}),s.jsxs("div",{className:"border border-slate-800 rounded",children:[s.jsx(re,{data:_e,columns:[{key:"displayName",label:"Application",sortable:!0,sortFn:(e,a)=>e.displayName.localeCompare(a.displayName),render:e=>s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(P,{size:16,className:"text-sky-300 flex-shrink-0"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-white",children:e.displayName}),s.jsxs("p",{className:"text-xs text-slate-400",children:[e.version," · ",e.publisher]})]})]})},{key:"version",label:"Version",sortable:!0,sortFn:(e,a)=>e.version.localeCompare(a.version),render:e=>s.jsx("span",{children:e.version})},{key:"actions",label:"Actions",sortable:!1,render:e=>s.jsx("button",{className:"btn-outline",onClick:()=>{v({isOpen:!0,title:"Uninstall Package",message:`Uninstall ${e.displayName}?`,onConfirm:async()=>{await W("/uninstall",e.identifier,e.displayName),v(a=>({...a,isOpen:!1}))},variant:"danger"})},disabled:$,children:"Remove"})}],keyExtractor:e=>e.identifier,isLoading:Fe,emptyMessage:"No packages found",maxHeight:"max-h-96"}),s.jsx(Ce,{currentPage:ae,totalItems:V.length,pageSize:z,onPageChange:be,onPageSizeChange:e=>{Te(e),localStorage.setItem("weasel.packages.installed.pageSize",e.toString())}})]})]}),f==="install"&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"panel space-y-4",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("h3",{className:"panel-title mb-0 flex items-center gap-2",children:[s.jsx(oe,{size:18})," Search Packages"]})}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{className:"flex-1 input-text",placeholder:"Search for packages (e.g. chrome, firefox, vscode)...",value:m,onChange:e=>Be(e.target.value),onKeyDown:e=>{e.key==="Enter"&&ke()}}),s.jsxs("button",{className:"btn-primary",onClick:ke,disabled:Y||!m.trim(),children:[s.jsx(oe,{size:16})," ",Y?"Searching…":"Search"]})]})]}),x.length>0&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"panel",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("span",{className:"text-sm text-slate-400",children:[d.size," of ",x.length," selected"]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{className:"btn-outline text-xs",onClick:Je,disabled:d.size===x.length,children:"Select All"}),s.jsx("button",{className:"btn-outline text-xs",onClick:Me,disabled:d.size===0,children:"Clear"})]})]}),s.jsx("div",{className:"flex gap-2",children:d.size>0&&s.jsxs(s.Fragment,{children:[ze?s.jsxs("div",{className:"flex gap-2 items-center",children:[s.jsx("input",{type:"text",className:"input-text text-xs px-2 py-1",placeholder:"Bundle name...",value:R,onChange:e=>J(e.target.value),onKeyDown:e=>{e.key==="Enter"?Se():e.key==="Escape"&&(D(!1),J(""),q([]))},autoFocus:!0,disabled:M}),s.jsx("button",{className:"btn-primary text-xs",onClick:Se,disabled:M||!R.trim(),children:M?"Creating...":"Create"}),s.jsx("button",{className:"btn-outline text-xs",onClick:()=>{D(!1),J(""),q([])},disabled:M,children:"Cancel"})]}):s.jsxs("select",{className:"btn-outline text-xs",value:"",onChange:e=>{const a=e.target.value;a==="__create_new__"?(q(x.filter(t=>d.has(t.id))),D(!0)):a&&Qe(a),e.target.value=""},children:[s.jsx("option",{value:"",children:"Add selected to bundle..."}),s.jsx("option",{value:"__create_new__",children:"+ Create New Bundle"}),u&&u.map(e=>s.jsx("option",{value:e.id,children:e.name},e.id))]}),s.jsxs("button",{className:"btn-primary text-xs",onClick:qe,disabled:$,children:["Install Selected (",d.size,")"]})]})})]}),s.jsxs("div",{className:"border border-slate-800 rounded",children:[s.jsx(re,{data:De,columns:[{key:"select",label:"",sortable:!1,render:e=>s.jsx("input",{type:"checkbox",checked:d.has(e.id),onChange:()=>Re(e.id),className:"checkbox"})},{key:"name",label:"Package",sortable:!0,sortFn:(e,a)=>e.name.localeCompare(a.name),render:e=>s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(P,{size:16,className:"text-green-400 flex-shrink-0"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-white",children:e.name}),s.jsxs("p",{className:"text-xs text-slate-400",children:[e.id," ",e.description&&`· ${e.description}`]})]})]})},{key:"version",label:"Version",sortable:!0,sortFn:(e,a)=>e.version.localeCompare(a.version),render:e=>s.jsx("span",{children:e.version})},{key:"publisher",label:"Publisher",sortable:!0,sortFn:(e,a)=>e.publisher.localeCompare(a.publisher),render:e=>s.jsx("span",{children:e.publisher})},{key:"actions",label:"Actions",sortable:!1,render:e=>{const a=ne(e.id),t=Le(e);return s.jsxs("div",{className:"flex gap-2",children:[a?s.jsxs(s.Fragment,{children:[t&&s.jsx("button",{className:"btn-primary text-xs",onClick:()=>W("/install",e.id,e.name),disabled:$,title:`Update from ${a.version} to ${e.version}`,children:"Update"}),s.jsx("button",{className:"btn-outline text-xs text-red-400 hover:text-red-300",onClick:()=>{v({isOpen:!0,title:"Uninstall Package",message:`Uninstall ${e.name}?`,onConfirm:async()=>{await W("/uninstall",e.id,e.name),v({...N,isOpen:!1})},variant:"danger"})},disabled:$,children:"Uninstall"})]}):s.jsx("button",{className:"btn-primary text-xs",onClick:()=>W("/install",e.id,e.name),disabled:$,children:"Install"}),s.jsxs("select",{className:"btn-outline text-xs",value:"",onChange:async n=>{const r=n.target.value;if(r==="__create_new__"){const o=prompt("Enter bundle name:");if(o&&o.trim())try{const C=await c("/api/packages/bundles",{method:"POST",body:JSON.stringify({name:o.trim(),description:""})}),as={id:e.id,name:e.name,version:e.version??null,publisher:e.publisher??null};await c(`/api/packages/bundles/${C.id}`,{method:"PUT",body:JSON.stringify({packages:[as]})}),await g(),i(`Bundle "${C.name}" created and ${e.name} added`,"success")}catch(C){i(`Failed to create bundle: ${C instanceof Error?C.message:String(C)}`,"error")}}else r&&await Ke(e);n.target.value=""},children:[s.jsx("option",{value:"",children:"Add to bundle..."}),s.jsx("option",{value:"__create_new__",children:"+ Create New Bundle"}),u&&u.map(n=>s.jsx("option",{value:n.id,children:n.name},n.id))]})]})}}],keyExtractor:e=>e.id,isLoading:Y,emptyMessage:"No results found. Try a different search query.",maxHeight:"max-h-96"}),s.jsx(Ce,{currentPage:te,totalItems:x.length,pageSize:O,onPageChange:je,onPageSizeChange:e=>{Ee(e),localStorage.setItem("weasel.packages.search.pageSize",e.toString())}})]})]}),U&&s.jsxs("div",{className:"panel space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h3",{className:"panel-title mb-0",children:"Installation Log"}),s.jsx("div",{className:"text-xs text-slate-400",children:K?"Loading...":"Tailing log (auto-refreshing every second)"})]}),s.jsxs("div",{className:"bg-slate-950 rounded border border-slate-800 p-3 max-h-64 overflow-y-auto",children:[K&&s.jsx("p",{className:"text-sm text-slate-400",children:"Loading log..."}),!K&&!le&&s.jsx("p",{className:"text-sm text-slate-400",children:"No log content available"}),!K&&le&&s.jsx("pre",{className:"text-xs text-slate-300 whitespace-pre-wrap font-mono",children:le})]})]})]})]}),f==="bundles"&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"panel space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h3",{className:"panel-title mb-0",children:"Create Bundle"}),s.jsxs("button",{className:"btn-outline",onClick:es,children:[s.jsx(cs,{size:16})," Import Bundle"]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{className:"flex-1 input-text",placeholder:"Bundle name",value:_,onChange:e=>ue(e.target.value)}),s.jsx("input",{className:"flex-1 input-text",placeholder:"Description (optional)",value:me,onChange:e=>xe(e.target.value)}),s.jsxs("button",{className:"btn-primary",onClick:He,disabled:Ie||!_.trim(),children:[s.jsx(os,{size:16})," Create"]})]})]}),u&&u.length>0&&s.jsxs("div",{className:"panel space-y-4",children:[s.jsx("h3",{className:"panel-title mb-0",children:"Bundles"}),s.jsx("div",{className:"space-y-3",children:u.map(e=>s.jsx("div",{className:`border rounded-lg p-4 cursor-pointer transition-colors ${h===e.id?"border-sky-500 bg-sky-900/20":"border-slate-800 hover:border-slate-700"}`,onClick:()=>A(e.id),children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[Oe===e.id?s.jsxs("div",{className:"flex gap-2 items-center",onClick:a=>a.stopPropagation(),children:[s.jsx("input",{type:"text",className:"input-text text-sm px-2 py-1",value:se,onChange:a=>I(a.target.value),onKeyDown:a=>{a.key==="Enter"?we(e.id,se):a.key==="Escape"&&(Q(null),I(""))},autoFocus:!0}),s.jsx("button",{className:"btn-outline text-xs",onClick:()=>we(e.id,se),children:s.jsx(us,{size:14})}),s.jsx("button",{className:"btn-outline text-xs",onClick:()=>{Q(null),I("")},children:s.jsx(ce,{size:14})})]}):s.jsx("h4",{className:"font-semibold text-white",children:e.name}),e.description&&s.jsx("p",{className:"text-sm text-slate-400 mt-1",children:e.description}),s.jsxs("p",{className:"text-xs text-slate-500 mt-2",children:[e.packages.length," package",e.packages.length!==1?"s":""]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{className:"btn-outline text-xs",onClick:a=>{a.stopPropagation(),Q(e.id),I(e.name)},title:"Rename",children:s.jsx(xs,{size:14})}),s.jsx("button",{className:"btn-outline text-xs",onClick:a=>{a.stopPropagation(),Ze(e)},title:"Export",children:s.jsx(ms,{size:14})}),s.jsx("button",{className:"btn-outline text-xs",onClick:a=>{a.stopPropagation(),We(e.id)},disabled:ee,title:"Install All",children:"Install All"}),s.jsx("button",{className:"btn-outline text-xs text-red-400",onClick:a=>{a.stopPropagation(),Ge(e.id)},title:"Delete",children:s.jsx(Pe,{size:14})})]})]})},e.id))})]}),k&&s.jsxs("div",{className:"panel space-y-4",children:[s.jsxs("h3",{className:"panel-title mb-0",children:[k.name," - Packages"]}),k.packages.length===0?s.jsx("p",{className:"text-sm text-slate-400",children:"No packages in this bundle. Search for packages and add them to this bundle."}):s.jsx(re,{data:k.packages,columns:[{key:"name",label:"Package",sortable:!0,sortFn:(e,a)=>e.name.localeCompare(a.name),render:e=>s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(P,{size:16,className:"text-amber-300 flex-shrink-0"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-white",children:e.name}),s.jsx("p",{className:"text-xs text-slate-400",children:e.id})]})]})},{key:"version",label:"Version",sortable:!0,sortFn:(e,a)=>(e.version||"").localeCompare(a.version||""),render:e=>s.jsx("span",{children:e.version||"—"})},{key:"actions",label:"Actions",sortable:!1,render:e=>s.jsx("button",{className:"btn-outline text-xs text-red-400",onClick:()=>Ve(e.id),children:s.jsx(Pe,{size:14})})}],keyExtractor:e=>e.id,isLoading:!1,emptyMessage:"No packages",maxHeight:"max-h-64"})]})]}),s.jsx(is,{name:"Packages",title:"Package Operations Log",subfolder:"Packages"}),s.jsx(ns,{isOpen:N.isOpen,title:N.title,message:N.message,onConfirm:N.onConfirm,onCancel:()=>v({...N,isOpen:!1}),variant:N.variant}),w&&s.jsx("div",{className:"modal-backdrop",onClick:()=>T(null),children:s.jsxs("div",{className:"modal",onClick:e=>e.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsxs("h3",{className:"text-lg font-semibold text-white",children:["Install Bundle: ",w.name]}),s.jsx("button",{className:"icon-btn",onClick:()=>T(null),title:"Close",children:s.jsx(ce,{size:16})})]}),s.jsxs("div",{className:"modal-body space-y-4",children:[s.jsx("p",{className:"text-slate-300",children:"Select packages to install from this bundle. Uncheck any packages you don't want to install."}),s.jsx("div",{className:"space-y-2 max-h-80 overflow-y-auto",children:w.packages.map(e=>s.jsxs("label",{className:"flex items-center gap-3 p-2 hover:bg-slate-800/50 rounded cursor-pointer",children:[s.jsx("input",{type:"checkbox",className:"checkbox",checked:E.has(e.id),onChange:()=>{ie(a=>{const t=new Set(a);return t.has(e.id)?t.delete(e.id):t.add(e.id),t})}}),s.jsx(P,{size:16,className:"text-green-400 flex-shrink-0"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"font-medium text-white",children:e.name}),s.jsxs("p",{className:"text-xs text-slate-400",children:[e.id," ",e.version&&`· v${e.version}`]})]})]},e.id))}),s.jsxs("p",{className:"text-xs text-slate-500",children:[E.size," of ",w.packages.length," packages selected"]})]}),s.jsxs("div",{className:"flex gap-2 justify-end",children:[s.jsx("button",{className:"btn-outline",onClick:()=>T(null),children:"Cancel"}),s.jsx("button",{className:"btn-primary",onClick:Xe,disabled:ee||E.size===0,children:ee?"Installing...":`Install ${E.size} Package(s)`})]})]})}),j&&s.jsx("div",{className:"modal-backdrop",onClick:()=>F(null),children:s.jsxs("div",{className:"modal",onClick:e=>e.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 rounded-lg bg-red-900/20 border-red-500/50 text-red-200",children:s.jsx(ls,{size:20})}),s.jsxs("h3",{className:"text-lg font-semibold text-white",children:["Delete Bundle: ",j.name]})]}),s.jsx("button",{className:"icon-btn",onClick:()=>F(null),title:"Close",children:s.jsx(ce,{size:16})})]}),s.jsxs("div",{className:"modal-body space-y-4",children:[s.jsx("p",{className:"text-slate-300",children:"Are you sure you want to delete this bundle? The bundle will be removed, but the packages themselves will remain installed on your system."}),j.packages.length>0&&s.jsxs(s.Fragment,{children:[s.jsx("p",{className:"text-sm font-medium text-slate-200",children:"This bundle contains:"}),s.jsx("div",{className:"space-y-1 max-h-60 overflow-y-auto",children:j.packages.map(e=>s.jsxs("div",{className:"flex items-center gap-2 p-2 bg-slate-800/30 rounded",children:[s.jsx(P,{size:14,className:"text-amber-300 flex-shrink-0"}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"text-sm text-white truncate",children:e.name}),s.jsx("p",{className:"text-xs text-slate-400 truncate",children:e.id})]})]},e.id))}),s.jsxs("p",{className:"text-xs text-slate-500",children:[j.packages.length," package(s) in this bundle"]})]})]}),s.jsxs("div",{className:"flex gap-2 justify-end",children:[s.jsx("button",{className:"btn-outline",onClick:()=>F(null),children:"Cancel"}),s.jsx("button",{className:"btn-primary bg-red-600 hover:bg-red-700",onClick:Ye,children:"Delete Bundle"})]})]})})]})}export{Cs as default};
