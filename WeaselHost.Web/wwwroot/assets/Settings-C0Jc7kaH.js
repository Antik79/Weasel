import{c as M,s as o,a as k,m as Y,u as N,b as f,n as U,j as e,o as Z,F as W,M as C,p as z,L as q,C as ee,q as T,e as se,g as te,r as B,V}from"./index-CFy-3w2c.js";import{r as h}from"./vendor-utils-CpUfumj7.js";import{S as $,F as w,T as S,a as H,b as R}from"./ToggleBar-C2bORH6u.js";import{E as F}from"./eye-oiPQLzsB.js";import{S as ae}from"./send-CCdk0kJd.js";import"./vendor-terminal-CTS2sXWF.js";import"./folder-BcBcgh9m.js";import"./check-BKh3xXWJ.js";/**
 * @license lucide-react v0.439.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=M("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.439.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=M("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.439.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=M("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);function D(t,g,c=500){const n=h.useRef();return h.useEffect(()=>()=>{n.current&&clearTimeout(n.current)},[]),h.useCallback(async(u,x=!0)=>{n.current&&clearTimeout(n.current),n.current=setTimeout(async()=>{try{await t(u),await g(),x&&o("Settings saved","success")}catch(l){const s=l instanceof Error?l.message:String(l);o(`Failed to save: ${s}`,"error"),console.error("Debounced save failed:",l)}},c)},[t,g,c])}const ie=()=>f("/api/settings/capture"),re=()=>f("/api/settings/security"),le=()=>f("/api/settings/mail"),oe=()=>f("/api/system/startup"),ce=()=>f("/api/system/admin/status");function Pe(){const{t,language:g,setLanguage:c}=k(),{themeName:n,setTheme:d}=Y(),[u,x]=h.useState("general");h.useEffect(()=>{const p=()=>{const b=window.location.hash.slice(1);if(!b)return;const O=b.split("/").filter(Boolean);if(O[0]==="settings"&&O[1]){const J=O[1];["general","security","mail","logging","screenshots","files","vnc"].includes(J)&&x(J)}};return p(),window.addEventListener("hashchange",p),()=>window.removeEventListener("hashchange",p)},[]),h.useEffect(()=>{const b=window.location.hash.slice(1).split("/").filter(Boolean);b[0]==="settings"&&b[1]!==u&&(window.location.hash=`/settings/${u}`)},[u]);const{data:l,mutate:s}=N("startup-status",oe),{data:a,mutate:m}=N("admin-status",ce),{data:i,mutate:r}=N("ui-preferences",U),{data:v,mutate:j}=N("security-settings",re),[y,E]=h.useState({requireAuthentication:!1,password:"",confirmPassword:""}),[A,I]=h.useState(!1),[P,L]=h.useState({isOpen:!1,title:"",message:"",onConfirm:()=>{},variant:"info"});h.useEffect(()=>{v&&E(p=>({...p,requireAuthentication:v.requireAuthentication}))},[v]);const K=async p=>{try{await f("/api/system/startup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({enabled:p})}),await s(),o(t("common.success"),"success")}catch(b){o(`${t("common.error")}: ${b instanceof Error?b.message:String(b)}`,"error")}},Q=async()=>{L({isOpen:!0,title:"Restart as Administrator",message:t("system.restartAdmin")+"?",onConfirm:async()=>{try{await f("/api/system/admin/restart",{method:"POST"}),o("Restarting as administrator...","success")}catch(p){o(`${t("common.error")}: ${p instanceof Error?p.message:String(p)}`,"error")}finally{L({...P,isOpen:!1})}},variant:"warning"})},X=async()=>{if(y.password!==y.confirmPassword){o("Passwords do not match","error");return}I(!0);try{await f("/api/settings/security",{method:"PUT",body:JSON.stringify({requireAuthentication:y.requireAuthentication,password:y.password||null})}),E(p=>({...p,password:"",confirmPassword:""})),await j(),o(t("common.success"),"success")}catch(p){o(`${t("common.error")}: ${p instanceof Error?p.message:String(p)}`,"error")}finally{I(!1)}};return e.jsxs("section",{className:"space-y-4",children:[e.jsxs("div",{className:"submenu-container",children:[e.jsxs("button",{onClick:()=>x("general"),className:`submenu-tab ${u==="general"?"active":""}`,children:[e.jsx(Z,{size:16}),t("settings.general")]}),e.jsxs("button",{onClick:()=>x("security"),className:`submenu-tab ${u==="security"?"active":""}`,children:[e.jsx($,{size:16}),t("settings.security")]}),e.jsxs("button",{onClick:()=>x("mail"),className:`submenu-tab ${u==="mail"?"active":""}`,children:[e.jsx(_,{size:16}),t("settings.mail")]}),e.jsxs("button",{onClick:()=>x("logging"),className:`submenu-tab ${u==="logging"?"active":""}`,children:[e.jsx(W,{size:16}),"Logging"]}),e.jsxs("button",{onClick:()=>x("screenshots"),className:`submenu-tab ${u==="screenshots"?"active":""}`,children:[e.jsx(w,{size:16}),"Screenshots"]}),e.jsxs("button",{onClick:()=>x("files"),className:`submenu-tab ${u==="files"?"active":""}`,children:[e.jsx(w,{size:16}),"Files"]}),e.jsxs("button",{onClick:()=>x("vnc"),className:`submenu-tab ${u==="vnc"?"active":""}`,children:[e.jsx(C,{size:16}),"VNC"]})]}),u==="general"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"panel",children:[e.jsxs("h3",{className:"panel-title flex items-center gap-2",children:[e.jsx(C,{size:18})," Application"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-1",children:t("settings.language")}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(G,{size:16,className:"text-slate-500"}),e.jsxs("select",{className:"input-text",value:g,onChange:p=>c(p.target.value),children:[e.jsx("option",{value:"en",children:"English"}),e.jsx("option",{value:"de",children:"Deutsch"}),e.jsx("option",{value:"fr",children:"FranÃ§ais"}),e.jsx("option",{value:"nl",children:"Nederlands"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-1",children:t("settings.theme")}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ne,{size:16,className:"text-slate-500"}),e.jsxs("select",{className:"input-text",value:n,onChange:p=>d(p.target.value),children:[e.jsx("option",{value:"weasel",children:"Weasel"}),e.jsx("option",{value:"dark",children:"Dark"}),e.jsx("option",{value:"light",children:"Light"})]})]})]})]}),e.jsxs("div",{className:"space-y-3 pt-2",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-900/50 rounded-lg border border-slate-800",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx($,{size:18,className:a?.isAdministrator?"text-green-400":"text-amber-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-white",children:t("settings.runAsAdmin")}),e.jsx("p",{className:"text-xs text-slate-400",children:a?.isAdministrator?t("system.admin"):t("system.standard")})]})]}),!a?.isAdministrator&&e.jsx("button",{className:"btn-outline text-xs",onClick:Q,children:t("system.restartAdmin")})]}),e.jsx(S,{label:t("settings.startWithWindows"),description:"Launch Weasel automatically at Windows startup",enabled:l?.enabled||!1,onChange:K,icon:e.jsx(C,{size:18}),iconColorEnabled:"text-green-400",iconColorDisabled:"text-slate-500"})]})]})]}),e.jsxs("div",{className:"panel",children:[e.jsxs("h3",{className:"panel-title flex items-center gap-2",children:[e.jsx(F,{size:18})," User Interface Preferences"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(S,{label:"Expand log panels by default",description:"New log panels will open expanded",enabled:i?.logPanelExpanded?.default??!1,onChange:async p=>{try{const b={...i,logPanelExpanded:{...i?.logPanelExpanded,default:p}};await z(b),r(),o("Preference saved successfully","success")}catch(b){o(`Failed to save: ${b instanceof Error?b.message:String(b)}`,"error")}},icon:e.jsx(F,{size:18})}),e.jsxs("div",{className:"pt-4 border-t border-slate-800",children:[e.jsx("h4",{className:"text-sm font-semibold text-white mb-3",children:"Pagination Defaults"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-1",children:"Default items per page (text data)"}),e.jsxs("select",{className:"input-text",value:i?.defaultTextPageSize??50,onChange:async p=>{try{const b={...i,defaultTextPageSize:parseInt(p.target.value)};await z(b),r(),o("Preference saved successfully","success")}catch(b){o(`Failed to save: ${b instanceof Error?b.message:String(b)}`,"error")}},children:[e.jsx("option",{value:"25",children:"25"}),e.jsx("option",{value:"50",children:"50"}),e.jsx("option",{value:"100",children:"100"})]}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Default page size for lists, tables, and text-based data"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-1",children:"Default items per page (images)"}),e.jsxs("select",{className:"input-text",value:i?.defaultImagePageSize??25,onChange:async p=>{try{const b={...i,defaultImagePageSize:parseInt(p.target.value)};await z(b),r(),o("Preference saved successfully","success")}catch(b){o(`Failed to save: ${b instanceof Error?b.message:String(b)}`,"error")}},children:[e.jsx("option",{value:"25",children:"25"}),e.jsx("option",{value:"50",children:"50"}),e.jsx("option",{value:"100",children:"100"})]}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Default page size for image grids and thumbnails"})]})]})]})]})]})]}),u==="security"&&e.jsxs("div",{className:"panel",children:[e.jsxs("h3",{className:"panel-title flex items-center gap-2",children:[e.jsx(q,{size:18})," ",t("settings.authentication")]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(S,{label:t("settings.requireAuth"),description:"Protect web console access",enabled:y.requireAuthentication,onChange:async p=>{try{await f("/api/settings/security",{method:"PUT",body:JSON.stringify({requireAuthentication:p,password:null})}),E({...y,requireAuthentication:p}),await j(),o(t("common.success"),"success")}catch(b){o(`${t("common.error")}: ${b instanceof Error?b.message:String(b)}`,"error")}},icon:e.jsx($,{size:18})}),e.jsxs("div",{className:"space-y-3 pt-2 border-t border-slate-800",children:[e.jsx("p",{className:"text-sm font-medium text-slate-300",children:t("settings.changePassword")}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"New Password"}),e.jsx("input",{type:"password",className:"input-text",value:y.password,onChange:p=>E({...y,password:p.target.value}),placeholder:"Leave empty to keep current"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Confirm Password"}),e.jsx("input",{type:"password",className:"input-text",value:y.confirmPassword,onChange:p=>E({...y,confirmPassword:p.target.value}),placeholder:"Confirm new password"})]})]}),e.jsxs("button",{className:"btn-primary",onClick:X,disabled:A||!y.password||y.password!==y.confirmPassword,children:[e.jsx(H,{size:16})," ",t(A?"common.loading":"settings.changePassword")]})]})]})]}),u==="mail"&&e.jsx(de,{}),u==="logging"&&e.jsx(ue,{}),u==="screenshots"&&e.jsx(me,{}),u==="files"&&e.jsx(pe,{}),u==="vnc"&&e.jsx(xe,{}),e.jsx(ee,{isOpen:P.isOpen,title:P.title,message:P.message,onConfirm:P.onConfirm,onCancel:()=>L(p=>({...p,isOpen:!1})),variant:P.variant})]})}function de(){const{t}=k(),{data:g,mutate:c}=N("smtp-settings",le),[n,d]=h.useState({host:"smtp.gmail.com",port:587,enableSsl:!0,username:"",password:"",fromAddress:"",fromName:"Weasel Disk Monitor",testRecipient:""}),[u,x]=h.useState(!1),[l,s]=h.useState("");h.useEffect(()=>{g&&(d(g),g.testRecipient&&s(g.testRecipient))},[g]);const a=D(async i=>{await f("/api/settings/mail",{method:"PUT",body:JSON.stringify({...i,testRecipient:l})})},c,500),m=async()=>{if(!l){o("Please enter a recipient email address","error");return}x(!0);try{await f("/api/settings/mail/test",{method:"POST",body:JSON.stringify({recipient:l})}),o("Test email sent successfully","success")}catch(i){const r=i instanceof Error?i.message:String(i);o(`Failed to send test email: ${r}`,"error")}finally{x(!1)}};return e.jsxs("div",{className:"panel",children:[e.jsxs("h3",{className:"panel-title flex items-center gap-2",children:[e.jsx(_,{size:18})," ",t("settings.smtpSettings")]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm text-slate-300",children:t("settings.host")}),e.jsx("input",{className:"input-text",value:n.host,onChange:i=>{const r={...n,host:i.target.value};d(r),a(r,!1)}})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm text-slate-300",children:t("settings.port")}),e.jsx("input",{type:"number",className:"input-text",value:n.port,onChange:i=>{const r={...n,port:Number(i.target.value)};d(r),a(r,!1)}})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm text-slate-300",children:t("settings.username")}),e.jsx("input",{className:"input-text",value:n.username||"",onChange:i=>{const r={...n,username:i.target.value};d(r),a(r,!1)}})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm text-slate-300",children:t("settings.password")}),e.jsx("input",{type:"password",className:"input-text",value:n.password||"",onChange:i=>{const r={...n,password:i.target.value};d(r),a(r,!1)}})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm text-slate-300",children:t("settings.senderEmail")}),e.jsx("input",{className:"input-text",value:n.fromAddress||"",onChange:i=>{const r={...n,fromAddress:i.target.value};d(r),a(r,!1)}})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm text-slate-300",children:t("settings.senderName")}),e.jsx("input",{className:"input-text",value:n.fromName||"",onChange:i=>{const r={...n,fromName:i.target.value};d(r),a(r,!1)}})]})]}),e.jsx("div",{className:"pt-2",children:e.jsx(S,{label:t("settings.useSsl"),description:"Use SSL/TLS encryption",enabled:n.enableSsl,onChange:async i=>{try{const r={...n,enableSsl:i};d(r),await f("/api/settings/mail",{method:"PUT",body:JSON.stringify({...r,testRecipient:l})}),await c(),o(t("common.success"),"success")}catch(r){o(`${t("common.error")}: ${r instanceof Error?r.message:String(r)}`,"error")}},icon:e.jsx(q,{size:18})})}),e.jsxs("div",{className:"pt-4 border-t border-slate-800",children:[e.jsx("h4",{className:"text-sm font-medium text-white mb-3",children:t("settings.sendTestEmail")}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{className:"input-text flex-1",placeholder:t("settings.recipient"),value:l,onChange:i=>s(i.target.value)}),e.jsxs("button",{className:"btn-outline",onClick:m,disabled:u,children:[e.jsx(ae,{size:16})," ",t(u?"common.loading":"settings.sendTestEmail")]})]})]})]})]})}function me(){k();const{data:t,mutate:g}=N("capture-settings",ie),{data:c,mutate:n}=N("ui-preferences",U),[d,u]=h.useState({folder:"",timedFolder:"",filenamePattern:"",enableIntervalCapture:!1,intervalSeconds:60}),[x,l]=h.useState(!1),[s,a]=h.useState(!1);h.useEffect(()=>{t&&u({folder:t.folder||"",timedFolder:t.timedFolder||"",filenamePattern:t.filenamePattern||"",enableIntervalCapture:!1,intervalSeconds:60})},[t]);const m=D(async i=>{await f("/api/settings/capture",{method:"PUT",body:JSON.stringify({folder:i.folder,timedFolder:i.timedFolder,filenamePattern:i.filenamePattern,enableIntervalCapture:t?.enableIntervalCapture||!1,intervalSeconds:t?.intervalSeconds||60})})},g,500);return e.jsxs("div",{className:"panel",children:[e.jsxs("h3",{className:"panel-title flex items-center gap-2",children:[e.jsx(w,{size:18})," Screenshots"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-1",children:"Screenshot Folder"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{className:"input-text flex-1",value:T(d.folder),onChange:i=>{const r=i.target.value.replace(/\\\\/g,"\\"),v={...d,folder:r};u(v),m(v,!1)}}),e.jsx("button",{className:"btn-outline",type:"button",onClick:()=>l(!0),children:e.jsx(w,{size:16})})]}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Default location for manual screenshots"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-1",children:"Timed Screenshot Folder"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{className:"input-text flex-1",value:T(d.timedFolder||""),onChange:i=>{const r=i.target.value.replace(/\\\\/g,"\\"),v={...d,timedFolder:r};u(v),m(v,!1)}}),e.jsx("button",{className:"btn-outline",type:"button",onClick:()=>a(!0),children:e.jsx(w,{size:16})})]}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Location for automatic interval screenshots"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-1",children:"Filename Pattern"}),e.jsx("input",{className:"input-text",value:d.filenamePattern,onChange:i=>{const r={...d,filenamePattern:i.target.value};u(r),m(r,!1)},placeholder:"screenshot_{timestamp}.png"}),e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Use ","{timestamp}"," for date/time, ","{display}"," for display number"]})]}),e.jsx("div",{className:"pt-2 border-t border-slate-800",children:e.jsx(S,{label:"Expand log panel by default",description:"Screenshot capture logs",enabled:c?.logPanelExpanded?.Screenshots??!1,onChange:async i=>{try{const r={...c,logPanelExpanded:{...c?.logPanelExpanded,Screenshots:i}};await z(r),await n(),o("Preference saved successfully","success")}catch(r){o(`Failed to save: ${r instanceof Error?r.message:String(r)}`,"error")}},icon:e.jsx(F,{size:18})})}),x&&e.jsx(R,{initialPath:d.folder,onSelect:async i=>{const r=i.replace(/\\\\/g,"\\"),v={...d,folder:r};u(v),l(!1);try{await f("/api/settings/capture",{method:"PUT",body:JSON.stringify({folder:r,timedFolder:d.timedFolder,filenamePattern:d.filenamePattern,enableIntervalCapture:t?.enableIntervalCapture||!1,intervalSeconds:t?.intervalSeconds||60})}),await g(),o("Folder saved successfully","success")}catch(j){o(`Failed to save: ${j instanceof Error?j.message:String(j)}`,"error")}},onCancel:()=>l(!1)}),s&&e.jsx(R,{initialPath:d.timedFolder||"",onSelect:async i=>{const r=i.replace(/\\\\/g,"\\"),v={...d,timedFolder:r};u(v),a(!1);try{await f("/api/settings/capture",{method:"PUT",body:JSON.stringify({folder:d.folder,timedFolder:r,filenamePattern:d.filenamePattern,enableIntervalCapture:t?.enableIntervalCapture||!1,intervalSeconds:t?.intervalSeconds||60})}),await g(),o("Folder saved successfully","success")}catch(j){o(`Failed to save: ${j instanceof Error?j.message:String(j)}`,"error")}},onCancel:()=>a(!1)})]})]})}function ue(){const t=()=>f("/api/settings/logging"),{data:g,mutate:c}=N("logging-settings",t),[n,d]=h.useState({folder:"",retentionDays:14,minimumLevel:"Information",maxFileSizeBytes:10*1024*1024,maxFilesPerDay:5,enableSizeRotation:!0,componentEnabled:{VNC:!0,DiskMonitor:!0,ApplicationMonitor:!0,Screenshots:!0,General:!0},componentLevels:{}}),[u,x]=h.useState(!1);h.useEffect(()=>{g&&d({...g,componentEnabled:g.componentEnabled||{VNC:!0,DiskMonitor:!0,ApplicationMonitor:!0,Screenshots:!0,General:!0},componentLevels:g.componentLevels||{}})},[g]);const l=D(async s=>{await f("/api/settings/logging",{method:"PUT",body:JSON.stringify(s)})},c,500);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"panel",children:[e.jsxs("h3",{className:"panel-title flex items-center gap-2",children:[e.jsx(W,{size:18})," Log File Rotation"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-1",children:"Log Folder"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{className:"input-text flex-1",value:T(n.folder),onChange:s=>{const a=s.target.value.replace(/\\\\/g,"\\"),m={...n,folder:a};d(m),l(m,!1)}}),e.jsx("button",{className:"btn-outline",type:"button",onClick:()=>x(!0),children:e.jsx(w,{size:16})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-1",children:"Retention Days"}),e.jsx("input",{type:"number",className:"input-text",min:"0",value:n.retentionDays,onChange:s=>{const a={...n,retentionDays:parseInt(s.target.value)||0};d(a),l(a,!1)}}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"How many days to keep log files (0 = keep forever)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-1",children:"Minimum Log Level"}),e.jsxs("select",{className:"input-text",value:n.minimumLevel,onChange:async s=>{const a={...n,minimumLevel:s.target.value};d(a);try{await f("/api/settings/logging",{method:"PUT",body:JSON.stringify(a)}),await c(),o("Log level saved successfully","success")}catch(m){o(`Failed to save: ${m instanceof Error?m.message:String(m)}`,"error")}},children:[e.jsx("option",{value:"Trace",children:"Trace"}),e.jsx("option",{value:"Debug",children:"Debug"}),e.jsx("option",{value:"Information",children:"Information"}),e.jsx("option",{value:"Warning",children:"Warning"}),e.jsx("option",{value:"Error",children:"Error"}),e.jsx("option",{value:"Critical",children:"Critical"}),e.jsx("option",{value:"None",children:"None"})]})]})]}),e.jsxs("div",{className:"pt-2 border-t border-slate-800",children:[e.jsx(S,{label:"Enable size-based rotation",description:"Rotate log files when they reach a certain size",enabled:n.enableSizeRotation,onChange:async s=>{try{const a={...n,enableSizeRotation:s};d(a),await f("/api/settings/logging",{method:"PUT",body:JSON.stringify(a)}),await c(),o("Settings saved successfully","success")}catch(a){o(`Failed to save: ${a instanceof Error?a.message:String(a)}`,"error")}}}),n.enableSizeRotation&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4 pl-6 border-l-2 border-slate-800",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-1",children:"Max File Size (MB)"}),e.jsx("input",{type:"number",className:"input-text",min:"1",step:"1",value:Math.round(n.maxFileSizeBytes/(1024*1024)),onChange:s=>{const a=parseInt(s.target.value)||1,m={...n,maxFileSizeBytes:a*1024*1024};d(m),l(m,!1)}}),e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Current: ",se(n.maxFileSizeBytes)]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-1",children:"Max Files Per Day"}),e.jsx("input",{type:"number",className:"input-text",min:"0",value:n.maxFilesPerDay,onChange:s=>{const a={...n,maxFilesPerDay:parseInt(s.target.value)||0};d(a),l(a,!1)}}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Maximum rotated files to keep per day (0 = unlimited)"})]})]})]})]})]}),e.jsxs("div",{className:"panel",children:[e.jsxs("h3",{className:"panel-title flex items-center gap-2",children:[e.jsx(C,{size:18})," Component Logging"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-slate-400",children:"Enable or disable logging for specific components. Each component writes to its own log file in a subfolder."}),e.jsx("div",{className:"space-y-3",children:["VNC","DiskMonitor","ApplicationMonitor","Screenshots","Files","General"].map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-900/50 rounded border border-slate-800",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-300 cursor-pointer",htmlFor:`component-${s}`,children:s}),e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:[s==="VNC"&&"VNC server and connection logs",s==="DiskMonitor"&&"Disk and folder monitoring logs",s==="ApplicationMonitor"&&"Application monitoring and restart logs",s==="Screenshots"&&"Screenshot capture and interval logs",s==="Files"&&"File Explorer operations and navigation logs",s==="General"&&"General application logs"]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("select",{className:"input-text text-xs py-1 w-24",value:n.componentLevels?.[s]||n.minimumLevel,onChange:async a=>{const m={...n,componentLevels:{...n.componentLevels,[s]:a.target.value}};d(m);try{await f("/api/settings/logging",{method:"PUT",body:JSON.stringify(m)}),await c()}catch(i){console.error("Failed to save component level:",i)}},onClick:a=>a.stopPropagation(),children:[e.jsx("option",{value:"Trace",children:"Trace"}),e.jsx("option",{value:"Debug",children:"Debug"}),e.jsx("option",{value:"Information",children:"Info"}),e.jsx("option",{value:"Warning",children:"Warn"}),e.jsx("option",{value:"Error",children:"Error"}),e.jsx("option",{value:"Critical",children:"Critical"}),e.jsx("option",{value:"None",children:"None"})]}),e.jsx("input",{type:"checkbox",id:`component-${s}`,className:"checkbox",checked:n.componentEnabled?.[s]??!0,onChange:async a=>{const m={...n,componentEnabled:{...n.componentEnabled,[s]:a.target.checked}};d(m);try{await f("/api/settings/logging",{method:"PUT",body:JSON.stringify(m)}),await c()}catch(i){console.error("Failed to save component enabled state:",i)}}})]})]},s))})]})]}),u&&e.jsx(R,{initialPath:n.folder,onSelect:s=>{const a=s.replace(/\\\\/g,"\\");d({...n,folder:a}),x(!1)},onCancel:()=>x(!1)})]})}function pe(){k();const[t,g]=h.useState(!1),{data:c,mutate:n}=N("file-explorer-settings",te),{data:d,mutate:u}=N("ui-preferences",U),[x,l]=h.useState({homeFolder:""});h.useEffect(()=>{c&&l(c)},[c]);const s=D(async a=>{await B(a)},n,500);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"panel",children:[e.jsxs("h3",{className:"panel-title flex items-center gap-2",children:[e.jsx(w,{size:18})," File Explorer Configuration"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-1",children:"Home Folder"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{className:"input-text flex-1",value:T(x.homeFolder),onChange:a=>{const m=a.target.value.replace(/\\\\/g,"\\"),i={...x,homeFolder:m};l(i),s(i,!1)}}),e.jsx("button",{className:"btn-outline",type:"button",onClick:()=>g(!0),children:e.jsx(w,{size:16})})]}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Default starting location for File Explorer"})]}),t&&e.jsx(R,{initialPath:x.homeFolder,onSelect:async a=>{const m=a.replace(/\\\\/g,"\\"),i={...x,homeFolder:m};l(i),g(!1);try{await B(i),await n(),o("Home folder saved successfully","success")}catch(r){o(`Failed to save: ${r instanceof Error?r.message:String(r)}`,"error")}},onCancel:()=>g(!1)})]})]}),e.jsxs("div",{className:"panel",children:[e.jsxs("h3",{className:"panel-title flex items-center gap-2",children:[e.jsx(F,{size:18})," Display Preferences"]}),e.jsx("div",{className:"space-y-4",children:e.jsx(S,{label:"Expand log panel by default",description:"File Explorer operation logs",enabled:d?.logPanelExpanded?.Files??!1,onChange:async a=>{try{const m={...d,logPanelExpanded:{...d?.logPanelExpanded,Files:a}};await z(m),await u(),o("Preference saved successfully","success")}catch(m){o(`Failed to save: ${m instanceof Error?m.message:String(m)}`,"error")}},icon:e.jsx(F,{size:18})})})]})]})}function xe(){const{t}=k(),[g,c]=h.useState(!1),[n,d]=h.useState(!1),[u,x]=h.useState(""),{data:l,mutate:s}=N("vnc-config",()=>f("/api/vnc/config")),[a,m]=h.useState({enabled:!1,port:5900,allowRemote:!1,hasPassword:!1,autoStart:!1});h.useEffect(()=>{l&&m(l)},[l]);const i=D(async v=>{await f("/api/vnc/config",{method:"PUT",body:JSON.stringify({enabled:!0,port:v.port,allowRemote:v.allowRemote,autoStart:v.autoStart,password:void 0})})},s,500),r=async()=>{if(!u){o("Please enter a password","error");return}c(!0);try{await f("/api/vnc/config",{method:"PUT",body:JSON.stringify({enabled:!0,port:a.port,allowRemote:a.allowRemote,autoStart:a.autoStart,password:u})}),await s(),x(""),o(t("settings.remoteDesktop.saveSuccess"),"success")}catch(v){o(t("settings.remoteDesktop.saveFailure",{message:v instanceof Error?v.message:String(v)}),"error")}finally{c(!1)}};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"panel space-y-4",children:[e.jsxs("h3",{className:"panel-title flex items-center gap-2",children:[e.jsx(C,{size:18})," ",t("settings.remoteDesktop.title")]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"vnc-port",className:"block text-sm text-slate-400 mb-1",children:t("settings.remoteDesktop.port")}),e.jsx("input",{type:"number",id:"vnc-port",min:1024,max:65535,className:"input-text w-32",value:a.port,onChange:v=>{const j={...a,port:parseInt(v.target.value)||5900};m(j),i(j,!1)}})]}),e.jsx(S,{label:"Start automatically",description:"Start VNC server when application launches",enabled:a.autoStart??!1,onChange:async v=>{try{const j={...a,autoStart:v};m(j),await f("/api/vnc/config",{method:"PUT",body:JSON.stringify({enabled:!0,port:a.port,allowRemote:a.allowRemote,autoStart:v,password:void 0})}),await s(),o(t("common.success"),"success")}catch(j){o(`${t("common.error")}: ${j instanceof Error?j.message:String(j)}`,"error")}},icon:e.jsx(C,{size:18})}),e.jsx(S,{label:t("settings.remoteDesktop.allowRemote"),description:"Allow connections from other machines",enabled:a.allowRemote,onChange:async v=>{try{const j={...a,allowRemote:v};m(j),await f("/api/vnc/config",{method:"PUT",body:JSON.stringify({enabled:!0,port:a.port,allowRemote:v,autoStart:a.autoStart,password:void 0})}),await s(),o(t("common.success"),"success")}catch(j){o(`${t("common.error")}: ${j instanceof Error?j.message:String(j)}`,"error")}},icon:e.jsx(G,{size:18})}),a.allowRemote&&e.jsx("div",{className:"bg-amber-900/20 border border-amber-500/50 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx($,{size:16,className:"text-amber-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-amber-200",children:[e.jsx("p",{className:"font-semibold mb-1",children:t("settings.remoteDesktop.securityWarning")}),e.jsx("p",{children:t("settings.remoteDesktop.securityWarningText")})]})]})}),e.jsxs("div",{className:"pt-2 border-t border-slate-800",children:[e.jsx("label",{htmlFor:"vnc-password",className:"block text-sm text-slate-400 mb-2",children:t("settings.remoteDesktop.password")}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:n?"text":"password",id:"vnc-password",className:"input-text flex-1",placeholder:a.hasPassword?t("settings.remoteDesktop.passwordPlaceholder"):t("settings.remoteDesktop.passwordEmpty"),value:u,onChange:v=>x(v.target.value)}),e.jsx("button",{className:"btn-outline",onClick:()=>d(!n),title:t(n?"settings.remoteDesktop.hidePassword":"settings.remoteDesktop.showPassword"),children:e.jsx(F,{size:16})}),e.jsxs("button",{className:"btn-primary",onClick:r,disabled:g||!u,children:[e.jsx(H,{size:16})," ",g?"Saving...":"Set Password"]})]}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:t("settings.remoteDesktop.passwordHint")})]})]})]}),e.jsx(ge,{})]})}function ge(){k();const{data:t,mutate:g}=N("vnc-recording-config",()=>f("/api/vnc/recordings/config")),[c,n]=h.useState({rootFolder:"",maxRecordingDurationMinutes:120,retentionDays:30,enableMotionDetection:!1,motionDetectionThresholdPercent:10,motionDetectionBlockSize:32,motionDetectionPauseDelaySeconds:10,recordingFps:5,useProfileSubfolders:!0}),[d,u]=h.useState(!1);h.useEffect(()=>{t&&n(t)},[t]);const x=D(async l=>{await f("/api/vnc/recordings/config",{method:"PUT",body:JSON.stringify(l)})},g,500);return e.jsxs("div",{className:"panel space-y-4",children:[e.jsxs("h3",{className:"panel-title flex items-center gap-2",children:[e.jsx(V,{size:18})," VNC Recording"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"recording-folder",className:"block text-sm text-slate-400 mb-1",children:"Recordings Folder"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{className:"input-text flex-1",value:T(c.rootFolder),onChange:l=>{const s=l.target.value.replace(/\\\\/g,"\\"),a={...c,rootFolder:s};n(a),x(a,!1)}}),e.jsx("button",{className:"btn-outline",type:"button",onClick:()=>u(!0),children:e.jsx(w,{size:16})})]}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Default location for VNC session recordings"})]}),e.jsx(S,{label:"Use profile-specific subfolders",description:"Organize recordings by VNC profile",enabled:c.useProfileSubfolders,onChange:async l=>{try{const s={...c,useProfileSubfolders:l};n(s),await f("/api/vnc/recordings/config",{method:"PUT",body:JSON.stringify(s)}),await g(),o("Settings saved successfully","success")}catch(s){o(`Failed to save: ${s instanceof Error?s.message:String(s)}`,"error")}},icon:e.jsx(w,{size:18})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"max-duration",className:"block text-sm text-slate-400 mb-1",children:"Max Recording Duration (minutes)"}),e.jsx("input",{type:"number",id:"max-duration",min:1,max:480,className:"input-text w-full",value:c.maxRecordingDurationMinutes,onChange:l=>{const s={...c,maxRecordingDurationMinutes:parseInt(l.target.value)||120};n(s),x(s,!1)}})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"retention-days",className:"block text-sm text-slate-400 mb-1",children:"Retention Period (days)"}),e.jsx("input",{type:"number",id:"retention-days",min:1,max:365,className:"input-text w-full",value:c.retentionDays,onChange:l=>{const s={...c,retentionDays:parseInt(l.target.value)||30};n(s),x(s,!1)}})]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"recording-fps",className:"block text-sm text-slate-400 mb-1",children:["Recording FPS: ",c.recordingFps]}),e.jsx("input",{type:"range",id:"recording-fps",min:1,max:30,className:"w-full",value:c.recordingFps,onChange:l=>{const s={...c,recordingFps:parseInt(l.target.value)};n(s),x(s,!1)}}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Lower FPS reduces file size but may result in choppy playback"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(S,{label:"Enable Motion Detection",description:"Only record when screen changes are detected",enabled:c.enableMotionDetection,onChange:async l=>{try{const s={...c,enableMotionDetection:l};n(s),await f("/api/vnc/recordings/config",{method:"PUT",body:JSON.stringify(s)}),await g(),o("Settings saved successfully","success")}catch(s){o(`Failed to save: ${s instanceof Error?s.message:String(s)}`,"error")}},icon:e.jsx(V,{size:18})}),c.enableMotionDetection&&e.jsxs("div",{className:"ml-6 space-y-3 border-l-2 border-blue-500/30 pl-4",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"motion-threshold",className:"block text-sm text-slate-400 mb-1",children:["Motion Sensitivity: ",c.motionDetectionThresholdPercent,"%"]}),e.jsx("input",{type:"range",id:"motion-threshold",min:1,max:50,className:"w-full",value:c.motionDetectionThresholdPercent,onChange:l=>{const s={...c,motionDetectionThresholdPercent:parseInt(l.target.value)};n(s),x(s,!1)}}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Lower values = more sensitive (records with less change)"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"block-size",className:"block text-sm text-slate-400 mb-1",children:"Detection Block Size"}),e.jsxs("select",{id:"block-size",className:"input-text w-full",value:c.motionDetectionBlockSize,onChange:async l=>{const s=parseInt(l.target.value),a={...c,motionDetectionBlockSize:s};n(a);try{await f("/api/vnc/recordings/config",{method:"PUT",body:JSON.stringify(a)}),await g(),o("Block size saved successfully","success")}catch(m){o(`Failed to save: ${m instanceof Error?m.message:String(m)}`,"error")}},children:[e.jsx("option",{value:16,children:"16x16 (High precision, higher CPU)"}),e.jsx("option",{value:32,children:"32x32 (Balanced)"}),e.jsx("option",{value:64,children:"64x64 (Low precision, lower CPU)"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"pause-delay",className:"block text-sm text-slate-400 mb-1",children:["Pause Delay: ",c.motionDetectionPauseDelaySeconds," seconds"]}),e.jsx("input",{type:"range",id:"pause-delay",min:1,max:60,className:"w-full",value:c.motionDetectionPauseDelaySeconds,onChange:l=>{const s={...c,motionDetectionPauseDelaySeconds:parseInt(l.target.value)};n(s),x(s,!1)}}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Time to wait before pausing recording when no motion is detected"})]})]})]})]}),d&&e.jsx(R,{initialPath:c.rootFolder,onSelect:async l=>{const s=l.replace(/\\\\/g,"\\"),a={...c,rootFolder:s};n(a),u(!1);try{await f("/api/vnc/recordings/config",{method:"PUT",body:JSON.stringify(a)}),await g(),o("Recordings folder saved successfully","success")}catch(m){o(`Failed to save: ${m instanceof Error?m.message:String(m)}`,"error")}},onCancel:()=>u(!1)})]})}export{Pe as default};
