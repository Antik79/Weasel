import{c as j,r as a,a as f,o as R,b as v,j as t,p as P}from"./index-DO9zxgcv.js";/**
 * @license lucide-react v0.439.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b=j("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.439.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k=j("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);function T({name:p,title:w,subfolder:r}){const[o,C]=a.useState(!0),[s,h]=a.useState(!1),[g,L]=a.useState(!1),d=a.useRef(null),i=a.useRef(null),{data:l}=f("ui-preferences",R,{revalidateOnFocus:!1,revalidateOnReconnect:!1});a.useEffect(()=>{if(l&&!g){const e=l.logPanelExpanded?.[p];e!==void 0&&h(e),L(!0)}},[l,p,g]);const N=e=>{l&&(i.current&&clearTimeout(i.current),i.current=setTimeout(async()=>{try{const n={...l,logPanelExpanded:{...l.logPanelExpanded,[p]:e}};await P(n)}catch(n){console.error("Failed to save UI preferences:",n)}},500))},E=()=>{const e=!s;h(e),g&&N(e)};a.useEffect(()=>()=>{i.current&&clearTimeout(i.current)},[]);const{data:u}=f(s?`${r}-log-files`:null,()=>{const e=new URL("/api/logs",window.location.origin);return e.searchParams.set("subfolder",r),v(e.toString())},{refreshInterval:1e4}),m=a.useMemo(()=>!u?.files||u.files.length===0?null:u.files.sort((e,n)=>n.name.localeCompare(e.name))[0],[u]),{data:c,isLoading:x}=f(s&&m?[`${r}-log`,m.name]:null,([,e])=>{const n=new URL(`/api/logs/${encodeURIComponent(e)}`,window.location.origin);return n.searchParams.set("subfolder",r),v(n.toString())},{revalidateOnFocus:!0,refreshInterval:o?2e3:void 0});return a.useEffect(()=>{o&&s&&c&&d.current&&(d.current.scrollTop=d.current.scrollHeight)},[c,o,s]),t.jsxs("div",{className:"panel space-y-2",children:[t.jsxs("div",{className:"flex items-center justify-between cursor-pointer select-none",onClick:E,children:[t.jsxs("h3",{className:"panel-title mb-0 flex items-center gap-2",children:[s?t.jsx(b,{size:18}):t.jsx(k,{size:18}),w]}),t.jsxs("div",{className:"flex items-center gap-4",onClick:e=>e.stopPropagation(),children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"checkbox",id:`tail-${r}`,className:"checkbox",checked:o,onChange:e=>C(e.target.checked),disabled:!s}),t.jsx("label",{htmlFor:`tail-${r}`,className:`text-xs ${s?"text-slate-400 cursor-pointer":"text-slate-600"}`,children:"Tail Log"})]}),t.jsx("div",{className:"text-xs text-slate-500 w-24 text-right",children:x?"Loading...":o&&s?"Live":"Paused"})]})]}),s&&t.jsxs("div",{ref:d,className:"bg-slate-950 rounded border border-slate-800 p-3 max-h-96 overflow-y-auto font-mono text-xs",children:[x&&t.jsx("p",{className:"text-slate-400",children:"Loading log..."}),!x&&!c&&t.jsx("p",{className:"text-slate-400",children:"No log content available"}),!x&&c&&t.jsx("pre",{className:"text-slate-300 whitespace-pre-wrap break-all",children:c})]})]})}export{b as C,T as L};
