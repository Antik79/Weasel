const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-DM_f2Lle.js","assets/vendor-editor-CtusPbyv.js","assets/vendor-utils-CpUfumj7.js","assets/vendor-terminal-CTS2sXWF.js","assets/vendor-terminal-C0BCwPpi.css"])))=>i.map(i=>d[i]);
import{c as k,j as e,u as qe,g as js,a as ks,b as p,s as m,H as ws,X as U,A as Q,d as G,S as zt,f as Pt,P as Ft,e as vs,h as Y,M as Ns,C as Cs,i as Dt,F as At,V as Ss,_ as zs}from"./index-CFy-3w2c.js";import{r as n}from"./vendor-utils-CpUfumj7.js";import{T as ge,L as Ps}from"./LogPanel-BApmYpq7.js";import{U as Mt,P as Et,R as Lt}from"./upload-DD99DkRl.js";import{F as ye}from"./folder-BcBcgh9m.js";import{S as Fs,A as It}from"./search-CXHZ8IYf.js";import{D as be}from"./download-DHqHKtrx.js";import{S as je,F as Ds,I as As}from"./square-check-big-bHqBvSos.js";import{E as ke}from"./eye-oiPQLzsB.js";import"./vendor-terminal-CTS2sXWF.js";/**
 * @license lucide-react v0.439.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ms=k("Clipboard",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]]);/**
 * @license lucide-react v0.439.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Es=k("Cog",[["path",{d:"M12 20a8 8 0 1 0 0-16 8 8 0 0 0 0 16Z",key:"sobvz5"}],["path",{d:"M12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4Z",key:"11i496"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 22v-2",key:"1osdcq"}],["path",{d:"m17 20.66-1-1.73",key:"eq3orb"}],["path",{d:"M11 10.27 7 3.34",key:"16pf9h"}],["path",{d:"m20.66 17-1.73-1",key:"sg0v6f"}],["path",{d:"m3.34 7 1.73 1",key:"1ulond"}],["path",{d:"M14 12h8",key:"4f43i9"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"m20.66 7-1.73 1",key:"1ow05n"}],["path",{d:"m3.34 17 1.73-1",key:"nuk764"}],["path",{d:"m17 3.34-1 1.73",key:"2wel8s"}],["path",{d:"m11 13.73-4 6.93",key:"794ttg"}]]);/**
 * @license lucide-react v0.439.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tt=k("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.439.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Je=k("FileArchive",[["path",{d:"M10 12v-1",key:"v7bkov"}],["path",{d:"M10 18v-2",key:"1cjy8d"}],["path",{d:"M10 7V6",key:"dljcrl"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M15.5 22H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v16a2 2 0 0 0 .274 1.01",key:"gkbcor"}],["circle",{cx:"10",cy:"20",r:"2",key:"1xzdoj"}]]);/**
 * @license lucide-react v0.439.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ls=k("FileCode",[["path",{d:"M10 12.5 8 15l2 2.5",key:"1tg20x"}],["path",{d:"m14 12.5 2 2.5-2 2.5",key:"yinavb"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7z",key:"1mlx9k"}]]);/**
 * @license lucide-react v0.439.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ve=k("FilePen",[["path",{d:"M12.5 22H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v9.5",key:"1couwa"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M13.378 15.626a1 1 0 1 0-3.004-3.004l-5.01 5.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"1y4qbx"}]]);/**
 * @license lucide-react v0.439.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Is=k("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.439.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ot=k("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.439.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ts=k("Music",[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]]);/**
 * @license lucide-react v0.439.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rt=k("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.439.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ut=k("Scissors",[["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M8.12 8.12 12 12",key:"1alkpv"}],["path",{d:"M20 4 8.12 15.88",key:"xgtan2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M14.8 14.8 20 20",key:"ptml3r"}]]);/**
 * @license lucide-react v0.439.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Os=k("StarOff",[["path",{d:"M8.34 8.34 2 9.27l5 4.87L5.82 21 12 17.77 18.18 21l-.59-3.43",key:"16m0ql"}],["path",{d:"M18.42 12.76 22 9.27l-6.91-1L12 2l-1.44 2.91",key:"1vt8nq"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.439.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $t=k("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);function Rs({x:r,y:i,items:o,onClose:g}){const u=n.useRef(null);n.useEffect(()=>{const w=C=>{u.current&&!u.current.contains(C.target)&&g()};return document.addEventListener("mousedown",w),()=>document.removeEventListener("mousedown",w)},[g]);const $={top:i,left:r};return e.jsx("div",{ref:u,className:"fixed z-50 bg-slate-800 border border-slate-700 rounded-lg shadow-xl py-1 min-w-[160px]",style:$,children:o.map((w,C)=>e.jsxs("button",{className:`w-full text-left px-4 py-2 text-sm flex items-center gap-2 hover:bg-slate-700 ${w.danger?"text-red-400 hover:text-red-300":"text-slate-200 hover:text-white"}`,onClick:()=>{w.onClick(),g()},children:[w.icon&&e.jsx("span",{className:"w-4 h-4",children:w.icon}),w.label]},C))})}const Us=n.lazy(()=>zs(()=>import("./index-DM_f2Lle.js"),__vite__mapDeps([0,1,2,3,4]))),$s=()=>typeof crypto<"u"&&typeof crypto.randomUUID=="function"?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,r=>{const i=Math.random()*16|0;return(r==="x"?i:i&3|8).toString(16)}),Bs=async r=>{const i=new URL("/api/fs",window.location.origin);return r&&i.searchParams.set("path",r),p(i.toString())},qs=()=>p("/api/fs/drives"),Vt=r=>r.replace(/\//g,"\\"),Ne=r=>{if(!r)return"";const i=Vt(r);return i.endsWith("\\")?i:`${i}\\`},we=r=>{if(!r)return"";let i=Vt(r).replace(/\\+$/,"");if(i.startsWith("\\\\")){const u=i.split("\\").filter(Boolean);return u.length<=2?`\\\\${u.join("\\")}\\`:(u.pop(),`\\\\${u.join("\\")}\\`)}if(i.endsWith(":"))return`${i}\\`;const g=i.lastIndexOf("\\");return g<=1?`${i.slice(0,g+1)}\\`:`${i.slice(0,g)}\\`},ve=(r,i)=>r?`${Ne(r)}${i}`:i,Vs=r=>{switch(r.split(".").pop()?.toLowerCase()){case"js":case"jsx":return"javascript";case"ts":case"tsx":return"typescript";case"json":return"json";case"css":return"css";case"html":return"html";case"cs":return"csharp";case"sql":return"sql";case"xml":return"xml";case"md":return"markdown";case"yml":case"yaml":return"yaml";default:return"plaintext"}},Js=r=>{const i=r.split(".").pop()?.toLowerCase();return["png","jpg","jpeg","gif","bmp","webp","svg","ico"].includes(i||"")},ee=r=>{const i=r.split(".").pop()?.toLowerCase()||"";return["png","jpg","jpeg","gif","bmp","webp","svg","ico","tiff","tif"].includes(i)?"image":["mp4","webm","mkv","avi","mov","wmv","flv","m4v"].includes(i)?"video":["mp3","wav","ogg","flac","aac","wma","m4a"].includes(i)?"audio":["zip","rar","7z","tar","gz","bz2","xz","tgz"].includes(i)?"archive":["js","jsx","ts","tsx","cs","py","java","cpp","c","h","hpp","go","rs","rb","php","swift","kt","scala","sql","html","css","scss","less","vue","svelte"].includes(i)?"code":["txt","md","log","json","xml","yml","yaml","ini","cfg","conf","env","gitignore","dockerignore","editorconfig","csv","tsv"].includes(i)?"text":["exe","msi","bat","cmd","ps1","sh","dll","so","dylib"].includes(i)?"executable":["pdf","doc","docx","xls","xlsx","ppt","pptx","odt","ods","odp"].includes(i)?"document":"unknown"},Bt=r=>{const i=ee(r);return i==="code"||i==="text"},qt=r=>{const i=ee(r);return i==="code"||i==="text"},Ws=r=>{const i=ee(r),o=r.split(".").pop()?.toLowerCase()||"";switch(i){case"image":return{icon:e.jsx(As,{size:18}),color:"text-green-300"};case"video":return{icon:e.jsx(Ss,{size:18}),color:"text-pink-300"};case"audio":return{icon:e.jsx(Ts,{size:18}),color:"text-purple-300"};case"archive":return{icon:e.jsx(Je,{size:18}),color:"text-amber-300"};case"code":return{icon:e.jsx(Ls,{size:18}),color:"text-blue-300"};case"text":return{icon:e.jsx(At,{size:18}),color:"text-slate-300"};case"executable":return{icon:e.jsx(Es,{size:18}),color:"text-red-300"};case"document":return["xls","xlsx","ods","csv"].includes(o)?{icon:e.jsx(Is,{size:18}),color:"text-emerald-300"}:{icon:e.jsx(At,{size:18}),color:"text-orange-300"};default:return{icon:e.jsx(Ds,{size:18}),color:"text-slate-400"}}};function sa(){const{data:r}=qe("file-explorer-settings",js),i=r?.homeFolder||"",[o,g]=n.useState(""),[u,$]=n.useState(null),[w,C]=n.useState(""),[We,He]=n.useState(!1),[Ze,Ce]=n.useState(!1),[_e,te]=n.useState(!1),[c,D]=n.useState(new Set),[S,B]=n.useState(null),[z,Ke]=n.useState(()=>{try{const t=localStorage.getItem("weasel.bookmarks");return t?JSON.parse(t):[]}catch{return[]}}),[se,Se]=n.useState(!1),[P,Xe]=n.useState(""),[Qe,ae]=n.useState(!1),[q,Ge]=n.useState(null),[Jt,ne]=n.useState(""),[E,ze]=n.useState(!1),[L,Pe]=n.useState(null),{t:d}=ks(),[j,Wt]=n.useState({key:"name",direction:"asc"}),[Fe,Ht]=n.useState(()=>{const t=localStorage.getItem("weasel.layout.leftPanelWidth");return t?parseInt(t):33}),[le,V]=n.useState(null),[ie,Ye]=n.useState(!1),[J,Zt]=n.useState(()=>{const t=localStorage.getItem("weasel.files.foldersPageSize");return t?parseInt(t):50}),[De,et]=n.useState(1),[W,_t]=n.useState(()=>{const t=localStorage.getItem("weasel.files.filesPageSize");return t?parseInt(t):50}),[Ae,tt]=n.useState(1),[F,H]=n.useState({isOpen:!1,title:"",message:"",onConfirm:()=>{},variant:"info"});n.useEffect(()=>{const t=localStorage.getItem("weasel.lastPath");t&&!o&&g(t)},[]),n.useEffect(()=>{o&&localStorage.setItem("weasel.lastPath",o)},[o]);const{data:A,mutate:st,isLoading:oe,error:at}=qe(o,Bs,{revalidateOnFocus:!1}),{data:nt}=qe("drives",qs,{revalidateOnFocus:!1}),Me=Array.isArray(nt)?nt:[],re=n.useMemo(()=>(Array.isArray(A)?A:[]).filter(s=>s.isDirectory),[A]),ce=n.useMemo(()=>(Array.isArray(A)?A:[]).filter(s=>!s.isDirectory),[A]),lt=n.useMemo(()=>{if(!Array.isArray(re))return[];if(!P)return re;const t=P.toLowerCase();return re.filter(s=>s.name.toLowerCase().includes(t))},[re,P]),it=n.useMemo(()=>{if(!Array.isArray(ce))return[];if(!P)return ce;const t=P.toLowerCase();return ce.filter(s=>s.name.toLowerCase().includes(t))},[ce,P]),de=n.useCallback(t=>[...t].sort((s,a)=>{let l=0;switch(j.key){case"name":l=s.name.localeCompare(a.name);break;case"size":l=s.sizeBytes-a.sizeBytes;break;case"date":l=new Date(s.modifiedAt).getTime()-new Date(a.modifiedAt).getTime();break}return j.direction==="asc"?l:-l}),[j]),me=n.useMemo(()=>de(lt),[lt,de]),ue=n.useMemo(()=>de(it),[it,de]),y=n.useMemo(()=>{if(J===0)return me;const t=(De-1)*J,s=t+J;return me.slice(t,s)},[me,J,De]),b=n.useMemo(()=>{if(W===0)return ue;const t=(Ae-1)*W,s=t+W;return ue.slice(t,s)},[ue,W,Ae]),Z=t=>{Wt(s=>({key:t,direction:s.key===t&&s.direction==="asc"?"desc":"asc"}))},Kt=t=>{Zt(t),et(1),localStorage.setItem("weasel.files.foldersPageSize",t.toString())},Xt=t=>{_t(t),tt(1),localStorage.setItem("weasel.files.filesPageSize",t.toString())},f=n.useCallback(()=>st(),[st]);n.useEffect(()=>{if(!se)return;const t=s=>{s.target.closest(".relative")||Se(!1)};return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[se]),n.useEffect(()=>{const t=s=>{s.target instanceof HTMLInputElement||s.target instanceof HTMLTextAreaElement||u||(s.ctrlKey&&s.key==="c"&&c.size>0?(s.preventDefault(),jt()):s.ctrlKey&&s.key==="x"&&c.size>0?(s.preventDefault(),kt()):s.ctrlKey&&s.key==="v"&&S?(s.preventDefault(),wt()):s.key==="Delete"&&c.size>0?(s.preventDefault(),bt()):s.ctrlKey&&s.key==="a"?(s.preventDefault(),Re()):s.key==="Escape"?(s.preventDefault(),v()):(s.key==="F5"||s.ctrlKey&&s.key==="r")&&(s.preventDefault(),f()))};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[c,S,u]);const ot=t=>{g(Ne(t.fullPath)),Oe()},Qt=async t=>{Ce(!0);try{const s=new URL("/api/fs/content",window.location.origin);s.searchParams.set("path",t);const a=await fetch(s.toString());if(!a.ok)throw new Error(await a.text());const l=await a.text();C(l)}finally{Ce(!1)}},rt=async t=>{$(t.fullPath),te(!1),await Qt(t.fullPath)},Gt=async t=>{if(t.target.files?.length){if(!o){m("Select a folder before uploading files.","warning"),t.target.value="";return}try{for(const s of Array.from(t.target.files)){const a=new FormData;a.append("path",Ne(o)),a.append("file",s,s.name),await Dt(a)}await f(),m("Files uploaded successfully","success")}catch(s){m(`Upload failed: ${s instanceof Error?s.message:"Unknown error"}`,"error")}finally{t.target.value=""}}},[he,ct]=n.useState(""),[Yt,I]=n.useState(!1),dt=async()=>{if(he.trim()){if(!o){m("Select a folder before creating a new folder.","warning");return}try{await p("/api/fs/directory",{method:"POST",body:JSON.stringify({parentPath:o,name:he.trim()})}),await f(),ct(""),I(!1),m("Folder created successfully","success")}catch(t){m(`Failed to create folder: ${t instanceof Error?t.message:"Unknown error"}`,"error")}}},[xe,mt]=n.useState(""),[es,T]=n.useState(!1),ut=()=>{if(!xe.trim())return;const t=ve(o,xe.trim());$(t),C(""),te(!0),mt(""),T(!1)},[Ee,ht]=n.useState(null),Le=async t=>{ht(t),H({isOpen:!0,title:"Delete Item",message:`Are you sure you want to delete "${t.name}"?`,onConfirm:async()=>{if(Ee)try{const s=new URL("/api/fs",window.location.origin);s.searchParams.set("path",Ee.fullPath),await p(s.toString(),{method:"DELETE"}),u===Ee.fullPath&&Oe(),await f(),m("Item deleted successfully","success")}catch(s){m(`Failed to delete: ${s instanceof Error?s.message:"Unknown error"}`,"error")}finally{ht(null),H({...F,isOpen:!1})}},variant:"danger"})},[_,xt]=n.useState(null),[O,Ie]=n.useState(""),[ts,M]=n.useState(!1),Te=async t=>{xt(t),Ie(t.name),M(!0)},ft=async()=>{if(!_||!O.trim()||O===_.name){M(!1);return}try{await p("/api/fs/rename",{method:"POST",body:JSON.stringify({path:_.fullPath,newName:O.trim()})}),await f(),m("Item renamed successfully","success")}catch(t){m(`Failed to rename: ${t instanceof Error?t.message:"Unknown error"}`,"error")}finally{xt(null),Ie(""),M(!1)}},ss=async()=>{if(u){He(!0);try{await p("/api/fs/write",{method:"POST",body:JSON.stringify({path:u,content:w})}),await f(),te(!1)}finally{He(!1)}}},Oe=()=>{$(null),C(""),te(!1),Ce(!1)},pt=t=>{D(s=>{const a=new Set(s);return a.has(t.fullPath)?a.delete(t.fullPath):a.add(t.fullPath),a})},Re=()=>{const t=Array.isArray(y)?y:[],s=Array.isArray(b)?b:[],a=new Set([...t,...s].map(l=>l.fullPath));D(a)},as=()=>{const t=Array.isArray(y)?y:[];D(s=>{const a=new Set(s);return t.forEach(l=>a.add(l.fullPath)),a})},ns=()=>{const t=Array.isArray(y)?y:[],s=new Set(t.map(a=>a.fullPath));D(a=>{const l=new Set(a);return s.forEach(h=>l.delete(h)),l})},ls=()=>{const t=Array.isArray(b)?b:[];D(s=>{const a=new Set(s);return t.forEach(l=>a.add(l.fullPath)),a})},is=()=>{const t=Array.isArray(b)?b:[],s=new Set(t.map(a=>a.fullPath));D(a=>{const l=new Set(a);return s.forEach(h=>l.delete(h)),l})},v=()=>{D(new Set)},K=n.useMemo(()=>{const t=Array.isArray(y)?y:[];if(t.length===0)return"none";const s=t.filter(a=>c.has(a.fullPath)).length;return s===0?"none":s===t.length?"all":"partial"},[y,c]),X=n.useMemo(()=>{const t=Array.isArray(b)?b:[];if(t.length===0)return"none";const s=t.filter(a=>c.has(a.fullPath)).length;return s===0?"none":s===t.length?"all":"partial"},[b,c]),gt=async t=>{if(t.isDirectory){const s=`${t.name}_${new Date().toISOString().slice(0,10)}.zip`,a=ve(o||we(t.fullPath),s);try{await p("/api/fs/bulk/zip",{method:"POST",body:JSON.stringify({sourcePaths:[t.fullPath],zipFilePath:a})}),Y(a),setTimeout(async()=>{try{await p("/api/fs/bulk/delete",{method:"POST",body:JSON.stringify({paths:[a]})}),await f()}catch{}},2e3)}catch(l){m(`Failed to zip folder: ${l instanceof Error?l.message:String(l)}`,"error")}}else Y(t.fullPath)},os=async()=>{if(c.size===0)return;const t=Array.from(c);if(t.length===1){const a=A?.find(l=>l.fullPath===t[0]);a?await gt(a):Y(t[0]);return}const s=new URL("/api/fs/download/bulk",window.location.origin);await fetch(s.toString(),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({paths:t})}).then(async a=>{if(a.ok){const l=await a.blob(),h=window.URL.createObjectURL(l),N=document.createElement("a");N.href=h,N.download=`download_${new Date().toISOString().slice(0,10)}.zip`,document.body.appendChild(N),N.click(),document.body.removeChild(N),window.URL.revokeObjectURL(h)}}),v(),await f()},[rs,yt]=n.useState(0),bt=async()=>{c.size!==0&&(yt(c.size),H({isOpen:!0,title:"Delete Items",message:`Are you sure you want to delete ${c.size} item(s)?`,onConfirm:async()=>{try{await p("/api/fs/bulk/delete",{method:"POST",body:JSON.stringify({paths:Array.from(c)})}),v(),await f(),m(`${rs} item(s) deleted successfully`,"success")}catch(t){m(`Failed to delete items: ${t instanceof Error?t.message:"Unknown error"}`,"error")}finally{yt(0),H({...F,isOpen:!1})}},variant:"danger"}))},jt=()=>{c.size!==0&&B({items:Array.from(c),operation:"copy"})},kt=()=>{c.size!==0&&B({items:Array.from(c),operation:"cut"})},wt=async()=>{if(!(!S||!o))try{S.operation==="copy"?await p("/api/fs/bulk/copy",{method:"POST",body:JSON.stringify({sourcePaths:S.items,destinationPath:o})}):S.operation==="cut"&&(await p("/api/fs/bulk/move",{method:"POST",body:JSON.stringify({sourcePaths:S.items,destinationPath:o})}),B(null)),v(),await f()}catch(t){m(`Paste failed: ${t instanceof Error?t.message:"Unknown error"}`,"error")}},cs=()=>{if(!o||z.includes(o))return;const t=[...z,o];Ke(t),localStorage.setItem("weasel.bookmarks",JSON.stringify(t))},vt=t=>{const a=(Array.isArray(z)?z:[]).filter(l=>l!==t);Ke(a),localStorage.setItem("weasel.bookmarks",JSON.stringify(a))},ds=t=>{g(t),v(),Se(!1)},fe=o&&z.includes(o),ms=async t=>{const s=window.prompt("Zip file name (e.g., archive.zip)",`${t.name}.zip`);if(!s)return;const a=ve(o||we(t.fullPath),s);await p("/api/fs/bulk/zip",{method:"POST",body:JSON.stringify({sourcePaths:[t.fullPath],zipFilePath:a})}),await f()},us=async()=>{if(c.size===0)return;const t=window.prompt("Zip file name (e.g., archive.zip)","archive.zip");if(!t)return;const s=ve(o,t);await p("/api/fs/bulk/zip",{method:"POST",body:JSON.stringify({sourcePaths:Array.from(c),zipFilePath:s})}),v(),await f()},Nt=async t=>{const s=o||we(t);await p("/api/fs/unzip",{method:"POST",body:JSON.stringify({zipFilePath:t,destinationPath:s})}),await f()},hs=t=>{t.preventDefault(),t.stopPropagation(),Qe||ae(!0)},xs=t=>{t.preventDefault(),t.stopPropagation(),ae(!0)},fs=t=>{t.preventDefault(),t.stopPropagation(),t.currentTarget===t.target&&ae(!1)},ps=async t=>{if(t.preventDefault(),t.stopPropagation(),ae(!1),!o){m("Select a folder before uploading files.","error");return}const s=Array.from(t.dataTransfer.files);if(s.length!==0)try{for(const a of s){const l=new FormData;l.append("path",Ne(o)),l.append("file",a,a.name),await Dt(l)}await f()}catch(a){m(`Upload failed: ${a instanceof Error?a.message:"Unknown error"}`,"error")}},pe=async t=>{if(Js(t)){Pe(t);return}Ge(t),ze(!0),ne("");try{const s=new URL("/api/fs/content",window.location.origin);s.searchParams.set("path",t);const a=await fetch(s.toString());if(a.ok){const l=await a.text();ne(l)}}catch(s){console.error("Failed to load file content:",s)}},gs=()=>{Ge(null),ze(!1),ne("")};n.useEffect(()=>{if(!E||!q)return;const t=setInterval(async()=>{try{const s=new URL("/api/fs/content",window.location.origin);s.searchParams.set("path",q);const a=await fetch(s.toString());if(a.ok){const l=await a.text();ne(l)}}catch(s){console.error("Failed to refresh tail content:",s)}},2e3);return()=>clearInterval(t)},[E,q]);const ys=n.useCallback(()=>{Ye(!0)},[]),Ue=n.useCallback(()=>{Ye(!1),localStorage.setItem("weasel.layout.leftPanelWidth",Fe.toString())},[Fe]),$e=n.useRef(null),Be=n.useCallback(t=>{if(!ie||!$e.current)return;const s=$e.current.getBoundingClientRect(),a=(t.clientX-s.left)/s.width*100;a>=20&&a<=70&&(Ht(a),localStorage.setItem("weasel.layout.leftPanelWidth",a.toString()))},[ie]);n.useEffect(()=>(ie&&(window.addEventListener("mousemove",Be),window.addEventListener("mouseup",Ue)),()=>{window.removeEventListener("mousemove",Be),window.removeEventListener("mouseup",Ue)}),[ie,Be,Ue]);const bs=n.useCallback(async t=>{if(!t.fullPath){m(d("files.addToAppMonitorNoPath",{name:t.name}),"error");return}try{const s=await p("/api/application-monitor/config");if(s.applications?.find(R=>R.executablePath?.toLowerCase()===t.fullPath.toLowerCase())){m(d("files.addToAppMonitorAlreadyExists",{name:t.name}),"error");return}const l=we(t.fullPath),h={id:$s(),name:t.name.replace(/\.[^/.]+$/,""),executablePath:t.fullPath,arguments:null,workingDirectory:l||null,enabled:!0,checkIntervalSeconds:60,restartDelaySeconds:5,logPath:null,eventLogSource:null},N={...s,applications:[...s.applications||[],h]};await p("/api/application-monitor/config",{method:"PUT",body:JSON.stringify(N)}),m(d("files.addToAppMonitorSuccess",{name:t.name}),"success")}catch(s){console.error("Failed to add file to Application Monitor:",s);const a=s instanceof Error?s.message:String(s);m(d("files.addToAppMonitorError",{name:t.name,message:a}),"error")}},[d]),Ct=(t,s)=>{t.preventDefault(),t.stopPropagation(),V({x:t.clientX,y:t.clientY,item:s})},St=n.useMemo(()=>Me.find(t=>o.startsWith(t.fullPath))?.fullPath||null,[o,Me]);return e.jsxs("section",{className:"space-y-4 relative",onDragOver:hs,onDragEnter:xs,onDragLeave:fs,onDrop:ps,children:[Qe&&o&&e.jsx("div",{className:"fixed inset-0 bg-sky-900/30 backdrop-blur-sm z-50 flex items-center justify-center pointer-events-none",children:e.jsxs("div",{className:"bg-slate-800 border-4 border-dashed border-sky-500 rounded-lg p-8 shadow-2xl",children:[e.jsx(Mt,{size:48,className:"mx-auto mb-4 text-sky-400"}),e.jsx("p",{className:"text-xl font-semibold text-white",children:"Drop files to upload"}),e.jsxs("p",{className:"text-sm text-slate-400 mt-2",children:["to ",o]})]})}),e.jsxs("div",{className:"submenu-container",children:[e.jsxs("button",{className:`submenu-tab ${St?"":"active"}`,onClick:()=>{g(i),v()},children:[e.jsx(ye,{size:16}),"Home"]}),Me.map(t=>e.jsxs("button",{className:`submenu-tab ${St===t.fullPath?"active":""}`,onClick:()=>{g(t.fullPath),v()},children:[e.jsx(ws,{size:16}),t.name]},t.fullPath))]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 bg-slate-900/50 p-2 rounded border border-slate-800 overflow-hidden",children:[e.jsxs("span",{className:"text-slate-500 flex-shrink-0",children:[d("common.path"),":"]}),e.jsxs("div",{className:"flex items-center gap-1 flex-1 min-w-0 overflow-hidden",children:[e.jsx("button",{className:"text-sm font-medium text-sky-400 hover:text-sky-300 hover:underline flex-shrink-0",onClick:()=>{g(i),v()},title:"Go to home folder",children:"Home"}),o&&o.split("\\").filter(Boolean).map((t,s,a)=>{const l=a.slice(0,s+1).join("\\")+"\\",h=s===a.length-1;return e.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0 min-w-0",children:[e.jsx("span",{className:"text-slate-500 flex-shrink-0",children:"/"}),e.jsx("button",{className:`text-sm font-medium truncate max-w-[150px] ${h?"text-white":"text-sky-400 hover:text-sky-300 hover:underline"}`,onClick:()=>{h||(g(l),v())},disabled:h,title:l,children:t})]},s)})]}),c.size>0&&e.jsxs("span",{className:"text-xs text-sky-400 flex-shrink-0 bg-sky-900/20 px-2 py-1 rounded",children:[c.size," ",d("files.selected")]})]}),e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",id:"file-search-input",name:"file-search",value:P,onChange:t=>Xe(t.target.value),placeholder:d("common.search"),className:"px-3 py-2 bg-slate-800 border border-slate-700 rounded text-sm w-64 focus:outline-none focus:border-sky-500 pl-9"}),e.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",children:e.jsx(Fs,{size:14})}),P&&e.jsx("button",{className:"absolute right-2 top-1/2 -translate-y-1/2 text-slate-400 hover:text-white",onClick:()=>Xe(""),title:"Clear search",children:e.jsx(U,{size:16})})]})}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[c.size>0&&e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("button",{className:"btn-outline",onClick:os,title:d("common.download"),children:e.jsx(be,{size:16})}),e.jsx("button",{className:"btn-outline",onClick:bt,title:d("common.delete"),children:e.jsx(ge,{size:16})}),e.jsx("button",{className:"btn-outline",onClick:us,title:d("common.zip"),children:e.jsx(It,{size:16})}),e.jsx("button",{className:"btn-outline",onClick:jt,title:d("common.copy"),children:e.jsx(Tt,{size:16})}),e.jsx("button",{className:"btn-outline",onClick:kt,title:d("common.cut"),children:e.jsx(Ut,{size:16})}),e.jsx("button",{className:"btn-outline",onClick:Re,title:d("common.selectAll"),children:e.jsx(je,{size:16})}),e.jsx("button",{className:"btn-outline",onClick:v,title:d("common.clearSelection"),children:e.jsx(U,{size:16})})]}),S&&e.jsx("button",{className:"btn-outline bg-sky-900/30 border-sky-500",onClick:wt,disabled:!o,title:d("common.paste"),children:e.jsx(Ms,{size:16})})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap justify-end",children:[e.jsx("div",{className:"relative",children:e.jsx("button",{className:`btn-outline ${fe?"bg-amber-900/30 border-amber-500":""}`,onClick:()=>{fe?vt(o):cs()},disabled:!o,title:fe?"Remove bookmark":"Add bookmark",children:fe?e.jsx($t,{size:16,className:"fill-amber-400 text-amber-400"}):e.jsx(Os,{size:16})})}),z.length>0&&e.jsxs("div",{className:"relative",children:[e.jsx("button",{className:"btn-outline",onClick:()=>Se(!se),title:"Show bookmarks",children:e.jsx($t,{size:16})}),se&&e.jsxs("div",{className:"absolute top-full right-0 mt-2 w-80 bg-slate-800 border border-slate-700 rounded shadow-lg z-50 max-h-96 overflow-y-auto",children:[e.jsx("div",{className:"p-3 border-b border-slate-700",children:e.jsx("h4",{className:"font-semibold text-sm",children:"Bookmarked Folders"})}),e.jsx("div",{className:"divide-y divide-slate-700",children:Array.isArray(z)&&z.map(t=>e.jsxs("div",{className:"flex items-center gap-2 p-3 hover:bg-slate-700/50",children:[e.jsxs("button",{className:"flex-1 text-left text-sm hover:text-sky-400 break-all",onClick:()=>ds(t),children:[e.jsx(ye,{size:14,className:"inline mr-2 text-amber-300"}),t||"Root"]}),e.jsx("button",{className:"icon-btn text-red-400 hover:text-red-300",onClick:()=>vt(t),title:"Remove bookmark",children:e.jsx(U,{size:14})})]},t))})]})]})]})]})]}),at&&e.jsxs("p",{className:"text-red-400 text-sm",children:["Failed to load items: ",String(at)]}),e.jsxs("div",{ref:$e,className:"flex flex-row gap-2",style:{height:"calc(100vh - 140px)",minHeight:"600px"},children:[e.jsxs("div",{className:"panel flex flex-col overflow-hidden",style:{width:`${Fe}%`,minWidth:"250px"},children:[e.jsxs("div",{className:"flex items-center justify-between mb-2 flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"panel-title mb-0",children:"Folders"}),e.jsx("button",{className:"icon-btn",onClick:()=>I(!0),title:"New Folder",children:e.jsx(Et,{size:16})}),e.jsx("button",{className:"icon-btn",onClick:f,title:"Refresh",children:e.jsx(Lt,{size:16})})]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-slate-400",children:[e.jsxs("button",{className:"hover:text-white flex items-center gap-1",onClick:()=>Z("name"),children:["Name ",j.key==="name"&&(j.direction==="asc"?e.jsx(Q,{size:12}):e.jsx(G,{size:12}))]}),e.jsxs("button",{className:"hover:text-white flex items-center gap-1",onClick:()=>Z("date"),children:["Date ",j.key==="date"&&(j.direction==="asc"?e.jsx(Q,{size:12}):e.jsx(G,{size:12}))]})]})]}),y.length>0&&e.jsx("div",{className:"flex items-center gap-3 px-2 py-1.5 border-b border-slate-700 bg-slate-800/30",children:e.jsxs("button",{className:"flex items-center gap-2 text-xs text-slate-400 hover:text-white transition-colors",onClick:()=>{K==="all"?ns():as()},title:K==="all"?"Deselect all folders":"Select all folders",children:[K==="none"&&e.jsx(zt,{size:14}),K==="partial"&&e.jsx(Ot,{size:14,className:"text-sky-400"}),K==="all"&&e.jsx(je,{size:14,className:"text-sky-400"}),e.jsx("span",{children:"Select all"})]})}),e.jsxs("div",{className:"divide-y divide-slate-800 overflow-y-auto flex-1 pr-2",children:[oe&&e.jsx("p",{className:"py-4 text-sm text-slate-400",children:"Loading…"}),!oe&&y.length===0&&e.jsx("p",{className:"py-4 text-sm text-slate-400",children:"No folders"}),Array.isArray(y)&&y.map(t=>e.jsxs("div",{className:`item-row hover:bg-slate-800/50 cursor-pointer ${c.has(t.fullPath)?"bg-slate-800/70":""}`,onClick:s=>{s.target.closest('input[type="checkbox"]')||s.target.closest("button")||ot(t)},onContextMenu:s=>Ct(s,t),children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[e.jsx("input",{type:"checkbox",checked:c.has(t.fullPath),onChange:s=>{s.stopPropagation(),pt(t)},className:"checkbox flex-shrink-0",onClick:s=>s.stopPropagation()}),e.jsx(ye,{size:18,className:"text-amber-300 flex-shrink-0"}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"font-medium truncate",children:t.name}),e.jsx("p",{className:"text-xs text-slate-400",children:Pt(t.modifiedAt)})]})]}),e.jsxs("div",{className:"flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{className:"icon-btn",onClick:s=>{s.stopPropagation(),Te(t)},title:"Rename",children:e.jsx(Ve,{size:14})}),e.jsx("button",{className:"icon-btn text-red-400 hover:text-red-300",onClick:s=>{s.stopPropagation(),Le(t)},title:"Delete",children:e.jsx(ge,{size:14})})]})]},t.fullPath))]}),e.jsx(Ft,{currentPage:De,totalItems:me.length,pageSize:J,onPageChange:et,onPageSizeChange:Kt})]}),e.jsx("div",{className:"w-2 cursor-col-resize bg-slate-900 hover:bg-sky-500/50 transition-colors flex items-center justify-center z-10 flex-shrink-0 rounded",onMouseDown:ys,children:e.jsx("div",{className:"h-8 w-1 bg-slate-600 rounded-full"})}),e.jsxs("div",{className:"panel flex-1 flex flex-col overflow-hidden",style:{minWidth:"400px"},children:[e.jsxs("div",{className:"flex items-center justify-between mb-2 flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"panel-title mb-0",children:d("files.files")}),e.jsx("button",{className:"icon-btn",onClick:()=>T(!0),title:"New File",children:e.jsx(Et,{size:16})}),e.jsx("button",{className:"icon-btn",onClick:()=>document.getElementById("file-upload-input")?.click(),title:"Upload",children:e.jsx(Mt,{size:16})}),e.jsx("button",{className:"icon-btn",onClick:f,title:"Refresh",children:e.jsx(Lt,{size:16})})]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-slate-400",children:[e.jsxs("button",{className:"hover:text-white flex items-center gap-1",onClick:()=>Z("name"),children:["Name ",j.key==="name"&&(j.direction==="asc"?e.jsx(Q,{size:12}):e.jsx(G,{size:12}))]}),e.jsxs("button",{className:"hover:text-white flex items-center gap-1",onClick:()=>Z("size"),children:["Size ",j.key==="size"&&(j.direction==="asc"?e.jsx(Q,{size:12}):e.jsx(G,{size:12}))]}),e.jsxs("button",{className:"hover:text-white flex items-center gap-1",onClick:()=>Z("date"),children:["Date ",j.key==="date"&&(j.direction==="asc"?e.jsx(Q,{size:12}):e.jsx(G,{size:12}))]})]})]}),b.length>0&&e.jsx("div",{className:"flex items-center gap-3 px-2 py-1.5 border-b border-slate-700 bg-slate-800/30",children:e.jsxs("button",{className:"flex items-center gap-2 text-xs text-slate-400 hover:text-white transition-colors",onClick:()=>{X==="all"?is():ls()},title:X==="all"?"Deselect all files":"Select all files",children:[X==="none"&&e.jsx(zt,{size:14}),X==="partial"&&e.jsx(Ot,{size:14,className:"text-sky-400"}),X==="all"&&e.jsx(je,{size:14,className:"text-sky-400"}),e.jsx("span",{children:"Select all"})]})}),e.jsxs("div",{className:"divide-y divide-slate-800 overflow-y-auto flex-1 pr-2",children:[oe&&e.jsx("p",{className:"py-4 text-sm text-slate-400",children:"Loading…"}),!oe&&b.length===0&&e.jsx("p",{className:"py-4 text-sm text-slate-400",children:"No files"}),Array.isArray(b)&&b.map(t=>{const s=ee(t.fullPath),a=t.name.toLowerCase().endsWith(".zip"),l=s==="image",h=Bt(t.fullPath),N=qt(t.fullPath),R=Ws(t.fullPath);return e.jsxs("div",{className:`item-row hover:bg-slate-800/50 cursor-default group ${c.has(t.fullPath)?"bg-slate-800/70":""}`,onContextMenu:x=>Ct(x,t),children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[e.jsx("input",{type:"checkbox",checked:c.has(t.fullPath),onChange:()=>pt(t),className:"checkbox flex-shrink-0",onClick:x=>x.stopPropagation()}),e.jsx("span",{className:`flex-shrink-0 ${R.color}`,children:R.icon}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"font-medium truncate",children:t.name}),e.jsxs("p",{className:"text-xs text-slate-400",children:[vs(t.sizeBytes)," – ",Pt(t.modifiedAt)]})]})]}),e.jsxs("div",{className:"flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{className:"icon-btn",onClick:x=>{x.stopPropagation(),Y(t.fullPath)},title:"Download",children:e.jsx(be,{size:14})}),a&&e.jsx("button",{className:"icon-btn",onClick:x=>{x.stopPropagation(),Nt(t.fullPath)},title:"Unzip",children:e.jsx(Je,{size:14})}),h&&e.jsx("button",{className:"icon-btn",onClick:x=>{x.stopPropagation(),rt(t)},title:"Edit",children:e.jsx(Rt,{size:14})}),l&&e.jsx("button",{className:"icon-btn",onClick:x=>{x.stopPropagation(),pe(t.fullPath)},title:"View",children:e.jsx(ke,{size:14})}),N&&!l&&e.jsx("button",{className:"icon-btn",onClick:x=>{x.stopPropagation(),pe(t.fullPath)},title:"Tail",children:e.jsx(ke,{size:14})}),e.jsx("button",{className:"icon-btn",onClick:x=>{x.stopPropagation(),Te(t)},title:"Rename",children:e.jsx(Ve,{size:14})}),e.jsx("button",{className:"icon-btn text-red-400 hover:text-red-300",onClick:x=>{x.stopPropagation(),Le(t)},title:"Delete",children:e.jsx(ge,{size:14})})]})]},t.fullPath)})]}),e.jsx(Ft,{currentPage:Ae,totalItems:ue.length,pageSize:W,onPageChange:tt,onPageSizeChange:Xt})]})]}),u&&e.jsx("div",{className:"modal-backdrop",children:e.jsxs("div",{className:"modal",children:[e.jsxs("div",{className:"modal-header",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-400 uppercase tracking-[0.2em]",children:"Editing"}),e.jsx("p",{className:"font-semibold text-white break-all",children:u})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"btn-outline",onClick:Oe,children:"Close"}),e.jsx("button",{className:"btn-primary",onClick:ss,disabled:We||Ze&&!_e,children:We?"Saving…":"Save"})]})]}),e.jsx("div",{className:"modal-body",children:Ze&&!_e?e.jsx("p",{className:"text-sm text-slate-400",children:"Loading content…"}):e.jsx(n.Suspense,{fallback:e.jsx("div",{className:"flex items-center justify-center h-[400px] bg-slate-900 rounded border border-slate-800",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-8 h-8 border-2 border-sky-500 border-t-transparent rounded-full animate-spin mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-slate-400",children:"Loading editor..."})]})}),children:e.jsx(Us,{height:"400px",theme:"vs-dark",language:Vs(u),value:w,onChange:t=>C(t??""),options:{minimap:{enabled:!1},fontSize:14,scrollBeyondLastLine:!1}})})})]})}),q&&e.jsx("div",{className:"modal-backdrop",children:e.jsxs("div",{className:"modal",children:[e.jsxs("div",{className:"modal-header",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-xs text-slate-400 uppercase tracking-[0.2em]",children:["Monitoring File ",E&&e.jsx("span",{className:"text-green-400 ml-2",children:"● Live"})]}),e.jsx("p",{className:"font-semibold text-white break-all",children:q})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:`btn-outline ${E?"bg-amber-900/30 border-amber-500":"bg-green-900/30 border-green-500"}`,onClick:()=>ze(!E),children:E?"Pause":"Resume"}),e.jsx("button",{className:"btn-outline",onClick:gs,children:"Close"})]})]}),e.jsxs("div",{className:"modal-body",children:[e.jsx("pre",{className:"text-sm font-mono whitespace-pre-wrap break-all bg-slate-900 p-4 rounded max-h-96 overflow-y-auto",children:Jt||"Loading..."}),e.jsx("p",{className:"text-xs text-slate-400 mt-2",children:"Auto-refreshing every 2 seconds"})]})]})}),L&&e.jsx("div",{className:"modal-backdrop",onClick:()=>Pe(null),children:e.jsxs("div",{className:"modal max-w-4xl",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-400 uppercase tracking-[0.2em]",children:"Image Viewer"}),e.jsx("p",{className:"font-semibold text-white break-all",children:L.split("\\").pop()})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{className:"btn-outline",onClick:()=>Y(L),children:[e.jsx(be,{size:16,className:"mr-1"}),"Download"]}),e.jsx("button",{className:"btn-outline",onClick:()=>Pe(null),children:"Close"})]})]}),e.jsxs("div",{className:"modal-body",children:[e.jsx("div",{className:"flex items-center justify-center bg-slate-900 rounded p-4",children:e.jsx("img",{src:`/api/fs/download?path=${encodeURIComponent(L)}`,alt:L.split("\\").pop(),className:"max-w-full max-h-[70vh] object-contain"})}),e.jsx("p",{className:"text-xs text-slate-400 mt-2 break-all",children:L})]})]})}),le&&(()=>{const t=le.item,s=t.isDirectory?null:ee(t.fullPath),a=!t.isDirectory&&Bt(t.fullPath),l=!t.isDirectory&&qt(t.fullPath),h=s==="image",N=t.name.toLowerCase().endsWith(".zip"),R=s==="executable";return e.jsx(Rs,{x:le.x,y:le.y,onClose:()=>V(null),items:[...y.length>0||b.length>0?[{label:d("common.selectAll"),icon:e.jsx(je,{size:14}),onClick:()=>{Re(),V(null)}}]:[],...t.isDirectory?[{label:"Open",icon:e.jsx(ye,{size:14}),onClick:()=>ot(t)}]:[],{label:"Download",icon:e.jsx(be,{size:14}),onClick:()=>gt(t)},{label:"Zip",icon:e.jsx(It,{size:14}),onClick:()=>ms(t)},...a?[{label:"Edit",icon:e.jsx(Rt,{size:14}),onClick:()=>rt(t)}]:[],...h?[{label:"View",icon:e.jsx(ke,{size:14}),onClick:()=>pe(t.fullPath)}]:[],...l&&!h?[{label:"Tail",icon:e.jsx(ke,{size:14}),onClick:()=>pe(t.fullPath)}]:[],...R?[{label:d("files.addToAppMonitor"),icon:e.jsx(Ns,{size:14}),onClick:()=>bs(t)}]:[],{label:"Copy",icon:e.jsx(Tt,{size:14}),onClick:()=>{B({items:[t.fullPath],operation:"copy"}),V(null)}},{label:"Cut",icon:e.jsx(Ut,{size:14}),onClick:()=>{B({items:[t.fullPath],operation:"cut"}),V(null)}},...N?[{label:"Unzip",icon:e.jsx(Je,{size:14}),onClick:()=>Nt(t.fullPath)}]:[],{label:"Rename",icon:e.jsx(Ve,{size:14}),onClick:()=>Te(t)},{label:"Delete",icon:e.jsx(ge,{size:14}),onClick:()=>Le(t),danger:!0}]})})(),e.jsx(Cs,{isOpen:F.isOpen,title:F.title,message:F.message,onConfirm:F.onConfirm,onCancel:()=>H({...F,isOpen:!1}),variant:F.variant}),Yt&&e.jsx("div",{className:"modal-backdrop",onClick:()=>I(!1),children:e.jsxs("div",{className:"modal",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Create Folder"}),e.jsx("button",{className:"icon-btn",onClick:()=>I(!1),children:e.jsx(U,{size:16})})]}),e.jsx("div",{className:"modal-body",children:e.jsx("input",{className:"input-text w-full",placeholder:"Folder name",value:he,onChange:t=>ct(t.target.value),onKeyDown:t=>{t.key==="Enter"?dt():t.key==="Escape"&&I(!1)},autoFocus:!0})}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx("button",{className:"btn-outline",onClick:()=>I(!1),children:"Cancel"}),e.jsx("button",{className:"btn-primary",onClick:dt,disabled:!he.trim(),children:"Create"})]})]})}),es&&e.jsx("div",{className:"modal-backdrop",onClick:()=>T(!1),children:e.jsxs("div",{className:"modal",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Create File"}),e.jsx("button",{className:"icon-btn",onClick:()=>T(!1),children:e.jsx(U,{size:16})})]}),e.jsx("div",{className:"modal-body",children:e.jsx("input",{className:"input-text w-full",placeholder:"File name (e.g. notes.txt)",value:xe,onChange:t=>mt(t.target.value),onKeyDown:t=>{t.key==="Enter"?ut():t.key==="Escape"&&T(!1)},autoFocus:!0})}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx("button",{className:"btn-outline",onClick:()=>T(!1),children:"Cancel"}),e.jsx("button",{className:"btn-primary",onClick:ut,disabled:!xe.trim(),children:"Create"})]})]})}),ts&&_&&e.jsx("div",{className:"modal-backdrop",onClick:()=>M(!1),children:e.jsxs("div",{className:"modal",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Rename"}),e.jsx("button",{className:"icon-btn",onClick:()=>M(!1),children:e.jsx(U,{size:16})})]}),e.jsx("div",{className:"modal-body",children:e.jsx("input",{className:"input-text w-full",value:O,onChange:t=>Ie(t.target.value),onKeyDown:t=>{t.key==="Enter"?ft():t.key==="Escape"&&M(!1)},autoFocus:!0})}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx("button",{className:"btn-outline",onClick:()=>M(!1),children:"Cancel"}),e.jsx("button",{className:"btn-primary",onClick:ft,disabled:!O.trim()||O===_.name,children:"Rename"})]})]})}),e.jsx("input",{id:"file-upload-input",type:"file",multiple:!0,className:"hidden",onChange:Gt}),e.jsx(Ps,{name:"Files",title:d("files.logTitle"),subfolder:"Files"})]})}export{sa as default};
