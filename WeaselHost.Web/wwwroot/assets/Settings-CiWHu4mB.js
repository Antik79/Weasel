import{c as L,r as g,s as c,a as F,u as y,b as h,m as O,j as e,S as Q,F as V,M as P,n as E,L as B,C as X,o as z,e as Y,g as Z,p as I}from"./index-B2pomQzr.js";import{S as T,F as S,T as N,a as W,b as D}from"./ToggleBar-CxV4FlJG.js";import{E as C}from"./eye-Becozmbq.js";import{S as ee}from"./send-CTf7Ha86.js";import"./vendor-terminal-Co9mG8Of.js";import"./vendor-utils-BeCPKUKe.js";import"./folder-BH67oCG7.js";import"./check-BUHp3h2-.js";/**
 * @license lucide-react v0.439.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=L("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.439.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=L("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.439.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=L("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);function k(a,x,m=500){const s=g.useRef();return g.useEffect(()=>()=>{s.current&&clearTimeout(s.current)},[]),g.useCallback(async(b,j=!0)=>{s.current&&clearTimeout(s.current),s.current=setTimeout(async()=>{try{await a(b),await x(),j&&c("Settings saved","success")}catch(o){const n=o instanceof Error?o.message:String(o);c(`Failed to save: ${n}`,"error"),console.error("Debounced save failed:",o)}},m)},[a,x,m])}const se=()=>h("/api/settings/capture"),te=()=>h("/api/settings/security"),ae=()=>h("/api/settings/mail"),ne=()=>h("/api/system/startup"),ie=()=>h("/api/system/admin/status");function ye(){const{t:a,language:x,setLanguage:m}=F(),[s,l]=g.useState("general");g.useEffect(()=>{const p=()=>{const f=window.location.hash.slice(1);if(!f)return;const $=f.split("/").filter(Boolean);if($[0]==="settings"&&$[1]){const A=$[1];["general","security","mail","logging","screenshots","files","vnc"].includes(A)&&l(A)}};return p(),window.addEventListener("hashchange",p),()=>window.removeEventListener("hashchange",p)},[]),g.useEffect(()=>{const f=window.location.hash.slice(1).split("/").filter(Boolean);f[0]==="settings"&&f[1]!==s&&(window.location.hash=`/settings/${s}`)},[s]);const{data:b,mutate:j}=y("startup-status",ne),{data:o,mutate:n}=y("admin-status",ie),{data:t,mutate:d}=y("ui-preferences",O),{data:r,mutate:i}=y("security-settings",te),[u,v]=g.useState({requireAuthentication:!1,password:"",confirmPassword:""}),[M,U]=g.useState(!1),[w,R]=g.useState({isOpen:!1,title:"",message:"",onConfirm:()=>{},variant:"info"});g.useEffect(()=>{r&&v(p=>({...p,requireAuthentication:r.requireAuthentication}))},[r]);const G=async p=>{try{await h("/api/system/startup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({enabled:p})}),await j(),c(a("common.success"),"success")}catch(f){c(`${a("common.error")}: ${f instanceof Error?f.message:String(f)}`,"error")}},_=async()=>{R({isOpen:!0,title:"Restart as Administrator",message:a("system.restartAdmin")+"?",onConfirm:async()=>{try{await h("/api/system/admin/restart",{method:"POST"}),c("Restarting as administrator...","success")}catch(p){c(`${a("common.error")}: ${p instanceof Error?p.message:String(p)}`,"error")}finally{R({...w,isOpen:!1})}},variant:"warning"})},K=async()=>{if(u.password!==u.confirmPassword){c("Passwords do not match","error");return}U(!0);try{await h("/api/settings/security",{method:"PUT",body:JSON.stringify({requireAuthentication:u.requireAuthentication,password:u.password||null})}),v(p=>({...p,password:"",confirmPassword:""})),await i(),c(a("common.success"),"success")}catch(p){c(`${a("common.error")}: ${p instanceof Error?p.message:String(p)}`,"error")}finally{U(!1)}};return e.jsxs("section",{className:"space-y-4",children:[e.jsxs("div",{className:"submenu-container",children:[e.jsxs("button",{onClick:()=>l("general"),className:`submenu-tab ${s==="general"?"active":""}`,children:[e.jsx(Q,{size:16}),a("settings.general")]}),e.jsxs("button",{onClick:()=>l("security"),className:`submenu-tab ${s==="security"?"active":""}`,children:[e.jsx(T,{size:16}),a("settings.security")]}),e.jsxs("button",{onClick:()=>l("mail"),className:`submenu-tab ${s==="mail"?"active":""}`,children:[e.jsx(H,{size:16}),a("settings.mail")]}),e.jsxs("button",{onClick:()=>l("logging"),className:`submenu-tab ${s==="logging"?"active":""}`,children:[e.jsx(V,{size:16}),"Logging"]}),e.jsxs("button",{onClick:()=>l("screenshots"),className:`submenu-tab ${s==="screenshots"?"active":""}`,children:[e.jsx(S,{size:16}),"Screenshots"]}),e.jsxs("button",{onClick:()=>l("files"),className:`submenu-tab ${s==="files"?"active":""}`,children:[e.jsx(S,{size:16}),"Files"]}),e.jsxs("button",{onClick:()=>l("vnc"),className:`submenu-tab ${s==="vnc"?"active":""}`,children:[e.jsx(P,{size:16}),"VNC"]})]}),s==="general"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"panel",children:[e.jsxs("h3",{className:"panel-title flex items-center gap-2",children:[e.jsx(P,{size:18})," Application"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-1",children:a("settings.language")}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(q,{size:16,className:"text-slate-500"}),e.jsxs("select",{className:"input-text",value:x,onChange:p=>m(p.target.value),children:[e.jsx("option",{value:"en",children:"English"}),e.jsx("option",{value:"de",children:"Deutsch"}),e.jsx("option",{value:"fr",children:"FranÃ§ais"}),e.jsx("option",{value:"nl",children:"Nederlands"})]})]})]})}),e.jsxs("div",{className:"space-y-3 pt-2",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-900/50 rounded-lg border border-slate-800",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(T,{size:18,className:o?.isAdministrator?"text-green-400":"text-amber-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-white",children:a("settings.runAsAdmin")}),e.jsx("p",{className:"text-xs text-slate-400",children:o?.isAdministrator?a("system.admin"):a("system.standard")})]})]}),!o?.isAdministrator&&e.jsx("button",{className:"btn-outline text-xs",onClick:_,children:a("system.restartAdmin")})]}),e.jsx(N,{label:a("settings.startWithWindows"),description:"Launch Weasel automatically at Windows startup",enabled:b?.enabled||!1,onChange:G,icon:e.jsx(P,{size:18}),iconColorEnabled:"text-green-400",iconColorDisabled:"text-slate-500"})]})]})]}),e.jsxs("div",{className:"panel",children:[e.jsxs("h3",{className:"panel-title flex items-center gap-2",children:[e.jsx(C,{size:18})," User Interface Preferences"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(N,{label:"Expand log panels by default",description:"New log panels will open expanded",enabled:t?.logPanelExpanded?.default??!1,onChange:async p=>{try{const f={...t,logPanelExpanded:{...t?.logPanelExpanded,default:p}};await E(f),d(),c("Preference saved successfully","success")}catch(f){c(`Failed to save: ${f instanceof Error?f.message:String(f)}`,"error")}},icon:e.jsx(C,{size:18})}),e.jsxs("div",{className:"pt-4 border-t border-slate-800",children:[e.jsx("h4",{className:"text-sm font-semibold text-white mb-3",children:"Pagination Defaults"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-1",children:"Default items per page (text data)"}),e.jsxs("select",{className:"input-text",value:t?.defaultTextPageSize??50,onChange:async p=>{try{const f={...t,defaultTextPageSize:parseInt(p.target.value)};await E(f),d(),c("Preference saved successfully","success")}catch(f){c(`Failed to save: ${f instanceof Error?f.message:String(f)}`,"error")}},children:[e.jsx("option",{value:"25",children:"25"}),e.jsx("option",{value:"50",children:"50"}),e.jsx("option",{value:"100",children:"100"})]}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Default page size for lists, tables, and text-based data"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-1",children:"Default items per page (images)"}),e.jsxs("select",{className:"input-text",value:t?.defaultImagePageSize??25,onChange:async p=>{try{const f={...t,defaultImagePageSize:parseInt(p.target.value)};await E(f),d(),c("Preference saved successfully","success")}catch(f){c(`Failed to save: ${f instanceof Error?f.message:String(f)}`,"error")}},children:[e.jsx("option",{value:"25",children:"25"}),e.jsx("option",{value:"50",children:"50"}),e.jsx("option",{value:"100",children:"100"})]}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Default page size for image grids and thumbnails"})]})]})]})]})]})]}),s==="security"&&e.jsxs("div",{className:"panel",children:[e.jsxs("h3",{className:"panel-title flex items-center gap-2",children:[e.jsx(B,{size:18})," ",a("settings.authentication")]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(N,{label:a("settings.requireAuth"),description:"Protect web console access",enabled:u.requireAuthentication,onChange:async p=>{try{await h("/api/settings/security",{method:"PUT",body:JSON.stringify({requireAuthentication:p,password:null})}),v({...u,requireAuthentication:p}),await i(),c(a("common.success"),"success")}catch(f){c(`${a("common.error")}: ${f instanceof Error?f.message:String(f)}`,"error")}},icon:e.jsx(T,{size:18})}),e.jsxs("div",{className:"space-y-3 pt-2 border-t border-slate-800",children:[e.jsx("p",{className:"text-sm font-medium text-slate-300",children:a("settings.changePassword")}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"New Password"}),e.jsx("input",{type:"password",className:"input-text",value:u.password,onChange:p=>v({...u,password:p.target.value}),placeholder:"Leave empty to keep current"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Confirm Password"}),e.jsx("input",{type:"password",className:"input-text",value:u.confirmPassword,onChange:p=>v({...u,confirmPassword:p.target.value}),placeholder:"Confirm new password"})]})]}),e.jsxs("button",{className:"btn-primary",onClick:K,disabled:M||!u.password||u.password!==u.confirmPassword,children:[e.jsx(W,{size:16})," ",a(M?"common.loading":"settings.changePassword")]})]})]})]}),s==="mail"&&e.jsx(re,{}),s==="logging"&&e.jsx(oe,{}),s==="screenshots"&&e.jsx(le,{}),s==="files"&&e.jsx(ce,{}),s==="vnc"&&e.jsx(de,{}),e.jsx(X,{isOpen:w.isOpen,title:w.title,message:w.message,onConfirm:w.onConfirm,onCancel:()=>R(p=>({...p,isOpen:!1})),variant:w.variant})]})}function re(){const{t:a}=F(),{data:x,mutate:m}=y("smtp-settings",ae),[s,l]=g.useState({host:"smtp.gmail.com",port:587,enableSsl:!0,username:"",password:"",fromAddress:"",fromName:"Weasel Disk Monitor",testRecipient:""}),[b,j]=g.useState(!1),[o,n]=g.useState("");g.useEffect(()=>{x&&(l(x),x.testRecipient&&n(x.testRecipient))},[x]);const t=k(async r=>{await h("/api/settings/mail",{method:"PUT",body:JSON.stringify({...r,testRecipient:o})})},m,500),d=async()=>{if(!o){c("Please enter a recipient email address","error");return}j(!0);try{await h("/api/settings/mail/test",{method:"POST",body:JSON.stringify({recipient:o})}),c("Test email sent successfully","success")}catch(r){const i=r instanceof Error?r.message:String(r);c(`Failed to send test email: ${i}`,"error")}finally{j(!1)}};return e.jsxs("div",{className:"panel",children:[e.jsxs("h3",{className:"panel-title flex items-center gap-2",children:[e.jsx(H,{size:18})," ",a("settings.smtpSettings")]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm text-slate-300",children:a("settings.host")}),e.jsx("input",{className:"input-text",value:s.host,onChange:r=>{const i={...s,host:r.target.value};l(i),t(i,!1)}})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm text-slate-300",children:a("settings.port")}),e.jsx("input",{type:"number",className:"input-text",value:s.port,onChange:r=>{const i={...s,port:Number(r.target.value)};l(i),t(i,!1)}})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm text-slate-300",children:a("settings.username")}),e.jsx("input",{className:"input-text",value:s.username||"",onChange:r=>{const i={...s,username:r.target.value};l(i),t(i,!1)}})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm text-slate-300",children:a("settings.password")}),e.jsx("input",{type:"password",className:"input-text",value:s.password||"",onChange:r=>{const i={...s,password:r.target.value};l(i),t(i,!1)}})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm text-slate-300",children:a("settings.senderEmail")}),e.jsx("input",{className:"input-text",value:s.fromAddress||"",onChange:r=>{const i={...s,fromAddress:r.target.value};l(i),t(i,!1)}})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm text-slate-300",children:a("settings.senderName")}),e.jsx("input",{className:"input-text",value:s.fromName||"",onChange:r=>{const i={...s,fromName:r.target.value};l(i),t(i,!1)}})]})]}),e.jsx("div",{className:"pt-2",children:e.jsx(N,{label:a("settings.useSsl"),description:"Use SSL/TLS encryption",enabled:s.enableSsl,onChange:async r=>{try{const i={...s,enableSsl:r};l(i),await h("/api/settings/mail",{method:"PUT",body:JSON.stringify({...i,testRecipient:o})}),await m(),c(a("common.success"),"success")}catch(i){c(`${a("common.error")}: ${i instanceof Error?i.message:String(i)}`,"error")}},icon:e.jsx(B,{size:18})})}),e.jsxs("div",{className:"pt-4 border-t border-slate-800",children:[e.jsx("h4",{className:"text-sm font-medium text-white mb-3",children:a("settings.sendTestEmail")}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{className:"input-text flex-1",placeholder:a("settings.recipient"),value:o,onChange:r=>n(r.target.value)}),e.jsxs("button",{className:"btn-outline",onClick:d,disabled:b,children:[e.jsx(ee,{size:16})," ",a(b?"common.loading":"settings.sendTestEmail")]})]})]})]})]})}function le(){F();const{data:a,mutate:x}=y("capture-settings",se),{data:m,mutate:s}=y("ui-preferences",O),[l,b]=g.useState({folder:"",timedFolder:"",filenamePattern:"",enableIntervalCapture:!1,intervalSeconds:60}),[j,o]=g.useState(!1),[n,t]=g.useState(!1);g.useEffect(()=>{a&&b({folder:a.folder||"",timedFolder:a.timedFolder||"",filenamePattern:a.filenamePattern||"",enableIntervalCapture:!1,intervalSeconds:60})},[a]);const d=k(async r=>{await h("/api/settings/capture",{method:"PUT",body:JSON.stringify({folder:r.folder,timedFolder:r.timedFolder,filenamePattern:r.filenamePattern,enableIntervalCapture:a?.enableIntervalCapture||!1,intervalSeconds:a?.intervalSeconds||60})})},x,500);return e.jsxs("div",{className:"panel",children:[e.jsxs("h3",{className:"panel-title flex items-center gap-2",children:[e.jsx(S,{size:18})," Screenshots"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-1",children:"Screenshot Folder"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{className:"input-text flex-1",value:z(l.folder),onChange:r=>{const i=r.target.value.replace(/\\\\/g,"\\"),u={...l,folder:i};b(u),d(u,!1)}}),e.jsx("button",{className:"btn-outline",type:"button",onClick:()=>o(!0),children:e.jsx(S,{size:16})})]}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Default location for manual screenshots"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-1",children:"Timed Screenshot Folder"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{className:"input-text flex-1",value:z(l.timedFolder||""),onChange:r=>{const i=r.target.value.replace(/\\\\/g,"\\"),u={...l,timedFolder:i};b(u),d(u,!1)}}),e.jsx("button",{className:"btn-outline",type:"button",onClick:()=>t(!0),children:e.jsx(S,{size:16})})]}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Location for automatic interval screenshots"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-1",children:"Filename Pattern"}),e.jsx("input",{className:"input-text",value:l.filenamePattern,onChange:r=>{const i={...l,filenamePattern:r.target.value};b(i),d(i,!1)},placeholder:"screenshot_{timestamp}.png"}),e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Use ","{timestamp}"," for date/time, ","{display}"," for display number"]})]}),e.jsx("div",{className:"pt-2 border-t border-slate-800",children:e.jsx(N,{label:"Expand log panel by default",description:"Screenshot capture logs",enabled:m?.logPanelExpanded?.Screenshots??!1,onChange:async r=>{try{const i={...m,logPanelExpanded:{...m?.logPanelExpanded,Screenshots:r}};await E(i),await s(),c("Preference saved successfully","success")}catch(i){c(`Failed to save: ${i instanceof Error?i.message:String(i)}`,"error")}},icon:e.jsx(C,{size:18})})}),j&&e.jsx(D,{initialPath:l.folder,onSelect:async r=>{const i=r.replace(/\\\\/g,"\\"),u={...l,folder:i};b(u),o(!1);try{await h("/api/settings/capture",{method:"PUT",body:JSON.stringify({folder:i,timedFolder:l.timedFolder,filenamePattern:l.filenamePattern,enableIntervalCapture:a?.enableIntervalCapture||!1,intervalSeconds:a?.intervalSeconds||60})}),await x(),c("Folder saved successfully","success")}catch(v){c(`Failed to save: ${v instanceof Error?v.message:String(v)}`,"error")}},onCancel:()=>o(!1)}),n&&e.jsx(D,{initialPath:l.timedFolder||"",onSelect:async r=>{const i=r.replace(/\\\\/g,"\\"),u={...l,timedFolder:i};b(u),t(!1);try{await h("/api/settings/capture",{method:"PUT",body:JSON.stringify({folder:l.folder,timedFolder:i,filenamePattern:l.filenamePattern,enableIntervalCapture:a?.enableIntervalCapture||!1,intervalSeconds:a?.intervalSeconds||60})}),await x(),c("Folder saved successfully","success")}catch(v){c(`Failed to save: ${v instanceof Error?v.message:String(v)}`,"error")}},onCancel:()=>t(!1)})]})]})}function oe(){const a=()=>h("/api/settings/logging"),{data:x,mutate:m}=y("logging-settings",a),[s,l]=g.useState({folder:"",retentionDays:14,minimumLevel:"Information",maxFileSizeBytes:10*1024*1024,maxFilesPerDay:5,enableSizeRotation:!0,componentEnabled:{VNC:!0,DiskMonitor:!0,ApplicationMonitor:!0,Screenshots:!0,General:!0},componentLevels:{}}),[b,j]=g.useState(!1);g.useEffect(()=>{x&&l({...x,componentEnabled:x.componentEnabled||{VNC:!0,DiskMonitor:!0,ApplicationMonitor:!0,Screenshots:!0,General:!0},componentLevels:x.componentLevels||{}})},[x]);const o=k(async n=>{await h("/api/settings/logging",{method:"PUT",body:JSON.stringify(n)})},m,500);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"panel",children:[e.jsxs("h3",{className:"panel-title flex items-center gap-2",children:[e.jsx(V,{size:18})," Log File Rotation"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-1",children:"Log Folder"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{className:"input-text flex-1",value:z(s.folder),onChange:n=>{const t=n.target.value.replace(/\\\\/g,"\\"),d={...s,folder:t};l(d),o(d,!1)}}),e.jsx("button",{className:"btn-outline",type:"button",onClick:()=>j(!0),children:e.jsx(S,{size:16})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-1",children:"Retention Days"}),e.jsx("input",{type:"number",className:"input-text",min:"0",value:s.retentionDays,onChange:n=>{const t={...s,retentionDays:parseInt(n.target.value)||0};l(t),o(t,!1)}}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"How many days to keep log files (0 = keep forever)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-1",children:"Minimum Log Level"}),e.jsxs("select",{className:"input-text",value:s.minimumLevel,onChange:async n=>{const t={...s,minimumLevel:n.target.value};l(t);try{await h("/api/settings/logging",{method:"PUT",body:JSON.stringify(t)}),await m(),c("Log level saved successfully","success")}catch(d){c(`Failed to save: ${d instanceof Error?d.message:String(d)}`,"error")}},children:[e.jsx("option",{value:"Trace",children:"Trace"}),e.jsx("option",{value:"Debug",children:"Debug"}),e.jsx("option",{value:"Information",children:"Information"}),e.jsx("option",{value:"Warning",children:"Warning"}),e.jsx("option",{value:"Error",children:"Error"}),e.jsx("option",{value:"Critical",children:"Critical"}),e.jsx("option",{value:"None",children:"None"})]})]})]}),e.jsxs("div",{className:"pt-2 border-t border-slate-800",children:[e.jsx(N,{label:"Enable size-based rotation",description:"Rotate log files when they reach a certain size",enabled:s.enableSizeRotation,onChange:async n=>{try{const t={...s,enableSizeRotation:n};l(t),await h("/api/settings/logging",{method:"PUT",body:JSON.stringify(t)}),await m(),c("Settings saved successfully","success")}catch(t){c(`Failed to save: ${t instanceof Error?t.message:String(t)}`,"error")}}}),s.enableSizeRotation&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4 pl-6 border-l-2 border-slate-800",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-1",children:"Max File Size (MB)"}),e.jsx("input",{type:"number",className:"input-text",min:"1",step:"1",value:Math.round(s.maxFileSizeBytes/(1024*1024)),onChange:n=>{const t=parseInt(n.target.value)||1,d={...s,maxFileSizeBytes:t*1024*1024};l(d),o(d,!1)}}),e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Current: ",Y(s.maxFileSizeBytes)]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-1",children:"Max Files Per Day"}),e.jsx("input",{type:"number",className:"input-text",min:"0",value:s.maxFilesPerDay,onChange:n=>{const t={...s,maxFilesPerDay:parseInt(n.target.value)||0};l(t),o(t,!1)}}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Maximum rotated files to keep per day (0 = unlimited)"})]})]})]})]})]}),e.jsxs("div",{className:"panel",children:[e.jsxs("h3",{className:"panel-title flex items-center gap-2",children:[e.jsx(P,{size:18})," Component Logging"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-slate-400",children:"Enable or disable logging for specific components. Each component writes to its own log file in a subfolder."}),e.jsx("div",{className:"space-y-3",children:["VNC","DiskMonitor","ApplicationMonitor","Screenshots","Files","General"].map(n=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-900/50 rounded border border-slate-800",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-300 cursor-pointer",htmlFor:`component-${n}`,children:n}),e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:[n==="VNC"&&"VNC server and connection logs",n==="DiskMonitor"&&"Disk and folder monitoring logs",n==="ApplicationMonitor"&&"Application monitoring and restart logs",n==="Screenshots"&&"Screenshot capture and interval logs",n==="Files"&&"File Explorer operations and navigation logs",n==="General"&&"General application logs"]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("select",{className:"input-text text-xs py-1 w-24",value:s.componentLevels?.[n]||s.minimumLevel,onChange:async t=>{const d={...s,componentLevels:{...s.componentLevels,[n]:t.target.value}};l(d);try{await h("/api/settings/logging",{method:"PUT",body:JSON.stringify(d)}),await m()}catch(r){console.error("Failed to save component level:",r)}},onClick:t=>t.stopPropagation(),children:[e.jsx("option",{value:"Trace",children:"Trace"}),e.jsx("option",{value:"Debug",children:"Debug"}),e.jsx("option",{value:"Information",children:"Info"}),e.jsx("option",{value:"Warning",children:"Warn"}),e.jsx("option",{value:"Error",children:"Error"}),e.jsx("option",{value:"Critical",children:"Critical"}),e.jsx("option",{value:"None",children:"None"})]}),e.jsx("input",{type:"checkbox",id:`component-${n}`,className:"checkbox",checked:s.componentEnabled?.[n]??!0,onChange:async t=>{const d={...s,componentEnabled:{...s.componentEnabled,[n]:t.target.checked}};l(d);try{await h("/api/settings/logging",{method:"PUT",body:JSON.stringify(d)}),await m()}catch(r){console.error("Failed to save component enabled state:",r)}}})]})]},n))})]})]}),b&&e.jsx(D,{initialPath:s.folder,onSelect:n=>{const t=n.replace(/\\\\/g,"\\");l({...s,folder:t}),j(!1)},onCancel:()=>j(!1)})]})}function ce(){F();const[a,x]=g.useState(!1),{data:m,mutate:s}=y("file-explorer-settings",Z),{data:l,mutate:b}=y("ui-preferences",O),[j,o]=g.useState({homeFolder:""});g.useEffect(()=>{m&&o(m)},[m]);const n=k(async t=>{await I(t)},s,500);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"panel",children:[e.jsxs("h3",{className:"panel-title flex items-center gap-2",children:[e.jsx(S,{size:18})," File Explorer Configuration"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-1",children:"Home Folder"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{className:"input-text flex-1",value:z(j.homeFolder),onChange:t=>{const d=t.target.value.replace(/\\\\/g,"\\"),r={...j,homeFolder:d};o(r),n(r,!1)}}),e.jsx("button",{className:"btn-outline",type:"button",onClick:()=>x(!0),children:e.jsx(S,{size:16})})]}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Default starting location for File Explorer"})]}),a&&e.jsx(D,{initialPath:j.homeFolder,onSelect:async t=>{const d=t.replace(/\\\\/g,"\\"),r={...j,homeFolder:d};o(r),x(!1);try{await I(r),await s(),c("Home folder saved successfully","success")}catch(i){c(`Failed to save: ${i instanceof Error?i.message:String(i)}`,"error")}},onCancel:()=>x(!1)})]})]}),e.jsxs("div",{className:"panel",children:[e.jsxs("h3",{className:"panel-title flex items-center gap-2",children:[e.jsx(C,{size:18})," Display Preferences"]}),e.jsx("div",{className:"space-y-4",children:e.jsx(N,{label:"Expand log panel by default",description:"File Explorer operation logs",enabled:l?.logPanelExpanded?.Files??!1,onChange:async t=>{try{const d={...l,logPanelExpanded:{...l?.logPanelExpanded,Files:t}};await E(d),await b(),c("Preference saved successfully","success")}catch(d){c(`Failed to save: ${d instanceof Error?d.message:String(d)}`,"error")}},icon:e.jsx(C,{size:18})})})]})]})}function de(){const{t:a}=F(),[x,m]=g.useState(!1),[s,l]=g.useState(!1),[b,j]=g.useState(""),{data:o,mutate:n}=y("vnc-config",()=>h("/api/vnc/config")),[t,d]=g.useState({enabled:!1,port:5900,allowRemote:!1,hasPassword:!1,autoStart:!1});g.useEffect(()=>{o&&d(o)},[o]);const r=k(async u=>{await h("/api/vnc/config",{method:"PUT",body:JSON.stringify({enabled:!0,port:u.port,allowRemote:u.allowRemote,autoStart:u.autoStart,password:void 0})})},n,500),i=async()=>{if(!b){c("Please enter a password","error");return}m(!0);try{await h("/api/vnc/config",{method:"PUT",body:JSON.stringify({enabled:!0,port:t.port,allowRemote:t.allowRemote,autoStart:t.autoStart,password:b})}),await n(),j(""),c(a("settings.remoteDesktop.saveSuccess"),"success")}catch(u){c(a("settings.remoteDesktop.saveFailure",{message:u instanceof Error?u.message:String(u)}),"error")}finally{m(!1)}};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"panel space-y-4",children:[e.jsxs("h3",{className:"panel-title flex items-center gap-2",children:[e.jsx(P,{size:18})," ",a("settings.remoteDesktop.title")]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"vnc-port",className:"block text-sm text-slate-400 mb-1",children:a("settings.remoteDesktop.port")}),e.jsx("input",{type:"number",id:"vnc-port",min:1024,max:65535,className:"input-text w-32",value:t.port,onChange:u=>{const v={...t,port:parseInt(u.target.value)||5900};d(v),r(v,!1)}})]}),e.jsx(N,{label:"Start automatically",description:"Start VNC server when application launches",enabled:t.autoStart??!1,onChange:async u=>{try{const v={...t,autoStart:u};d(v),await h("/api/vnc/config",{method:"PUT",body:JSON.stringify({enabled:!0,port:t.port,allowRemote:t.allowRemote,autoStart:u,password:void 0})}),await n(),c(a("common.success"),"success")}catch(v){c(`${a("common.error")}: ${v instanceof Error?v.message:String(v)}`,"error")}},icon:e.jsx(P,{size:18})}),e.jsx(N,{label:a("settings.remoteDesktop.allowRemote"),description:"Allow connections from other machines",enabled:t.allowRemote,onChange:async u=>{try{const v={...t,allowRemote:u};d(v),await h("/api/vnc/config",{method:"PUT",body:JSON.stringify({enabled:!0,port:t.port,allowRemote:u,autoStart:t.autoStart,password:void 0})}),await n(),c(a("common.success"),"success")}catch(v){c(`${a("common.error")}: ${v instanceof Error?v.message:String(v)}`,"error")}},icon:e.jsx(q,{size:18})}),t.allowRemote&&e.jsx("div",{className:"bg-amber-900/20 border border-amber-500/50 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(T,{size:16,className:"text-amber-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-amber-200",children:[e.jsx("p",{className:"font-semibold mb-1",children:a("settings.remoteDesktop.securityWarning")}),e.jsx("p",{children:a("settings.remoteDesktop.securityWarningText")})]})]})}),e.jsxs("div",{className:"pt-2 border-t border-slate-800",children:[e.jsx("label",{htmlFor:"vnc-password",className:"block text-sm text-slate-400 mb-2",children:a("settings.remoteDesktop.password")}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:s?"text":"password",id:"vnc-password",className:"input-text flex-1",placeholder:t.hasPassword?a("settings.remoteDesktop.passwordPlaceholder"):a("settings.remoteDesktop.passwordEmpty"),value:b,onChange:u=>j(u.target.value)}),e.jsx("button",{className:"btn-outline",onClick:()=>l(!s),title:a(s?"settings.remoteDesktop.hidePassword":"settings.remoteDesktop.showPassword"),children:e.jsx(C,{size:16})}),e.jsxs("button",{className:"btn-primary",onClick:i,disabled:x||!b,children:[e.jsx(W,{size:16})," ",x?"Saving...":"Set Password"]})]}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:a("settings.remoteDesktop.passwordHint")})]})]})]}),e.jsx(me,{})]})}function me(){F();const{data:a,mutate:x}=y("vnc-recording-config",()=>h("/api/vnc/recordings/config")),[m,s]=g.useState({rootFolder:"",maxRecordingDurationMinutes:120,retentionDays:30,enableMotionDetection:!1,motionDetectionThresholdPercent:10,motionDetectionBlockSize:32,recordingFps:5,useProfileSubfolders:!0}),[l,b]=g.useState(!1);g.useEffect(()=>{a&&s(a)},[a]);const j=k(async o=>{await h("/api/vnc/recordings/config",{method:"PUT",body:JSON.stringify(o)})},x,500);return e.jsxs("div",{className:"panel space-y-4",children:[e.jsxs("h3",{className:"panel-title flex items-center gap-2",children:[e.jsx(J,{size:18})," VNC Recording"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"recording-folder",className:"block text-sm text-slate-400 mb-1",children:"Recordings Folder"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{className:"input-text flex-1",value:z(m.rootFolder),onChange:o=>{const n=o.target.value.replace(/\\\\/g,"\\"),t={...m,rootFolder:n};s(t),j(t,!1)}}),e.jsx("button",{className:"btn-outline",type:"button",onClick:()=>b(!0),children:e.jsx(S,{size:16})})]}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Default location for VNC session recordings"})]}),e.jsx(N,{label:"Use profile-specific subfolders",description:"Organize recordings by VNC profile",enabled:m.useProfileSubfolders,onChange:async o=>{try{const n={...m,useProfileSubfolders:o};s(n),await h("/api/vnc/recordings/config",{method:"PUT",body:JSON.stringify(n)}),await x(),c("Settings saved successfully","success")}catch(n){c(`Failed to save: ${n instanceof Error?n.message:String(n)}`,"error")}},icon:e.jsx(S,{size:18})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"max-duration",className:"block text-sm text-slate-400 mb-1",children:"Max Recording Duration (minutes)"}),e.jsx("input",{type:"number",id:"max-duration",min:1,max:480,className:"input-text w-full",value:m.maxRecordingDurationMinutes,onChange:o=>{const n={...m,maxRecordingDurationMinutes:parseInt(o.target.value)||120};s(n),j(n,!1)}})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"retention-days",className:"block text-sm text-slate-400 mb-1",children:"Retention Period (days)"}),e.jsx("input",{type:"number",id:"retention-days",min:1,max:365,className:"input-text w-full",value:m.retentionDays,onChange:o=>{const n={...m,retentionDays:parseInt(o.target.value)||30};s(n),j(n,!1)}})]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"recording-fps",className:"block text-sm text-slate-400 mb-1",children:["Recording FPS: ",m.recordingFps]}),e.jsx("input",{type:"range",id:"recording-fps",min:1,max:30,className:"w-full",value:m.recordingFps,onChange:o=>{const n={...m,recordingFps:parseInt(o.target.value)};s(n),j(n,!1)}}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Lower FPS reduces file size but may result in choppy playback"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(N,{label:"Enable Motion Detection",description:"Only record when screen changes are detected",enabled:m.enableMotionDetection,onChange:async o=>{try{const n={...m,enableMotionDetection:o};s(n),await h("/api/vnc/recordings/config",{method:"PUT",body:JSON.stringify(n)}),await x(),c("Settings saved successfully","success")}catch(n){c(`Failed to save: ${n instanceof Error?n.message:String(n)}`,"error")}},icon:e.jsx(J,{size:18})}),m.enableMotionDetection&&e.jsxs("div",{className:"ml-6 space-y-3 border-l-2 border-blue-500/30 pl-4",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"motion-threshold",className:"block text-sm text-slate-400 mb-1",children:["Motion Sensitivity: ",m.motionDetectionThresholdPercent,"%"]}),e.jsx("input",{type:"range",id:"motion-threshold",min:1,max:50,className:"w-full",value:m.motionDetectionThresholdPercent,onChange:o=>{const n={...m,motionDetectionThresholdPercent:parseInt(o.target.value)};s(n),j(n,!1)}}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Lower values = more sensitive (records with less change)"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"block-size",className:"block text-sm text-slate-400 mb-1",children:"Detection Block Size"}),e.jsxs("select",{id:"block-size",className:"input-text w-full",value:m.motionDetectionBlockSize,onChange:async o=>{const n=parseInt(o.target.value),t={...m,motionDetectionBlockSize:n};s(t);try{await h("/api/vnc/recordings/config",{method:"PUT",body:JSON.stringify(t)}),await x(),c("Block size saved successfully","success")}catch(d){c(`Failed to save: ${d instanceof Error?d.message:String(d)}`,"error")}},children:[e.jsx("option",{value:16,children:"16x16 (High precision, higher CPU)"}),e.jsx("option",{value:32,children:"32x32 (Balanced)"}),e.jsx("option",{value:64,children:"64x64 (Low precision, lower CPU)"})]})]})]})]})]}),l&&e.jsx(D,{initialPath:m.rootFolder,onSelect:async o=>{const n=o.replace(/\\\\/g,"\\"),t={...m,rootFolder:n};s(t),b(!1);try{await h("/api/vnc/recordings/config",{method:"PUT",body:JSON.stringify(t)}),await x(),c("Recordings folder saved successfully","success")}catch(d){c(`Failed to save: ${d instanceof Error?d.message:String(d)}`,"error")}},onCancel:()=>b(!1)})]})}export{ye as default};
